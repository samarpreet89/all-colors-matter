<!DOCTYPE html>
<html class="js" lang="en-gb"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=2.5,user-scalable=yes">
    <meta name="citation_publisher" content="Springer, Cham">
    <meta name="citation_title" content="Colorful Image Colorization">
    <meta name="citation_doi" content="10.1007/978-3-319-46487-9_40">
    <meta name="citation_language" content="en">
    <meta name="citation_abstract_html_url" content="https://link.springer.com/chapter/10.1007/978-3-319-46487-9_40">
    <meta name="citation_fulltext_html_url" content="https://link.springer.com/chapter/10.1007/978-3-319-46487-9_40">
    <meta name="citation_pdf_url" content="https://link.springer.com/content/pdf/10.1007%2F978-3-319-46487-9_40.pdf">
    <meta name="citation_springer_api_url" content="http://api.springer.com/metadata/pam?q=doi:10.1007/978-3-319-46487-9_40&amp;api_key=">
    <meta name="citation_firstpage" content="649">
    <meta name="citation_lastpage" content="666">
    <meta name="citation_author" content="Richard Zhang">
    <meta name="citation_author_institution" content="University of California">
    <meta name="citation_author" content="Phillip Isola">
    <meta name="citation_author_institution" content="University of California">
    <meta name="citation_author_email" content="isola@eecs.berkeley.edu">
    <meta name="citation_author" content="Alexei A. Efros">
    <meta name="citation_author_institution" content="University of California">
    <meta name="dc.identifier" content="10.1007/978-3-319-46487-9_40">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="Given a grayscale photograph as input, this paper attacks the problem of hallucinating a plausiblecolor version of the photograph. This problem is clearly underconstrained, so previous approaches...">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Colorful Image Colorization">
    <meta name="twitter:image" content="https://static-content.springer.com/cover/book/978-3-319-46487-9.jpg">
    <meta name="twitter:image:alt" content="Content cover image">
    <meta name="twitter:site" content="SpringerLink">
    <meta name="twitter:description" content="Given a grayscale photograph as input, this paper attacks the problem of hallucinating a plausiblecolor version of the photograph. This problem is clearly underconstrained, so previous approaches...">
    <meta name="citation_inbook_title" content="Computer Vision – ECCV 2016">
    <meta name="citation_publication_date" content="2016/10/08">
    <meta name="citation_conference_series_id" content="springer/eccv">
    <meta name="citation_conference_title" content="European Conference on Computer Vision">
    <meta name="citation_conference_sequence_num" content="14">
    <meta name="citation_conference_abbrev" content="ECCV">
    <meta property="og:title" content="Colorful Image Colorization">
    <meta property="og:type" content="Paper">
    <meta property="og:url" content="https://link.springer.com/chapter/10.1007/978-3-319-46487-9_40">
    <meta property="og:image" content="https://static-content.springer.com/cover/book/978-3-319-46487-9.jpg">
    <meta property="og:site_name" content="SpringerLink">
    <meta property="og:description" content="Given a grayscale photograph as input, this paper attacks the problem of hallucinating a plausiblecolor version of the photograph. This problem is clearly underconstrained, so previous approaches...">

        <title>Colorful Image Colorization | SpringerLink</title>
        <link rel="canonical" href="https://link.springer.com/chapter/10.1007/978-3-319-46487-9_40">
        <link rel="shortcut icon" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/favicon.ico">
<link rel="icon" sizes="16x16 32x32 48x48" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/favicon.ico">
<link rel="icon" sizes="16x16" type="image/png" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/favicon-16x16.png">
<link rel="icon" sizes="32x32" type="image/png" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/favicon-32x32.png">
<link rel="icon" sizes="48x48" type="image/png" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/favicon-48x48.png">
<link rel="apple-touch-icon" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-iphone@3x.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/ic_launcher_hdpi.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-ipad.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-iphone@2x.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/ic_launcher_xxhdpi.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-ipad@2x.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://link.springer.com/springerlink-static/1203499612/images/favicon/app-icon-iphone@3x.png">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/springerlink-static/1203499612/images/favicon/ic_launcher_xxhdpi.png">
        <link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://google-analytics.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://www.googletagmanager.com/">
<link rel="dns-prefetch" href="https://static-content.springer.com/">
        <link rel="stylesheet" href="Colorful%20Image%20Colorization%20|%20SpringerLink_files/basic.css" media="screen">
<link rel="stylesheet" href="Colorful%20Image%20Colorization%20|%20SpringerLink_files/styles.css" class="js-ctm" media="only screen and (-webkit-min-device-pixel-ratio:0) and (min-color-index:0), (-ms-high-contrast: none), only all and (min--moz-device-pixel-ratio:0) and (min-resolution: 3e1dpcm)">
<link rel="stylesheet" href="Colorful%20Image%20Colorization%20|%20SpringerLink_files/print.css" media="print">


            <script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/ads_002"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/ads"></script><script type="text/javascript" async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/MathJax.js"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/pubads_impl_rendering_195.js"></script><script type="text/javascript" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/get"></script><script type="text/javascript" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/optout_check"></script><script async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/mathJax.js"></script><script type="text/javascript" async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/analytics.js"></script><script async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/controltag.js"></script><script async="" type="text/javascript" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/gpt.js"></script><script type="text/javascript" async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/KDqyaFZ_.js"></script><script async="" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/gtm.js"></script><script>
        var dataLayer = [{
                'GA Key':'UA-26408784-1',
                'Features':["leaderboardadverts","abtesting","reprintsandpermissionsabtest"],
                'Event Category':'Conference Paper',
                'Open Access':'N',
                'Labs':'Y',
                'DOI':'10.1007\/978-3-319-46487-9_40',
                'VG Wort Identifier':'pw-vgzm.415900-10.1007-978-3-319-46487-9_40',
                'HasAccess':'Y',
                'Full HTML':'Y',
                'Has Body':'Y',
                'Static Hash':'1203499612',
                'Has Preview':'N',
                'user':{'license': {'businessPartnerID': ['1600134053', '8200828607', '8200924855'], 'businessPartnerIDString': '1600134053|8200828607|8200924855'}},
                'content':{'type': 'chapter', 'book': {'seriesTitle': 'Lecture Notes in Computer Science', 'bookProductType': 'Proceedings', 'eIsbn': '978-3-319-46487-9', 'seriesId': '558', 'title': 'Computer Vision \u2013 ECCV 2016', 'doi': '10.1007/978-3-319-46487-9'}, 'chapter': {'doi': '10.1007/978-3-319-46487-9_40'}, 'category': {'pmc': {'primarySubject': 'Computer Science', 'primarySubjectCode': 'I', 'secondarySubjects': {'1': 'Image Processing and Computer Vision', '2': 'Pattern Recognition', '3': 'Artificial Intelligence (incl. Robotics)', '4': 'Computer Graphics'}, 'secondarySubjectCodes': {'1': 'I22021', '2': 'I2203X', '3': 'I21017', '4': 'I22013'}}}},
                'Access Type':'subscription',
                'Page':'chapter',
                'Bpids':'1600134053, 8200828607, 8200924855',
                'Bpnames':'Stanford University Serials Control, Center for Research LIbraries c\/o NERL, Stanford University Medical Center',
                'SubjectCodes':'SCI, SCI22021, SCI2203X, SCI21017, SCI22013',
                'Keywords':'Colorization, Vision for graphics, CNNs, Self-supervised learning',
                'Country':'US',
                'ConferenceSeriesId':'eccv',
        }];
    </script>

    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?cache-busting=' + new Date().getTime() + '&id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WCF9Z9');</script>

    <style>@font-face{font-family:'Source Sans Pro';font-weight:400;src:url(data:application/font-woff;base64,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) format('woff')}@font-face{font-family:'Source Sans Pro';font-weight:600;src:url(data:application/font-woff;base64,d09GRgABAAAAAEPkABEAAAAAh/gAAQABAAAAAAAAAAAAAAAAAAAAAAAAAABHREVGAAABgAAAADYAAABAA0QDckdQT1MAAAG4AAAHKwAAGWjKVuYJR1NVQgAACOQAAACJAAAA4PFn1ldPUy8yAAAJcAAAAFMAAABgW3yVKGNtYXAAAAnEAAABRQAAAebzMPm1Y3Z0IAAACwwAAAAoAAAAKA27ATZmcGdtAAALNAAAAQIAAAFzBlmcN2dhc3AAAAw4AAAACAAAAAj//wADZ2x5ZgAADEAAADAwAABc4JLzHaJoZWFkAAA8cAAAADYAAAA2/iCz02hoZWEAADyoAAAAHwAAACQHrwOeaG10eAAAPMgAAAHjAAADxLPOIg9sb2NhAAA+rAAAAeEAAAHkDsgmwm1heHAAAECQAAAAIAAAACADCwIzbmFtZQAAQLAAAADgAAAB3CQ5P0Rwb3N0AABBkAAAAgUAAAM5bFBIb3ByZXAAAEOYAAAASwAAAEte3My2eAENwbEBQDAQAMADgH10RmAMHSUyaqbJ36mwAmqj1qayx8rhVLli5faofLHyS2o5VgWBWga3AAB4AbSOM8BXcRiFn3s//G1jybZbclNbmLNda1rD1pptt2S3ZNu23dvJNYbv5/ec5z334gB+GtIRt2PnLt0ID+01djh5SgHM5PPzrekO6Td6OOGvJ0jRFuGCtt9pq6q6auR2ZiDjmc1adnOW27xVgN/JOpWdujjyfSTIUaAJzejBSKYwjZksYgk78VKwmzSxGzSzK/QjQn8qM9Mes8j2sooQZYiQ+1jqO6k7pWbwqueV1Ef0IUw/atKf1iLeiDgnoimlIu6JeCn1NMt0l5Kzt/Lvq3onpiplUp4rX4xUMVKzlIg5zpIvXQe/51Aq5Qqr5DjqOomrc6N694vPySloN1OKS3+CPCb6hTisbmlMsPdM0naTUymF5MV0XVpRH+yxrbe7OjdTpKMILxU47OR/zrtne4Ei/3nYVtC58TftpuaF/5A9345oTgea/tDW22Gd2+y4Xtf/wzdeEv3xPv39/7Vv22qidv+vMk/bs0/cmDWYKzcQx8PMzMxUp0pfpi9Spg1U6cLMTbgJMzMz02Omtc+89ls7+8nJPn/fL7uTsU5aK2e/C2dM0mo085f0nxndFXyRdiaMEWEbRjyKMOJJ1lDnaTsvIeIT3iEhCVtWbJnaNiR2ZmY1evJdyT8WvXrVOWSYoO2+jKXEnu06hs3atvjz6N7TzsssCsFBNImfeF7Pn+cLjVI/mYnbCYaOoO5QY5O0emNrpL99U8u/v2fgrDcttIlkpMNqTNknN7GZL3hR1rWB5TwyRkkkK/5Jd/UiXuIBHrDzXmEVt/MITZZL/0eqwT0Z+RzDuOfG0uJbZ+7C0OpYoe20U9+24HN1DQOxLx/6zonuGdpv4cpGKmopKdlOAyfltekXnJ/h/H6ZeCIxQ7WIcO5mDVv4kTrv0edtrsufrdDccwivTHB4jpgtvMR3rOBz3mHNhG3jMKePmeci33mazcB+G1Kfvb7ws21tKE5XXsI4vnLUTpAoDYjGpjC5jJjPJBqT/PsBEno0SXgr7y3hIfGXC9/vcAxfeozQs2MDb/MRa1jCd3xBxVnRiKTQZKBIR1QwxAyI2Spn0FP/h9hZI4tN5lClGs5V1G2/E14zP07Ec3sqZ+JxbpL70C4TMdT02LhvgKUyh9rveohEZwFh3SJqw9002SB54niqxFzrDdt44eLS8xfyz13cS4MlC9YGQ4TN9W60MrLtKjUyh6kdlCfKmV1kzJdz5HMOqVo/1mGZ1Avr8by8fwFDzSnn73BEfuc7Nm/tkTMzw1ZFGT1LepH1fhaZH1f0dETzINtyu6fZ0dWhWFR98a9RMcBg1NeeHk9ayuJhMUZazqwW74eKMsXqUFdWTxGNDD+HTBG+0GgW72T2VPUsfZ46mLoFboY6q60sH4UqPnO2dZ+9o6wjCd2rWMJVXn/KCjByQ96HlDfp6l7X5PlHqrIHg5wr3t4IT/bRyBZWYXx+e9WxN1tcYkqae/nj3jlbfw5P+pbfI0VwrDMa+VmDvmfBIqYy9cy7i7j71G2UKHI+IXP4nVFx8soRNr9kvh+f9X6dd2wv8e9zXm09hWHAduZj9WsrGSNfy18NRrEfEKqUGn1/v2hVo1N45wXW0aSCkYqfcEWYmeW7BDExTclg/zuhXuqvXbSlrkZwyz65gR8ki0ic0+bSmewkmk/iv20PzJifDCUfv0PCgC5G6thW3pstJ9Ahpk/L2YHYYVHiVm/amKKvt/owc1M62t5CojZC2fzCMKLF7yCJ+H97ey0SOegjkul+6PDWZK4IS6HLZ/QW0FgjO/vFrOsM/20WXiXfezVRhQr9+XYYtbfe+kx45v5Svl/HR9ubRQMMCOLlct7R1gYGs6yDNPSftHBNk17m17RZ7VMv46XpV1Wy8T3m18LrWU8OKACj+Bnbtj2zRpw2aWLbtlWuJrZt59XyCPnKeO//d9rL6k7/q/npPX++FyMezOSBIhUy1KVAk20U2c0p1nOGc+xnglsc4i5PucALGeeVTPBGJnknU3yQLgbMvMaKDTtuqtRwUKdBEycu6uKmpTx48eGnQ4AegoQIkyECxEmQJA1ACkhLRorkyFOgyCglZlCmgvUnVexKpCGCVvtJFb8IQdy0Cf8kTkSJAAAU0co/idNPEZGyQIYEBf4+YhIVA0aGMDMsWUZQAAwwiKIPERMAvT9lwcgCzOLGKj6c4sMjIYLiIyw+ouIhJkbiYiIhWZJiJiVl0mIhI16y4idPkSAlCVAW3aGEqYmNJi3qtCVIR+r0SJBeqdMnDfqlyIBEGJQSQ2JnWCqMiINRaTKDubiZLz4WshgfS1iOiRViYaUYWM1G/GxiG0G2s4swu9lDnb0cJshRThDhJKdwcJZzBJhgEhdTdGlzUVJckjSXJccVyXCVa+S5LgVuiJObUuCWOLkrNe5Ji/tS44G0eMgTqjyVOC+lw2vp8FY6vJMkHyTGJ4nyTRJ8l/APlZVMdQB4AWNgZGBg4GJIYJjHwOTi5hPCwJeTWJLHIMXAwgAE//+D5cUYmB2jXBUY5JyDQhQYNEKCvBUYjKCyjGCaCQhZoSxmBjYoi4WBnYEjJzM9kcEIJ5mfnMNggUwyMEBMBWMmoFlSUB4HELMxnALLqjGwwMWkQDRYJQ9DJZBWZqgCkoZgdcoAVmYjbAAAAHgBJcWxYQFQEADQd3dJApUN/gwmACoLqAykZTOgNIENAF7zVOxz6Zdcv2bxPVaG0cj+X9VPZf40/hEA49lkDvdHXh9/1DkGTWwgLrlFU08ZkAyKAHgBXcsDjB0LAADAeYg/amNzsWrbtm3btm3bdhvVtn3e2HXjXu2JMYgihmxiIsgmHnmICgJx+fCvwsqqop0uxpnknHvSvfQxUjTSPHo1mhRNCbIFeYICQUJQLqgRjAgOJGRJyP7xI/hXoIhyqmqvq/G2OO++0KvPu9n3nTXIFeT7vMv+sSMf36MBHy/x8Qx8HMPH0XwsRUa2jPiHj+FcCCeGHcNpYdUwV9qptGMioAxaoBN6GYA9uIwQQJI0f4uZZ7GjLrhuvEW22ma/22ZbZ5bd5pjrgfseWuCI7fba4bEtnttpj12eeGm+Ky4675J9DkhxyClrPLXeYanOeeS4ExI9c9Am6Y45ba0bbrploZbqqKue+hpo6K5GmmiqmeZaaGWI0froq5/+BhjonkGGGma4EUYaY5TGBltiqRWWWW7lJ/Pae2MAAAAAFABeAHQAeAAAAAz/MwAMAeYADAIGAAwCPgAMAn4ADAKQAAwCyAAMeAFdUEVaAzEUTr09AVLL+3Co7NlgmcHd8nC3M+BO7SyPXdjNwbBXl5H8+sWMEIlZI0JL+tPlKqBx/b0YoaJfIiQ8+3tJI1wJKa1LRa4DFu4EG4PAzJOQNnl67BXdhTIjM9MnGWnLi8MT8vaUkIPTDKYliVV9yeOaBhrFcI2eIg7zPN7iPN7SPBnkGa4qMzCyxRP8cMmXmJXk6V3Sy5ruVZhGFYYBpEXOkiZHhQGRW/7aThlvLtsrew4kOBpkEizPsqppNEwCM5my6gK6z2TCmS6saiOcFsMlWo3RimFE0eGbsIzrfokjhi4IF40u6AIMAypeO5SYXdWWCgNg8h8k6mvkAAAAAAAB//8AAngBpXwHeBvH0ejuAQTABhBEOfR2AA69HQEQbGBvIiVKoihRxZYpOZLjKom2XCT3luZUx46S+OVP783/79hMeXHs9Kb0/C9Kc9yV3osFvtm9xRGgwFR9OtxicLc7MzttZ3aJmtA8QtwM9zqkQhrUjAzIgg6hhxEa2wUfaecjCKGOgUUG4AiAQ+qBxRXUBA1k7CytII3S0iotHWs9gloQ/v0KamffoaOOR1AnwDJZk9/oN4lGv1FrSmPBgE1lLHjxPP5zRffolXj7FcnulDpduiyVeTSb4l537jI8/43KfvyWb1T+dPjgwcN4/ILFxQsQAvRXK/CR4e4B/I1AD0NWT5DV12DfRgBtSK0AjARgZOTAL3qKeqvcAlRb04+gZooqFlNYFPTYgHlBK5gkk4Av4TvcerXe1cE/eka65jt3f+d63DbXdUWheHnX3J6PcPecO0pwU6HtDDcTcqEQ2rMhb00EYJKREeAXE0VBSK+gFvhuVnjnBIQADi0XbZmgFZL5KeU8nMWs0Vo82GLWc3FsyhXyXeE4tiiN7d+QdpSFYmliU3hkb+GJz4/1Dw7uWJrcPDO9xN1jDA0k03MGddvscHYyw+Obcqlk5H8qPyh0S9lvIoRRdvX3XJg7hbyoVKWjiaDdVEOHkwCcMpebALc2iqUTWmYZy64BTspZeW0KCwE94GuVcoUir4dvKS6b3nZFue9C75C9FI6OZJ0XbU8MuYYiLxooXzaXwmNzN+1K5fyTdre/f1fxqpsC3olUNrFwI5EByudB4HMLMDG/IZdbCKCFYPcIagV8ZJ4aq/yzynwrMnYZt3/o9e+Obz029T/vOnjpZQck7p63vnXrie2xC45dd+0VlRT0jMm4+BkYtxXNbjhqKwG0klHl8VRUJ7TwTCudV20aeEixaYVfdUw7LH6LZBEscN+OX1p5/uxZ7Ktcxt2z9K6lR5eQMvaPqNyPbDh2MwE0Nxq7uW7stRGNwnb8sspzv/zlMgz2yFLlV6g69wWY+xCa3XDu/QTgX5t7PaXJDy0rHdUNT/vpqG4Y1VkjDx5unUDkhbxkZEKRmT86HOjJRAyD9t5UYkJyXXzAles48WTgitGhq7YxudDzno5Jm0eWDIP+FRdWfuJPgnAwPnGjdI6m/ok5WkHNysw0A54qJicPI/VpeA7u2tNEWsBySUYBPoXty7h5ebnyJ2BY5S9Ye+4oDlR+JI+LPg/jqlBow3FVBKAi49I+oa9lZjwwsq3+Hj8A7xtRvPq+ljyuVd5XzByVaBXlaNGDgYN5QA6EWQiExcPmLk8qtWzNTEtjF3ofCPq7x/HHKuXklt5Ad7HKnwUYp+3v2Cc1Aaj/njnVEYBO5iAH77ZRcwqih3TQotRJJklrElRaC5Cpeu6WL569+SMXEKZ9D0dXK0dw19X/V5Hr7wE+TSi+IT5M+CjdHNNfI9GVZdxROQEs/PYSqtL2eujLja7csC8NAWhqAG4CcCN1Ay1akT0lpa1DaZngaQ1tWaFnN6PXxEtFMqdGkPGioFUJKlHwqCwwyTdfE1fHlm++XKXWcOr8kcKRLjXX1KS6FHjxqRMn8DCIUJwHLeDvJby5l88XC3zlO1V6+ok/2Xiu2Ew0dC4NpF0NDR3FXc/8DsM9hYkQUaQxQfr4V0bU6tYr2Q1QfdXLpKuL2AXIXvWyrqPFyhOIo3biKNgJExJQHtWZXQUhBWUYX/YL8AjzaJlsE+h8nlkFYo/F3AB8DwsBjcXs4fDWwRfPxGIzLx4cfPFsLDb74kFxIGHbs3nzHltioC29eOPclpMLqdTCyS1zNy6mLw6UF4tXnDx5RXGxHFD8RAT4p0fWDaxmvVatgIwjFhC0gTUwKF7DUut1iduwCKYcc7NnCnuGw+GRPfnDy9961eTkhdw95sxsqTCXt/8azx4fSD+JEOXVDu6lwCsDyqBNVVx8ZGhfDS5WArASXD6OkgiTeYwDtKPqM3zQaqctK9imGLFNwCdJ4RrWY2IFUqpapmqpkSi+G5gmVhmInzAWAku3+/ILA/4qg709W3P81owVgp/p0t7BQGBwbwn4ee5Dupa9k83FheWJKrtHjyx0t4oBTRNS+NwDfNYh2z8fkymKRonFCKMWSqyeucUVxBMYE1HmpU0qAVSsGvyYPr9vZGJiZN9vXnFw+YfSrsHQRO+b8N7u7lLi3NcxWkUwE8np4qa9ZubXwmBjz8EcSIpvYAyvwTJDAJk1G0uCRCvKABryPLgpLASPWAGmWOCuFJfGMttZxMNk2IvBCjDj/GJhd7K7x+AMWXfb0mHe37M1U3pxuNc3Gkt3G91h86I7I5h9/TuLwzek3+aPpsJml6WzWWzxxLqD4kjOlQxPOzzRoMlpMepCbb5YMRgZz3tzKUKbAyFOB3OgBerqQ3hGm+JQ5BnggBZEJamJSJGQ95No4HufxL/85DKXWFo692057pgDHS9Dv3bUt6EGtRNAew3ATABmmYnaqsFmgqo4K9D8uWWTkPF4ckHzlYGhPaXSniEBTM3d+amEyZSYyuNrK6/eemTS7588shVwWX0BaHQBLu1o8B9EfecjxyJ/hNrptKkkkwfz0gAGo60S1Dfs7bAb1Ua7Yc/xL78EUPhY98FS6WA3ngLvjFEnQqp2GNePrvnnx2U8aBwxUQBPAPwaZn5qmA3wEk9bLuRX5F/Btg5vlbxUAW/Tebyk69CpWy2tcxfPtVpb1TqDrnTlyVdt1Rk0aq1Bt+UVQNVD+cNdXZd04enKQ9IlefiCp8Ge7wpvCsP/yrvpfLcjEA0634rPwQRPfH78tAawE4C9hjQDARhk0jTwrl32nABqlQlSSbxMRxlLKpOgrLmEz3/wlsk2HhYmltaxGz64cstcu92gbufbNt+At+L+V/MZtzvDv7ryqcp/n3JIHo/kOIUQkw38F8DbgAb/ebzXo2mQVboOOYvw6cdPTMDiT93h0U9c99nl3+E3vis0Fg6Phd5Vufh3hGcR+Pgjjc37UX2ot95Pyyqhkf3KaXgMtBArWljEflBDDJFNBPdVfoo/VHkMlyu5cfz00njFsURtbRfYsC/gPyEnEkEa6+nQbTwhTBpZUGOgE0KwhHcVe2uBBwwUbgeYl6JlgVYAWjKqghx0dhWKYO/AwGnFAUxWUkZBFKjnKbKIXq/qeul9LRa/PTTmi0Uv7t23+4JmlX9TYmjrVaLXk3PmRqOdt29ZMJoEp8FlnnWELz9U+WHBFd4y7fe4HFdozHYf0DoFtqeZ+wyyAgq3rdO8zvUR3RrxHQTQgdTrvaoS0XUwaeygcZy8ruYpkR3QctCWBlo+hfAAM2IWLSHYw1UtOmQImAMg7lc7dUzlnQqnJnMOoWcmGhjzqlr2HHNI1uxwrrurm/vMQ9ucAWFob6l8YDTo8+RO8J075qe30bg8CvP6MZhX9/r1doNZrV9v25UsS7HO+9Qvt6OR0cVsZsJeNEf4vumpHo9kzgjzsdzOweAf+vcPC37blNG0uGl60W6c8voCw/uB/3HA6Szw3wycuG1DrJjlW5uQTgLoROqGJlgHvzSxCLQJdVL+dwIFNkqLXuG/juU/ZEo9dfSJeale4op5SnFc6NkUifW41ccu1Kmdk5F9lx8vFYoZR9aeGf5D3/7hoNu+5aPnBvLO8F03zG0vPsV3zlOdIrz/LtWpANq6EZ115roNfuFZnAi/AIYdMq6K4rQpUlNUQjGt34NrpiREQzZtNFzeFs/NSI6myhd0s32+olMUFtLSruEQnspKiWEdRT0wsCAFzCOTJuMk7xGGL7ykd7g8gDDgjPBu7muA2MKGmDPl72yYKDADopyCvI62Wk+TbzAdYJQwIOnGNFdgFPLFaoSDR53Ogf37jw0Pd0b6E460kTvUtj2/p3IVftVCkxQeSjtatCQnFlkV8V+Bt+1oDHh7Oap3hms4DhHAENKsxV3d8PsQ5XE3S87Ba4BU6DRcAAlTSDdA0gBJA2RcyUHMUM7zIBsscAyIGm1XgchJnt0YHUCYB1fVWQ8tay8Gi8YiFDmZJivT3SO9fVPJ2EjEGd4fDJjsfotd9OXHRXPI8OHdbR3u3KjYETC2tgvJnYt7QqMX9SU2FbzfFHLZYDCXm/SH0j63WevOe/MWdVvE404b1KaRRGw4yWubdujjjuhAzKrRtpiNFltpMDiYcnb4MniflElJuXRGor55Cj5+TvVxF9rI+CnmsbHl17D0IswwNXEGxcR11pk4YtONsnwahaljau8macvksWDUl/UeAzt2oTt58QWVr+BQf87rqbwHcagPBv0S9zhqhS6TqD7k1zVca2lIzjQOQwbCMCcwJAnpQbFv80YiXrgWjx3jhoJudyjkdgcXKhY5//vN1Rz6CoxjRG5UXOcTdOsjXQ0Zx4Y6YRyAsSwVjKikS5jxrkVherkj1Bd3inpri6XVz/d4olGPNxrFZ8+9IA5nnbqmBVVTMs7trWImzwvHwbwoORUlhbLxvPzzORVUk1MpkpyKCDmVqSOqh2589yMnb5w9wn2mMvHEFyo//M6ukwgTn4n+CLjoz8undDbICICdUDhilXpwkdcIwIupYx3Naq3WwIcHctxnzj1kMXILLdODTAZVOtBnP7r/H8mgbuPQl3myxvl5TomFm1mLyCpw7LS8EAf7pThsDVuSyQsaLyOGl6gM83WSrF27T4F/8E6lCkNGYSa9eXo5FE6VjoVE+MBnR/ypVCycq4p3f+U97IbWdBDoN6OL/3n6FR2snwGFXKaUTCEZMZ0KMfUKyfD3zyoaCVgP+1J1Cqn4tRcAVxMwJt/QO9QHwcBUxRG4630Xs4fU2zKTGA0PzadSOwZFcXBHKjU/FL6mv1AYGCgU+mlAIQzv74d7IAD36cXF6U2Li4jGdANcM+DEYro6f6RbnynVrS9HaRrWUJrgXRPLyJlYrtuqiIhJiSmalZiuSfHOPDg2YHF9WFcb033iGBGWmWhqQo7qfIMelTPHQrrIKe4DXY6wMExiupGgy7FNCelo/DSAz1JZ8aGbNuQ/kwXd+nBJ0yCggviJRU2wUGSRVDV2MvxTsROYEOLGN4idyjRiVTvHw+fHTp70ue3/tdURUGInRR+OA41GtO2f14f12m5c0/EzsvAb6oSfRbRM8h3TomAxt1s73IM8iP7OjNRyUK1Odle+zfLorwZ80oBZvaisDZ8ggER9jidBJUiRFoAF4J3EuhwPzawV6jM8/FqCZ7N/KBwJd3rCJltOtO/fLm3z5B15d0gwukJmey5qt2cmU9KB4K0Ot99h4DsNumZbIOkd2hbkx028lzdYOvTaZj6QDfiKUZvoBnrMQM9u7gjM8Vhj/tbpgmxDmtn6UmapCu4mtlqgmZ4ylmi1yVwTi+Z3j8/o9588OdbubDWbJXe8N2Qkkdydd+55fkHTtEPb6kgPRQCfUcDnZ/isYv/qp7exOivz3dD5GVl2k1SOm6nXAxVgoSjzTARR41rMnx89Foz4sq5jsKj0kcAEn638oD/nC+K5imUyDJZQttVtCBFcG+SL1q9eGGDjfJGpNiUgtF29ucXSom41t26+8l134LOrwelweDq4WrHItRyEuG/DuJAv+ufHZT5C98/mi/ys/G4AkJnlixDyrce2Du+1NIttuVfXqoXMUPPgJUPNkDnStml7Lzv5kpJOD229rvt2oEoYDwbHhVV2B+qeEsZEcVx4EmFSP8Dfwmcb5IkaW7Z/Jk8EsSMlxMwyRkCIWIO/lq8h4L2vOVFs5VvVzebm9PFXv+lEX5u9naS/uq7F6Ow+c9wM//f9+XcXWRMWS5y/SJaH1QKVBzcaR/VBl269rV2Pc+3CpB3pGHo8NQxlXJcw0quoCylrTc1iuq350at3tFoAT1Pz9JUfNQTT/RGzR295EdeUDnnxU7/xTQiBCf9vzq3GhtP2pqbdBM8AfLwVn22QT9L9a/kkmtZVSRZ/4Nmv4Que+VXl5gG8bU9/5YN7EVpdlfdSqLq4MFIjhLTop9jSEP6zDeBP1cH7FfgzdfBeBf58HXxZgf8c4ABaPYeQysDdA/RY0YkN6whMQRsX7Dh4tJ0KUQtrEVUDFikBgFZJNHSwrJeehQwWeM4k7wExUiFrsvjzkOHB1fI8fqnaluIlzl654dPbr8cT+NHKX374Q9yEM9LBzCVvW3rve+WSPdAI9R6R7J8AGjWUxl/i3Qjg8h4CykMd47m3IfxnG8CfqoP3KvDnZfjqX+HbV+jzbXL/6BX0+c3wvK8G/jMZvvoHgIdq4E/VwXsV+PMyXK5J0rk2srmepnBaC6T9dDK6tjaE/2wD+FN18H4F/kwdvFeBP0/goBHJ1TPczdxHUTPAE+iOqtREiExEGu5VWUEIGhEaOXFUBJrhSacsNKwFHTCPuYI62dOQMVSecyswn9KKsV9B76xyRS6NWeqAx9Ucg6gVi9XkA1/kfxHtJxU5Uzw+uHlPayu+1u0h1bgDkwP9Y14/qXgemhwcuDVKSpujXZPxk1eEh534wtgVo6TiWdyS2ZU4RqtyPdsySK4zAlNIzdMMOO7YYPdGfYq0SYkbtaflzFaHUgFtUbKidlltTrNdHDU7VuRlQS82Aq3Z9MJ10/gdlb+eOQOl+U2Tx+fTx4++KBi8+Bie3nrd1ijd0BLbfmLr9UfxNy+HeZXrS1QObExuJlAj+M82gD9VB+9V4M/LcLkuQJ93MbknGsIhD3zsovsgnGgR1QtJo3pstVrm7JCNCZEVJ7IqBqaZVbYfRjaww81wtwOvQiz9RHllqu45IgG4EXceuOzyJeklL+m5D/YdLU/99+ws3Wv0qd7/5TLy3iNcLKqxC9XVsjuAvlJ9VNFwXj+ObNRLq+MfRxy0eGjR9E5tDbtYrWEvHz6viH3Ykp4tFee67Hc/dbw/8yTwUq49cF8HXnooL3+CTagR/IkN4E/WwVcU+NMbwJ+rgz+pwM8SOFIROEfW4m2oD42gN6J6JujWz+IaIEUAKcKmenNBASll51QXSjFd6GK6QDTfiiJsX5NsJfyKjpRoywqtQdpyQ2uEOhRWF0nhNNZjlZKcOD8rHBbpJ0lSplRkydMkr/nfLnrdg06dFnMXbN4bXSpIYybPpkx6ImNvqnxbs6ng63JGhR3pnnm3dGFmaOtL7sXNZr9dGPNxfCYT69e+wu/xOo0JK9+ew2pHOB2LpYWBnZBRHhy3GGd5T1ZIRLYMbdnZIVdkNvWNDPdT3kdXRVKXAN77KO9/ga0MDjlzOrcBJgutDeFPbAB/sg6+osCfY3AM375Knz8k949uo/ASQripBv4EgTN/ZayBP8ngZwHu5FYU+HMAZ+tW9Al8tsF+rfOSDsp+raljsNys0BiG5WJJv3EmwwmFnhcoHgnGl86G8Cc2gD9ZB19R4E9vAH+OwJEK4M8CXA0QA4qtrX3DhIRwDU02ArAxPwiNcI0f1MGTNirb4Q5Z3mVfVlhzZWueLLzOlX3ekyyM6v3eRGFEjz0ON8kKhcbdqVTO4SaZotnedOoyz+JkXsy7d092iZjz7SyQBJHV2h3s9y2QtpAoBSktv1c5QK9bQQN70RFUv4rUbbhXQ15LNrMWLJhOwzN0n8wK8iIexSht3jRAWDFTrt1005YXWr012pqXNQ/oq9VWTQN1VUo5D/TlpL4+Kdd3dWhgW6qw0+leyKansnYVV/mGZqbgy4OSLmSkXW7PjlJqW3+Qe0U2E+/X/oHlxzYRFhRy2SJRTaOrmelmMSvlIYt2SNZJOcfLDXFfAbwP1nv4mhxvNwDgAXXDAMgADTl15KcTH2TfV1CGteSwQKrbtgnzDpdHXZ1/Jhopdb5L2bUFSuIqbC0kx9K8w+dwRbNRF58YisbGAzEp5w+6opmoy+62h4K5/FH8h8yWktcR7/aGpGjYanbZ7KGC6C/FbHbrFjHssPkcNn8y4E1G455AYnKs4gL5p/kHqi85pl88Qg3gT2wAf7IOvqLAn2NwWCOy5wvMvqzWwFcU+HMEjjiUgX5+y/0YdaA8WkT1gtnZYOH7cSJ3ZLUSXwENjtLKhF3ZixMFaTWC1Cbgnjkj3yUljhCVnJOJaaGyfc7Kp7CskCR5CeqIO4t9GDtLnuKgyZ840jvj653vSs4NwI7QaQgneX0mcI/3ej7nkoLjvld6t+3Z3m5vC9imh/z5kJlr7nvnsb6LpyJki23XfK/X7pY2+yfzA0aPYcIUd0wVEMvlKvX5nRuuqJkVVZjB8gQN85u1GUyfnJ8VjOdV3fl8XX72GOceC6enJSdJzwr9bk5Jz35GdftDszZfNT3rsG1+u5KflWun3J1QO02iE2ij5X+MAGKos0EJC35UaqedMFFBknCDqxOgBqWOqoVLD7+2kF/Y9MZomMjqFfUV1roqK8sywo9VAHeV01GGsusjUHg1RweTrlynVe8ye4OPkDKsM1VThpVLsfHwYMrRolvQaqKxuFKXBdrBhhwD2hPoJf8obtqoZlW3oxleV/YmNp8m3yC7A3dDGvph+z1lqA+gQRYjh1jOIkoZEZKNaT9ezwWZQcWatCV3zCx5YpCkfNtaBdoKFen36C+88cZxSGJq5Izl83UF6QXgDctoEp/pAh5cwZ1CrYhHY+jl9dpbE1V7CMCD1A2daC9yUiX2KGGjBiC9rH7lQRm2uRxYcQb6ZptJV1AENbN0V7fSGmZv1gSM4GBMZuJ+2AZPCqnqveJ/rWyfJzxXlPSYtF46mHXm7YktPpcwpm+LdtvcXhHfGp6Likt92dmC2ywk7dBxoi88MmuLSE7PbMwZ07+4szvs63M8mOq2dIa2J/ksFvm0w1EIO4Kpc99tFhy+sDs7IgYKyZAxPBkI9CYcM2VfIRkxRWd9wZ3SwFHJ7CTnhSJgF7/P3Y1aae2pPnOtb7g3uE0p6FnZ3uC1oizdF0z3HFEXxGF0cHn5ILl40dXR4RJ5dm9731vf+o53/tdb37fb3rN3dGRPN8937xkZ3dtjRxhNI4S/yJ2AkUbW7bHXNxBxlkmjdWM1tKqqjjuIhGeytJBC+A0Gyj99z9WZMc/CycotF+C3TjbbO889cQG1MX74+DbwwYv61+3W0jeQr6qe2E/L+TyDkgcvDqhYQCKuGUOwi73Y4g8PX7opUpBC/Y7BxL7h1HSXO1SeT9t7+DdVto0MXrZ3Lij1xtyDacklTSZiOxcvyHFNS6xW8nXALY22r1sB6/9urcSJEsqhqfozPxBKAKR1XdVEyMP01WGvnF1iFn2LezrTNdQZnyyky6Ixlwj3u3uj+0qpmYKnt6u0Sejfmtp8OHC/Oyol7RGXYd7gDFsjSb9zIpiwxsuRwqRZbZgrJ0bT9q6wvF7uJPkxmOtmwGvnOuuub5BL/DjZG0BEMS6baTUoKyIzzcx3K7NYHadluIl4ZbJMkzOFggVSrXlSosdxFaduc+iX8YG5yyrPvPCSuXOvcs247BnHRxbf/vbNcLznFsR4/w3AL4Am6jOdNdh5CcCr8J4lK70sWQn4nFlLZCr8Zmw2+S3COrc5657MFMYG896Yu2jC879uN4v26FTBFxrYmpi9RHi9MzrYUxowmgTcc9GpllZbdpPUta3bnRcIPxOA7w+oPqfWtCdOEIwjfYOaxcfp9m0N5adfiW/iSmkvpKDqwSb5OJCCbn1gg42RYlfG2edsLn/YWHR78hE759okRMeyTl9hKpqeL4diY7uzPdvdMwO9pW5/ZMcM/qDFaSvuHhYitux0LjNb8IRmrpnbd/t8JOYBrBL0zMkJwERqbAfqLBP8yCpUst5LA6oi2aepV2mFd6ut0cFU5Vv4fd1jEaP66h2vuPm6wYvGx07e9rp9iK3LZDvYDlozokgiCytqxisTQLlez8ooxvSMZN7gJaZl8skk/xlZMrvOyO6CVSj1uEidBYsUyfpF2e/EuAuap6py+Z7RbKrXFu32ecQ3O5zZZChnFlLPmHxRPiS5pYlofCzrMNi8BmvE0+ntnsukt5T8H8qUcklHyG1rt/a91lHwxIrJmC3o5L/myUZ8bWrHpESSmvZkWbTFQ95WdZs3kvOFyuBHUoNElkLAk28pslQvOgpHmHDJskQ0hldkSbNOlkzUU8qpVnrYAUhec5K1KvB7Z7+jeSgldud3dlZFaUaIjsqilAJRio7tyZbm3Xg8EJmfGegplR5noiQyUXKHZq4GUdoBokSwKsN+m2+jVwEtNtRgd52KTE7ViwEG5bjPF4v5fPHhQCIRgIv0kV6dRk9CH5Dbq98/JPfRAn2QAECo3SiVzuSb3cmkL5rcuum4aTAcCvjEge7pyxyrqzJO+GlORHdC9wtIQ+4Ap+PUwe+Sc4vw/LPcAyDjRuRADbaFNMtsFiWtStDWUHNItazumA1WaeISR49W3nevQpnc9yx6Fv+J9t2OPo4MbPWTyXqxUDRJRdIRo+vb6mUVdEe6Il0OHT2Kd7xeSCQEP/TGYopXce9FbhRFkSqeIsFTlMXEqJwiEVliDrgfHlCf5znVfC0Zb24yuEN+azzszVkHfbuKkdGckw+IXpP6RBWX7wX7cvFohA8mXLbecNYSG4j6pFQs1eVTyOWgFjGE7wVaCX480NoC6BhpBlaElp9Sja16df3OXJBRtVjLBuxr6qD4iJ6cdci/qxAdIfiEvZ0qgk+MXNgc6gWEolYh6ebrEVI4RrVmM74bPc59GPjfikh5TA3BKp1KAxa2qa9R8cNc+ciRj1H5gGfxa+HZMLqHrHHh8+u0j258IzrNfQR10BlsAkirnE3WY4vCRUC+eDoWVWmcYsgdjpzgbrSVktjv9oV68rcN0X5G8F3oDLfC+mkFSJPcDwi3pka6tSOkH4cYdIejJ/FKfT+AJ+CD/w/gE0avInjC59cpHPrH7+NWAP5qAodPBl89iM6g+zgCQed+WIXh96H7kMhg9Gm4U31E/aAnH0caxjMN5VkxX+S1vDZ9V+rYsdQ35+8NnXpjUOZxAZ4/W/N8k/y8WOQtWvHdR5N335184VTo3vl7g4iODf3j18DzYfR6gid8fpDCCwB/A4XfR+H3ETj0H0PfxDYcRirKN4ww4qrZfCH2y1/i8LzcL3uO06BT7L3v4odw4Pz3oGoTwy+vLOPADHuO++NGz3FfOddFniN2Bf0O7MorgY93kgHpGBF0B3bjlyATpb0FIZn2dbb3rfak32TyJ+32ZMBkCiTvMAlptysTMJsDGZc7LZhYff4G/OzqpxkeBIIpHqQOi5+tBAfHxih0dnUztnM/QnoyprKPlJf39vJ0Ey+v/UZ5bKw8WcrnS5MfPXTmjjvOHPJd9P0rr/z+RT7aR3x1M/qT0ocWtct9UNdJUijExopx+jrt6DXsZdYV7WP36mHs4R5HWqrtTSzeWT9DRrh2P3755Y9zj5fPBcr0HNph9LzyHpL1AN5TKxTzsLSQ4Hrt5Y8/vsj9qPzC28l7PjZeEcUV/pD3AnAXaKuTWZwVlII72SdGuFf1hDWxuAyAxYPsNZVwnHyRsKfgS3kMKpVKB0UEu9+sg6bBk/IV+KC9yScIviZ7cLHc7stHnMlY3KZ3WvTjeotDb4/Hks5I3tdeFpLxrZlCrlndLOUzW+NJAcl042Ad/gWKtQVaZtoKkaco/i1wD1H8eRopKtu25YJaviYhyUmWAG1QAPzWv4YlX/Cmz6ck7S0sUgzzEmCYK1AMFXrsegelx6m3KfQw+dyPR7jPgXzaGu2t5c6QCVcJf9j83Gbucy/IOri4qkHv5H6JVFTOMOJk+wuTuzg7y/3yBRvALNDv7D/q1yRYNj9f7Zer6VfLem5SegbpMULvpP/K4L5KHn9ZtlMZfDO+k/sCyLz5/LwxvEosVlHiqZkTtXt7XmS6vLXceoXpUI+0aQa/YynZZz9yxN6XXArt3CnvL30IYtsPIQMap5KcJvaAzuMIO7sqn08FrWKhKQvTaBKZRP7rN1ym1GSew9XQ/+XB4rCH5wXyaXuWL3oEb7Rvsi+aENv0ttRwtLDkG7V3C0Io0jfWF0mGPZZYfyS/w4MXXCGP09gWcLhEj8OoD6yYnS4r73V7E+VkaoDvEO0w19ZIuM/u9NlsPpcnPpCODlv9WU9X2BrmaazxYfwnep6/Y4MT/fWbU8CzA+dVgapiGfFty8t7C/vGRKiqdiXgkHoAB53d86X+7RJfGadrg/TqH7lP0PPdIhpDEnCwB2E0RDmYhFYXDWWSEOMLZ6orkCH4Zj+jRL7r9+cSbajJlfB/50RQOr94fHj4msV8fvGa4eHji/me2NRSd/fSZCw2Se5TsT3e/Ggo2WdLmoK81FPKuGNm0VWORcZybjw6e/1CMrlw/ezsDTvT6Z03zJYPT0ej04fL5UNTkcjUocHERNYZsOU6TaNdPaNWYzfvdUqk6IbUyIV78QPclyjdeTRAV0Vdach+p+EO9JnP1ObDPWeqtdcccCRKV0Q5yDwUKCwN9xzA5Dezp8k7j6A+mTvrvND6LJKKxdK8IAqkGM5q9T+EU7UeT348Ur17C6LVKha8vjy555Pb/WlTZyLvD+SmjGajyYZ73XBkNTGdd7vz0wk4uOqO89GSIPTEeD7WIwilKI85j2D06LYMDV3coW839lEdzq3uVfVwr0GjaBsqs9kfpLMfhpaBtiahZaUtD4nmoCV7mgy1kn6AeORsy7qVDtspSaE8OTegkdZRT0VBQ6tXVC7KOEx+yo1f88CuzTctZsSBmVC8T8vxw77ihLtrMtHl4Nqn4vZNfCpo9Y8cnhg+sb83NXdZf2yb37nrkuk7DvbioN/VGeYdVr8j6jZ85dC7jg/l9tw0M3LxaCAc9oRnx+I7RuPZ6LcuduYmkqWDmxKFAy9bmL5qU5jvHMyl9r1kXzRkc71W8KTk/dMC2b/JvRQ5kRddh87bksEADgJwyAsAFcvhfBxpoaWm+qNlyXdy18NdzbI4Krh3smyOmd1tDO5iz7lJng9cMb0kLb0sAr2EIlwm+LhqdkfH1j3WMcvV/KhlbrFjxwX8OH+1bfxMxzUdj83cMvNB+Ae3xx57DBtuuYXEUdvww2hVNcBpEcTd0CYwP34YT6imAfawAvPi9+NJCntEgYXhuf303RUKo3tZYF20gF9D89gRRNKsG6dXlYMFfF16de2Y08rYzp1j5PJFoz642i4/cODSSw8cuHxkZHp6aGh6eoT6km0I0MF3Ih0KKCPWbUuUx0KyIrJEqfDuhVCCH9uJwwWNyVi5nuVHJwB3G0ogko87b69r9cwHOi1vC9awdCiuWdSx/DfkYTPzFwhea9iYc0zGBjZBpOl4ReW5zORS1B9286lQdLjsyGRzzilKgxf4NgljR9EAIoJVXzNnfx5GR7P7YaXSY2VphxXkgd+alQ1flIN5uNWtNevd3I5g0SUWu+JZn9McMuTcZShbBC2wtknykbw7t9l2Wd7jcnsln4t32UwJX8DgjNj9SUNrOuRMeI2xoLymDgPy+4H3TagDzSDihRr8RQVU9xcVOOUP2zSdlrcpadkZvzYm+obTdIkjGDBPkplCnpRb/rdJnZSe7pl98P7DPaeKR7Ys9l54YeJvP6fyinCeW+A06JNULp3wfQf9/imKI/sd5tWPehERRVJgImskjNwUrQ6lVq9oINtnJv9lFbYDmG2GwQpT3ZjuAxfpOWNg7R2pwp4XcTYPn+U97gnx5IhObc5wRp+xnMWoGMuXmp0+U3ux03HPp4VO+6CxY1zr5yMER4YzPR/jRGQfF8Gz9q+UOBr7kRp1edjXnbDbE90+b4ncS14hFBLgwohPlCPRwQTPJwajkXKCHymlMqVSJlWi/IngN+MC9wEyNo2dzIrlaoGWA1p/f9wPubIhiyWUdVXvPlH0wYXfbA7m6J9UqN574wEhHhcCcTouj/bh57kCzEoSRdad02shchNiEyQfYY1TBpQxjbxJfFigmz2oTGtImCjvgtDWbpngB4ydncaB3tFMT09mrLdMvpV7x/iiy1Xgxyb7YvHe3nis7w1lvuQPlPhy37jXO94H3wJ++q3DYOgY/3lXudyVL5eJGCdXX4M/yz0PGO9bl/XRNzwDIa6V4gAksnMdxOrXnu9wI5Gd+RDZ31LBddEpKEEKr4tM85LFg3l8s6srGE1F+sf7I3Ob5lL7Al3CZDSbkQGjc5kxF/6DwxkVPaLfnxrJTV6kP3SwSfRtdgWSUX8i6E+W0+P72l50UBN3E/ok+DgD+dD42g4CCyEHsv0N9iKBUWWVFgviKP7BtOzhgsqultbTctbYovylnRCsoeXFLdFsmM71kSE5CSuvA/GZys5MD8cdHGnTtZOIprjFM2iKudNdLdpTL1E5nEtLE7adxVZT61iTQ7InJ3POWLBstRcle9o2bbEk+9xqgiOtwfwK8uxudDuq/2tL+vWbt/UNz6uqkZudbbCzFtlKsXbwHTzCabgzx20jJobcO6o+w0h/Vf78WM0mfVJIhosaOolcqpcM6h0Gtd6pH1x+4+0PPPDA8pvf/ObbTnEn7vOTM2z++ypf6+3tu//+vt5enCMxGfiOv8CcSehyVO+z9A2q4x8nioQSVK0SzPjG4a5jd+GMjLoAyAYU1Hn45lEO6GbWauR0EsNd+T5chMaAam0iSWiiMVtcmEynvFEJ/0XYWdx7m7lcwrhUbkkOz+eS29xD5qS7MN72/K8x/sKj+lHJl+O3JjPXH+smfzlEp9d2q3t2D/hhXnnX3GS/pk3bbNT1j8/6vIhD/as/oH+zSwO4FsF2eZmrkfeceiiVng7ZZXvhrmEup51ODkgl0TWapvHCjSoalUemXtqwaIRwAbencrnUl9wTweELjvqKM8nhWJkvCKIj0Yk/b5jp7p7Riw5v09KBthsv69oxIGovXuJ8/IRXXfkKZzMghFd3whxx3KkG62pqJjCsq7VYwu/BF49X3tTGvfPcbppHq74Hvuxz5DuJr1Rx6EdED0G3Orh/Dh+nGbqH8HcQknOS8IyWPvOx1afZM/vpMyv4XTXP6Nc9s5k+8zD+PELKWCb6zCOrq+yZk6yfB+Eunw85gH/MZVErcqO1mBekhPEaUcmiYZeUl2Q5/86DD+6E/9g3/8lPzn+S9YN9+Md4uWHeL4A/WRnBy/PkuSw6jk9zLhivFdHTljTTUAbjWM0VZF/3ut7X3dt7L/x/3YOvv4/oyX2v77vvPrkGFkDzgG+ZxqdOlFu3G6BtYFEuC1ioCNmZ+6uNH3FNrKqqSdyLgChGblF0w3UR/YTrFEX9E+RwNjmkXfl/8j30t3ngbwB9BGgme4m/iq5CGvh8NePp1YCjALRZgEZMwz6gFe5YjkNCFgO2eLElBJx59K67HoUhrvnARaMZdWb0og+gBn3Am6wPzE5w46Z8GefTON+Ef1wZIZ3gT+JAbScc9IHY3BpQNzpvz9HG0w1PsSML9ROvBR6xyX+QMia+/cEHt7+pb7uMcxHz+EvcA4CzY32Wo/Z4uEmgf7dVOL3/1EXFjDpdvIh7oHLdfXfddR/JS6I/45/gNwHVIsiRju07l6uTpjOyL5Y9lJ5pv0mOjqVcNRkhBLQ+34TgSUdClpiv3zdebeLerqTdY+9NS/SmyD+R2yZFbtVMbiFlSiR3Z+UUXq786pN0r2Q3fg6fRTwqo7pjaQ0Pn7OTiIC/kW2INLNW45OIIm+BXcGhiC/jJseE+XLYFtZrjtWfR4y0mXffTXT7VVw/3st9Xd4VzPT9CwB7HYU9ocBuB9hbKOxJBXYdN0RrG7ATWIFdz43g91LYcwxGxpiH/t4CsGcV2Ps4P76OexJgZxXYw6siPoBUbEc3lYXVG7l+NA3jKvZScWFtVXupknjh1qO7F7ivv0Z+53Lu0wjOYyj5TRXIvPzYa2+c36fqWoZnHoJ+b63vl8lYm5LfFIpS28Luo1w/6/dR6Pe1Sr8cy/GTxzz75m/kPk36hafRPZRPxfNtSgMCNB0APCMf69TAnMp4kj/ik9q7f65P3TcHZO3YQcc/DOPfD+OTHD3EkVSX5R60Z8iZWni3KL98//6r9u+GlwGn5cFB8u4hbgi9gSOrmKEG9NapNDV+JtJ73R+/k5W7lYyiaIqkaIrwBk02bPK7bG2Oln5omn1OO2lyQ6VBQ6chI3/KfFziHkMPqPqBCgGtAMTIbFIb3NdMRxtdgckrDhJFCNVRC2TYAbPfbW/Xm5v6NV3hmjb3mMFksNl7yHC8vTQky9A8zPVb6LwR7jOxASN0K1ZXXuDeMkPXsMDfEXQ/t8JyFg24pGEbcNrYMeZOwowaPyDVtPc5/H6HIxB4C1wOaHMjAYc9ELDDV3ZnYz4Oc9or+yGlcvQfDPM4fJWb7C7T9gbOjw5xT9JxTDBOGx2HjNdJpdi4QeolVSqlyGWy201wcf58IpnPJxP5lIvn3W6ed7H+gW9Qev+3+k/29CQ7HY5O0v9KLh6TpFg8l7LxVrvdyttkmXnrqohmYQaNtHeOyUwraqG9ixLLaGhFeUHhHuftAUeyx9cSzrh9qmyz32sL2CCT2GQxd1h1jfo0Io722YJa/90+wYaxvznDaUhG5P8DKD5xZwABAAAAAQzMTspD0l8PPPUACQPoAAAAAM2XgKcAAAAAzZfjGP8s/p8EqAPDAAAACQACAAAAAAAAeAFjYGRgYL7x7z0DA8ux/zr/vrOsAIqggo8AuyEIUgB4AW3TA4xeQRTF8TN3atu2bdu2bdt2o25UREVcRrWjmjGLqLb1+n+zVvLLucO8O5vPDmmY4r97gDWI/tlwDbVOamyLyTIa6v6Ryxjvoy6DdyoV73HfmH+JBBxhfVBSjiQrq4ZVURnbo0FWKvrjK6mIlVd+9zX6Y+VUy/KqmTVTb3dftcm67rdqu/Yqa7lYa8B8DrVzOaPHloe6oHr7vuptjVA93k825sxy1k6plJutYlZP3dx75bM3jJ+pQFy7i6oS+smC7xL9DT3ST1quTPSLHgeQX2MpvWVW348l6S+t0N9uVbBRnKPHrPjCahb3Tc/p5ZBDa5cj+orX1Ck9Z8V3IMexTu9phd5htdQovNUs3nULNqqcOdVCH1RGKRRJynpJaqO6K6qOaJiSbTU0uKRaqM/cAPccRdUKXalboWtijTJqiBbuJnmT7KI6wVPV8ZXI+N7u3PWFb+2m/qiLMaiBSiFHKZ8ijSaLhzyjRuH7RtLDa+69qHJ+rpowV9Ut0xBURkXUQIVMc5OoF6tsSo4Lb1ES9dEURVAC7TU2GhnzvVXBl1Ur3xY1VYG1Kkkah8ysJSqFukn43yXgJrZhNdYkzR3DOSnagPk4g+tYglmYiSlJ67OSHEhyJLgnxb+T/+MKsQQAeAEtwQMUIzkAANDaSmZSt0kxSnK3to2HtW3bts2HtW3btm3btv7X6XT1/12p9+sb6mfqrxtEQ3vDcsNxo8FY2tjWeNGkmrqatpu5ua/5uSVsqWuZaoXW1tal1tu2qrbj9qB9pP2xI7fjpvN/Z33nUudrV9I12/XRXdi90UM97T2XvUlvV+9an+zr6zsLbEAEBHCQExQFZcF6sBscB5fBffAafIcO6IdJ+D/MDYvD8rA2bA5fC6WFykJ9obXQXRgsXBeJyMWcYlGxrFhTbIrCSEaZUX5UGlVG9VFr1B0NRvPRarQdHUbn0W303F/RfzdQP9A60D0wODA+MD2wOKgGh4YsoaHh7OG+4c0RW6RzZH80Hh0Y3RwrGlscOxp7G9fFXfHc8brxlfHP2IejuCBuiNvinngwnoiX4r34JL6KX+KPxEUIoaQsaUgGk4VkL7mZKJiYmdicOJq4n9Ql1eTk5MFU0dTBdNX03vTx9MX07fRTSZZKS0Olu7Is/y9nl4fK+xWDUlM5quZU52tpras2UZuqLdd2aqe1u9RGozQv7U9H05X0NHMwzhqy7mwnO8zOsuvsIXvNvnIL93HK8/LKvCmfzNfyz/9l/q/4f33/W/vf3f/F//P/3/TXtj8B7WaMQAAAAAABAAAA8QBVAAcAaQAFAAEAAAAAAAoAAAIAAXMAAwABeAGVkLN2RGEUhb/YeYbbx7bZxE41tueyTZ2Hzl5nxZ7162wOgB7u6aCts482JuF5bmdYyGbdx6w/z53vPF088Pg8dzPaNvw8D3PYtswFVTwaJEnjCMWp0NR0Kq5qTJoyeRJCJVKcC2fxNMflmGKcSeZ0Vthil232NL3vfG587hv73PecO7HktbSGvHlpFZwP7adKOj84tOTIiXNJmuLzrOksmFomTpG0eTJiS/YdpjXN2Vmylla+eQ5Xq8YyE1qBrXHiUqrypDUnNZWluUTypTWV7N+L6x23fJnSE374RZx4AWzBRQHCAAAAwNtWBXeG2w93d2ISjARQgDsh8H2L/fMhCINIJCEpJS0jKyevoKikrKIqVlPX0NTS1tHV0zcwNDI2MTUzt7C0sraxtbN3cHRydnF1c/fw9PoRBA/dQihgAADne+/atm/9jLzMWmbb9sl2q2zbtnky19m1bsY+t9ywX0+9LNPbHX3cdNsDd91zX1+PPfTIAf0sd9AzTzzV3ycffDHQAIMMMdhQGw0zwnAjjTLGaGON89x4E00wyRSTbXLIfNNMNd0Mn5320ddIiESp8hUoVKRYiVJlylXIla1SlQRb1NksTaLjTjjqmKuuOe+CXXbLiSSHHXHFXM2ly9BYU111l6ebJt7LNMc8Cy1QLymSIyVSIy3SIyMyIyuyrbM+ciLXTOckm21N5JnlbORL8cdvf2X55ruTalSrtVIzPWyNAi0s9sJLS7zy1rsojKIojpIojbIoj4qojKqojpqojbqojwbRMKFN51at/mvR4f++3f41NRZGDMMwACyTZgnjcXGPMrdhXD5gmRLb/ye8dzedZ/+Xrm/2i+B/U5MsTBZpERBZpc/4hrHlPchitPoWB+r1H/z6BpS+oRdsIIoNvc1OpG+GMyeHLA76laZpOLh6i7R0HSjVyymkMQMopZgJlFLMAkopZlP6QCnlNkApYqYHlDymb/TpS03jTwtov73SAAAAsAArALIBAQIrAbICAgIrAbcCMCYeFw4ACCu3Ay4mHhcOAAgrALcBOzAmHBIACCsAsgQIByuwACBFfWkYREuwYFJYsAEbsABZsAGOAA==) format('woff')}</style><link rel="preload" href="Colorful%20Image%20Colorization%20|%20SpringerLink_files/integrator.js" as="script"><script type="text/javascript" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/integrator.js"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/pubads_impl_195.js" async=""></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
#MathJax_Message {margin: 0}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><button href="javascript:;" title="focus catcher" class="js-focus-catcher u-screenreader-only" tabindex="-1"></button><div id="popup-search" class="u-composite-layer popup-search-theme" style="top:-60px;left:-60px;visibility:hidden;opacity:0;" aria-hidden="true" aria-label="popup"><svg class="popup-arrow" xmlns="http://www.w3.org/2000/svg" width="33.7" height="18.4" viewBox="0 0 33.7 18.4"><path class="fill" fill="#F7FBFE" d="M1.4 18.4h30.9l-15.5-16.9z"></path><path class="stroke" fill="#98BED7" d="M0 18.4h1.4l15.4-16.9 15.5 16.9h1.4l-16.9-18.4z"></path></svg><div class="popup-arrow popup-arrow-shadow icon--popup-arrow-shadow"></div><div class="popup__search"><div class="popup-base-theme__inner" data-component="SpringerLink-Popup-inner"></div></div><button tabindex="-1" class="popup-close icon--close-btn" data-component="SpringerLink-Popup-close">close</button></div><div id="popup-references" class="u-composite-layer popup-base-theme" style="top:-60px;left:-60px;visibility:hidden;opacity:0;" aria-hidden="true" aria-label="popup"><svg class="popup-arrow" xmlns="http://www.w3.org/2000/svg" width="33.7" height="18.4" viewBox="0 0 33.7 18.4"><path class="fill" fill="#F7FBFE" d="M1.4 18.4h30.9l-15.5-16.9z"></path><path class="stroke" fill="#98BED7" d="M0 18.4h1.4l15.4-16.9 15.5 16.9h1.4l-16.9-18.4z"></path></svg><div class="popup-arrow popup-arrow-shadow icon--popup-arrow-shadow"></div><div class="popup__references"><div class="popup-base-theme__inner" data-component="SpringerLink-Popup-inner"></div></div><button tabindex="-1" class="popup-close icon--close-btn" data-component="SpringerLink-Popup-close">close</button></div>
        <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-WCF9Z9"
                      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="skip-to">
    <a class="skip-to__link skip-to__link--article" href="#main-content">Skip to main content</a>
        <a class="skip-to__link skip-to__link--contents" href="#article-contents">Skip to sections</a>
</nav>
        <div class="page-wrapper">
            <noscript>
    <div class="nojs-banner u-interface">
        <p>This service is more advanced with JavaScript available, learn more at <a
                href="http://activatejavascript.org" target="_blank" rel="noopener">http://activatejavascript.org</a>
        </p>
    </div>
</noscript>
                    <div id="leaderboard" class="leaderboard u-hide" data-component="SpringerLink.GoogleAds" data-namespace="leaderboard"><div class="leaderboard__wrapper"><p class="leaderboard__label">Advertisement</p><button class="leaderboard__hide" title="Hide this advertisement">Hide</button><div id="doubleclick-leaderboard-ad" class="leaderboard__ad"><div id="google_ads_iframe_270604982/springerlink/book/chapter_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_270604982/springerlink/book/chapter_0" title="3rd party ad content" name="google_ads_iframe_270604982/springerlink/book/chapter_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" width="728" height="90" frameborder="0"></iframe></div></div></div></div>

                <header id="header" class="header u-interface" role="banner">
        <div class="header__content">
            <div class="header__menu-container">
                    <a id="logo" class="site-logo" href="https://link.springer.com/" title="Go to homepage">
                <div class="u-screenreader-only">SpringerLink</div>
    <svg class="site-logo__springer" width="148" height="30" role="img" aria-label="SpringerLink Logo">
        <image width="148" height="30" alt="SpringerLink Logo" src="/springerlink-static/1203499612/images/png/springerlink.png" xlink="http://www.w3.org/1999/xlink" xlink:href="/springerlink-static/1203499612/images/svg/springerlink.svg"></image>
    </svg>

    </a>


                    <nav id="search-container" class="u-inline-block">
                        <div class="search">
                            <div class="search__content">
                                <form class="u-form-single-input" action="/search" method="get" role="search">
    <input aria-label="Search SpringerLink" name="query" autocomplete="off" placeholder="Search SpringerLink" type="text">
    <input class="u-hide-text" value="Submit" title="Submit" type="submit">
    <svg class="u-vertical-align-absolute" width="13" height="13" viewBox="222 151 13 13" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <path d="M227 159C228.7 159 230 157.7 230 156 230 154.3 228.7 153 227 153 225.3 153 224 154.3 224 156 224 157.7 225.3 159 227 159L227 159 227 159 227 159ZM230 160.1L231.1 159 233.9 161.7C234.2 162.1 234.2 162.6 233.9 162.9 233.6 163.2 233.1 163.2 232.7 162.9L230 160.1 230 160.1 230 160.1 230 160.1ZM227 161L227 161C224.2 161 222 158.8 222 156 222 153.2 224.2 151 227 151 229.8 151 232 153.2 232 156 232 158.8 229.8 161 227 161L227 161 227 161 227 161 227 161Z" stroke="none" fill-rule="evenodd"></path>
    </svg>
</form>
                            </div>
                        </div>
                    </nav>

                    <nav class="nav-container u-interface">
    <div class="global-nav__wrapper">
        <div class="search-button">
            <a class="search-button__label" href="#search-container" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-search">
                <span class="search-button__title">Search</span><svg width="12" height="12" viewBox="222 151 12 12" version="1.1" xmlns="http://www.w3.org/2000/svg">
                    <path d="M227 159C228.7 159 230 157.7 230 156 230 154.3 228.7 153 227 153 225.3 153 224 154.3 224 156 224 157.7 225.3 159 227 159L227 159 227 159 227 159ZM230 160.1L231.1 159 233.9 161.7C234.2 162.1 234.2 162.6 233.9 162.9 233.6 163.2 233.1 163.2 232.7 162.9L230 160.1 230 160.1 230 160.1 230 160.1ZM227 161L227 161C224.2 161 222 158.8 222 156 222 153.2 224.2 151 227 151 229.8 151 232 153.2 232 156 232 158.8 229.8 161 227 161L227 161 227 161 227 161 227 161Z" stroke="none" fill-rule="evenodd"></path>
                </svg>
            </a>
        </div>

        <ul class="global-nav" data-component="SpringerLink.Menu" data-title="Navigation menu" data-text="Menu">
            <li>
                <a href="https://link.springer.com/">
                    <span class="u-overflow-ellipsis">Home</span>
                </a>
            </li>
            <li>
                <a href="https://link.springer.com/contactus">
                    <span class="u-overflow-ellipsis">Contact us</span>
                </a>
            </li>

                <li class="global-nav__logged-out">
                    <a class="test-login-link" href="https://link.springer.com/signup-login?previousUrl=https%3A%2F%2Flink.springer.com%2Fchapter%2F10.1007%2F978-3-319-46487-9_40">
                        <span class="u-overflow-ellipsis">Log in</span>
                    </a>
                </li>

        </ul><div class="main-menu u-composite-layer c-button-dropdown c-button-dropdown--ghost" data-component="SV.Dropdown" data-namespace="Menu" aria-label="button with dropdown options" style=""><button type="button" title="Navigation menu" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="Dropdown.Menu-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">Menu</span><span class="c-button-dropdown__icon"></span></button><div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="Dropdown.Menu-dropdown"><ul class="main-menu__content" data-role="button-dropdown__content"><li>
                <a href="https://link.springer.com/">
                    <span class="u-overflow-ellipsis">Home</span>
                </a>
            </li><li>
                <a href="https://link.springer.com/contactus">
                    <span class="u-overflow-ellipsis">Contact us</span>
                </a>
            </li><li class="global-nav__logged-out">
                    <a class="test-login-link" href="https://link.springer.com/signup-login?previousUrl=https%3A%2F%2Flink.springer.com%2Fchapter%2F10.1007%2F978-3-319-46487-9_40">
                        <span class="u-overflow-ellipsis">Log in</span>
                    </a>
                </li></ul></div></div>
    </div> 
</nav> 
            </div>

        </div>
    </header>

            

            <main id="main-content" class="main-wrapper">
                <div class="main-container uptodate-recommendations-off">
                    <aside class="main-sidebar-left">
                        <div class="main-sidebar-left__content">
                            <div class="test-cover cover-image" itemscope="">
        <a class="test-cover-link" href="https://link.springer.com/book/10.1007/978-3-319-46487-9" title="Computer Vision – ECCV 2016">
            <img class="test-cover-image" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/978-3-319-46487-9.jpg" alt="Computer Vision – ECCV 2016" itemprop="image">
        </a>

</div>
                        </div>
                    </aside>
                    <div class="main-body" data-role="NavigationContainer">
                        

            <div class="cta-button-container cta-button-container--top u-hide-two-col" aria-hidden="true">
                    <div class="c-button-dropdown--blue download-book-options test-download-book-options u-interface c-button-dropdown" data-component="SV.Dropdown" aria-label="button with dropdown options">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="DownloadOptions-hidden.1719188111-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Download</span>
    <span class="hide-text-small">book</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="DownloadOptions-hidden.1719188111-dropdown"><ul class="download-book-options__content" data-role="button-dropdown__content">
        <li>
            <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-319-46487-9.pdf" title="Download this book in PDF format" target="_blank" rel="noopener" class="gtm-bookpdf-link test-bookpdf-link">
                <span class="download-book-options__types gtm-bookpdf-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>PDF</span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://link.springer.com/download/epub/10.1007%2F978-3-319-46487-9.epub" title="Download this book in EPUB format" target="_blank" rel="noopener" class="gtm-bookepub-link test-bookepub-link">
                <span class="download-book-options__types gtm-bookepub-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>EPUB</span>
                </span>
            </a>
        </li>
</ul></div>

    </div>

            </div>


                        <article class="main-body__content">
                            <div xmlns="http://www.w3.org/1999/xhtml" class="FulltextWrapper"><div class="ArticleHeader main-context"><div id="enumeration" class="enumeration">    <div>
        <a class="gtm-confseries-link" data-test="ConfSeriesLink" href="https://link.springer.com/conference/eccv">
            <span data-test="ConfSeriesName"> European Conference on Computer Vision</span>
        </a>
    </div>
<p class="test-LocationInConferenceProceeding icon--meta-keyline-before"><span data-test="ConferenceAcronym">ECCV 2016</span>: <span class="BookTitle"><a href="https://link.springer.com/book/10.1007/978-3-319-46487-9" class="gtm-book-link">Computer Vision – ECCV 2016</a></span><span class="page-numbers-info">
                pp 649-666</span><span class="u-inline-block u-ml-4"> |
                <a class="gtm-cite-link" href="#citeas">Cite as</a></span></p></div><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">Colorful Image Colorization</h1></div><div class="authors u-clearfix authors--enhanced" data-component="SpringerLink.Authors"><ul class="u-interface u-inline-list authors__title" data-role="AuthorsNavigation"><li><a href="#authors" class="gtm-tab-authors selected">Authors</a></li><li><a href="#authorsandaffiliations" class="gtm-tab-authorsandaffiliations">Authors and affiliations</a></li></ul><span class="marker" style="width: 160px;"></span><div class="authors__list" data-role="AuthorsList" id="authors"><ul class="test-contributor-names"><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors__name">Richard&nbsp;Zhang</span></li><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors__name">Phillip&nbsp;Isola</span><span class="author-information"><span class="authors__contact"><a href="mailto:isola@eecs.berkeley.edu" title="isola@eecs.berkeley.edu" itemprop="email" class="gtm-email-author">Email author</a></span></span></li><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors__name">Alexei&nbsp;A.&nbsp;Efros</span></li></ul></div><div class="authors__affiliations" id="authorsandaffiliations"><div class="authors-affiliations u-interface"><ul class="test-contributor-names"><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors-affiliations__name">Richard&nbsp;Zhang</span><ul class="authors-affiliations__indexes u-inline-list" data-role="AuthorsIndexes"><li data-affiliation="affiliation-1">1</li></ul></li><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors-affiliations__name">Phillip&nbsp;Isola</span><ul class="authors-affiliations__indexes u-inline-list" data-role="AuthorsIndexes"><li data-affiliation="affiliation-1">1</li></ul><span class="author-information"><span class="author-information__contact u-icon-before icon--email-before"><a href="mailto:isola@eecs.berkeley.edu" title="isola@eecs.berkeley.edu" itemprop="email" class="gtm-email-author">Email author</a></span></span></li><li itemscope="" itemtype="http://schema.org/Person" class="u-mb-2 u-pt-4 u-pb-4"><span itemprop="name" class="authors-affiliations__name">Alexei&nbsp;A.&nbsp;Efros</span><ul class="authors-affiliations__indexes u-inline-list" data-role="AuthorsIndexes"><li data-affiliation="affiliation-1">1</li></ul></li></ul><ol class="test-affiliations"><li class="affiliation" data-test="affiliation-1" data-affiliation-highlight="affiliation-1" itemscope="" itemtype="http://schema.org/Organization"><span class="affiliation__count">1.</span><span class="affiliation__item"><span itemprop="name" class="affiliation__name">University of California</span><span itemprop="address" itemscope="" itemtype="http://schema.org/PostalAddress"><span itemprop="addressRegion" class="affiliation__city">Berkeley</span><span itemprop="addressCountry" class="affiliation__country">USA</span></span></span></li></ol></div></div></div><div class="main-context__container" data-component="SpringerLink.ArticleMetrics"><div class="main-context__column"><span><span class="test-render-category">Conference paper</span></span><div class="article-dates" data-component="SpringerLink.ArticleDates"><div class="article-dates__entry"><span class="article-dates__label">First Online: </span><span class="article-dates__first-online"><time datetime="2016-09-17">17 September 2016</time></span></div><div class="article-dates__history"></div></div></div><div class="main-context__column">    <ul id="book-metrics" class="article-metrics u-sansSerif">
            <li class="article-metrics__item">
                    <a class="article-metrics__link gtm-chaptercitations-count" href="http://www.bookmetrix.com/detail/chapter/425cac02-926f-4596-8ddd-6b39ec75ce0a#citations" target="_blank" rel="noopener" title="Visit Bookmetrix for full citation details" id="chaptercitations-link">
                            <span id="chaptercitations-count-number" class="test-metric-count c-button-circle gtm-chaptercitations-count">15</span>
                       <span class="test-metric-name article-metrics__label gtm-chaptercitations-count">Citations</span>
                    </a>
            </li>
            <li class="article-metrics__item">
                    <a class="article-metrics__link gtm-chapterreaders-count" href="http://www.bookmetrix.com/detail/chapter/425cac02-926f-4596-8ddd-6b39ec75ce0a#readers" target="_blank" rel="noopener" title="Visit Bookmetrix for full Mendeley reader details" id="chapterreaders-link">
                            <span id="chapterreaders-count-number" class="test-metric-count c-button-circle gtm-chapterreaders-count">323</span>
                       <span class="test-metric-name article-metrics__label gtm-chapterreaders-count">Readers</span>
                    </a>
            </li>
            <li class="article-metrics__item">
                    <a class="article-metrics__link gtm-chapterdownloads-count" href="http://www.bookmetrix.com/detail/chapter/425cac02-926f-4596-8ddd-6b39ec75ce0a#downloads" target="_blank" rel="noopener" title="Visit Bookmetrix for full download details" id="chapterdownloads-link">
                            <span id="chapterdownloads-count-number" class="test-metric-count c-button-circle gtm-chapterdownloads-count">6.4k</span>
                       <span class="test-metric-name article-metrics__label gtm-chapterdownloads-count">Downloads</span>
                    </a>
            </li>
    </ul>
</div></div><span id="test-SeriesTitle" class="vol-info">
                Part of the
                <a class="gtm-book-series-link" href="https://link.springer.com/bookseries/558">Lecture Notes in Computer Science</a>
                book series (LNCS, volume 9907)</span></div><section class="Abstract" id="Abs1" tabindex="-1" lang="en"><h2 class="Heading">Abstract</h2><p id="Par1" class="Para">Given a grayscale photograph as input, this paper attacks the problem of hallucinating a <em class="EmphasisTypeItalic ">plausible</em>
 color version of the photograph. This problem is clearly 
underconstrained, so previous approaches have either relied on 
significant user interaction or resulted in desaturated colorizations. 
We propose a fully automatic approach that produces vibrant and 
realistic colorizations. We embrace the underlying uncertainty of the 
problem by posing it as a classification task and use class-rebalancing 
at training time to increase the diversity of colors in the result. The 
system is implemented as a feed-forward pass in a CNN at test time and 
is trained on over a million color images. We evaluate our algorithm 
using a “colorization Turing test,” asking human participants to choose 
between a generated and ground truth color image. Our method 
successfully fools humans on 32&nbsp;% of the trials, significantly 
higher than previous methods. Moreover, we show that colorization can be
 a powerful pretext task for self-supervised feature learning, acting as
 a <em class="EmphasisTypeItalic ">cross-channel encoder</em>. This approach results in state-of-the-art performance on several feature learning benchmarks.</p></section><div class="KeywordGroup" lang="en"><h2 class="Heading">Keywords</h2><span class="Keyword">Colorization&nbsp;</span><span class="Keyword">Vision for graphics&nbsp;</span><span class="Keyword">CNNs&nbsp;</span><span class="Keyword">Self-supervised learning&nbsp;</span></div><div class="note test-pdf-link" id="cobranding-and-download-availability-text"><div>    <a class="gtm-pdf-link" href="https://link.springer.com/content/pdf/10.1007%2F978-3-319-46487-9_40.pdf" target="_blank" rel="noopener">Download</a>
 conference paper PDF</div></div><div class="article-actions--inline" id="article-actions--inline" data-component="article-actions--inline"><div class="citations u-interface c-button-dropdown" data-component="SV.Dropdown" data-namespace="citations--inline" aria-label="button with dropdown options">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="Dropdown.citations--inline-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Cite</span>
    <span class="hide-text-small">paper</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="Dropdown.citations--inline-dropdown"><ul class="citations__content" data-role="button-dropdown__content">
    <li>
        <a href="#citeas" class="gtm-cite-dropdown">How to cite?</a>
    </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=refman&amp;flavour=citation" title="Download this paper's citation as a .RIS file" class="gtm-export-citation" data-gtmlabel="RIS">
                <span class="citations__extension" data-gtmlabel="RIS">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .RIS
                </span>
                <span class="citations__types">
                        <span>
                            Papers
                        </span>
                        <span>
                            Reference Manager
                        </span>
                        <span>
                            RefWorks
                        </span>
                        <span>
                            Zotero
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=endnote&amp;flavour=citation" title="Download this paper's citation as a .ENW file" class="gtm-export-citation" data-gtmlabel="ENW">
                <span class="citations__extension" data-gtmlabel="ENW">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .ENW
                </span>
                <span class="citations__types">
                        <span>
                            EndNote
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=bibtex&amp;flavour=citation" title="Download this paper's citation as a .BIB file" class="gtm-export-citation" data-gtmlabel="BIB">
                <span class="citations__extension" data-gtmlabel="BIB">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .BIB
                </span>
                <span class="citations__types">
                        <span>
                            BibTeX
                        </span>
                        <span>
                            JabRef
                        </span>
                        <span>
                            Mendeley
                        </span>
                </span>
            </a>
        </li>
</ul></div>
    </div></div><div id="body"><section id="Sec1" tabindex="-1" class="Section1 RenderAsSection1"><h2 class="Heading js-ShowContent" data-role="collapsible-handle" tabindex="-1"><span class="HeadingNumber">1 </span>Introduction<span class="section-icon"></span></h2><div class="content"><p id="Par2" class="Para">Consider the grayscale photographs in Fig.&nbsp;<span class="InternalRef"><a href="#Fig1">1</a></span>.
 At first glance, hallucinating their colors seems daunting, since so 
much of the information (two out of the three dimensions) has been lost.
 Looking more closely, however, one notices that in many cases, the 
semantics of the scene and its surface texture provide ample cues for 
many regions in each image: the grass is typically green, the sky is 
typically blue, and the ladybug is most definitely red. Of course, these
 kinds of semantic priors do not work for everything, e.g., the croquet 
balls on the grass might not, in reality, be red, yellow, and purple 
(though it’s a pretty good guess). However, for this paper, our goal is 
not necessarily to recover the actual ground truth color, but rather to 
produce a <em class="EmphasisTypeItalic ">plausible</em> colorization 
that could potentially fool a human observer. Therefore, our task 
becomes much more achievable: to model enough of the statistical 
dependencies between the semantics and the textures of grayscale images 
and their color versions in order to produce visually compelling 
results.</p><p id="Par3" class="Para">Given the lightness channel <em class="EmphasisTypeItalic ">L</em>, our system predicts the corresponding <em class="EmphasisTypeItalic ">a</em> and <em class="EmphasisTypeItalic ">b</em> color channels of the image in the CIE <em class="EmphasisTypeItalic ">Lab</em>
 colorspace. To solve this problem, we leverage large-scale data. 
Predicting color has the nice property that training data is practically
 free: any color photo can be used as a training example, simply by 
taking the image’s <em class="EmphasisTypeItalic ">L</em> channel as input and its <em class="EmphasisTypeItalic ">ab</em>
 channels as the supervisory signal. Others have noted the easy 
availability of training data, and previous works have trained 
convolutional neural networks (CNNs) to predict color on large datasets [<span class="CitationRef"><a href="#CR1" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">1</a></span>, <span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>]. However, the results from these previous attempts tend to look desaturated. One explanation is that [<span class="CitationRef"><a href="#CR1" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">1</a></span>, <span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>]
 use loss functions that encourage conservative predictions. These 
losses are inherited from standard regression problems, where the goal 
is to minimize Euclidean error between an estimate and the ground truth.</p><div id="Par4" class="Para">We instead utilize a loss tailored to the colorization problem. As pointed out by [<span class="CitationRef"><a href="#CR3" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">3</a></span>],
 color prediction is inherently multimodal – many objects can take on 
several plausible colorizations. For example, an apple is typically red,
 green, or yellow, but unlikely to be blue or orange. To appropriately 
model the multimodal nature of the problem, we predict a distribution of
 possible colors for each pixel. Furthermore, we re-weight the loss at 
training time to emphasize rare colors. This encourages our model to 
exploit the full diversity of the large-scale data on which it is 
trained. Lastly, we produce a final colorization by taking the <em class="EmphasisTypeItalic ">annealed-mean</em>
 of the distribution. The end result is colorizations that are more 
vibrant and perceptually realistic than those of previous approaches.<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig1_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig1_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 1.</span> <p class="SimplePara">Example
 input grayscale photos and output colorizations from our algorithm. 
These examples are cases where our model works especially well. Please 
visit <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://richzhang.github.io/colorization/"><span class="RefSource">http://richzhang.github.io/colorization/</span></a></span> to see the full range of results and to try our model and code. Best viewed in color (obviously). (Color figure online)</p> </div></figcaption></figure></div><p id="Par5" class="Para">Evaluating synthesized images is notoriously difficult&nbsp;[<span class="CitationRef"><a href="#CR4" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">4</a></span>].
 Since our ultimate goal is to make results that are compelling to a 
human observer, we introduce a novel way of evaluating colorization 
results, directly testing their perceptual realism. We set up a 
“colorization Turing test,” in which we show participants real and 
synthesized colors for an image, and ask them to identify the fake. In 
this quite difficult paradigm, we are able to fool participants on <span class="InlineEquation" id="IEq1"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: STIXGeneral;">32</span><span class="mspace" id="MathJax-Span-4" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-5" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>32</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">32\,\%</script></span> of the instances (ground truth colorizations would achieve 50&nbsp;% on this metric), significantly higher than prior work [<span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>]. This test demonstrates that in many cases, our algorithm is producing nearly photorealistic results (see Fig.&nbsp;<span class="InternalRef"><a href="#Fig1">1</a></span>
 for selected successful examples from our algorithm). We also show that
 our system’s colorizations are realistic enough to be useful for 
downstream tasks, in particular object classification, using an 
off-the-shelf VGG network [<span class="CitationRef"><a href="#CR5" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">5</a></span>].</p><p id="Par6" class="Para">We
 additionally explore colorization as a form of self-supervised 
representation learning, where raw data is used as its own source of 
supervision. The idea of learning feature representations in this way 
goes back at least to autoencoders [<span class="CitationRef"><a href="#CR6" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">6</a></span>].
 More recent works have explored feature learning via data imputation, 
where a held-out subset of the complete data is predicted (e.g., [<span class="CitationRef"><a href="#CR7" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">7</a></span>, <span class="CitationRef"><a href="#CR8" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">8</a></span>, <span class="CitationRef"><a href="#CR9" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">9</a></span>, <span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>, <span class="CitationRef"><a href="#CR11" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">11</a></span>, <span class="CitationRef"><a href="#CR12" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">12</a></span>, <span class="CitationRef"><a href="#CR13" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">13</a></span>]). Our method follows in this line, and can be termed a <em class="EmphasisTypeItalic ">cross-channel encoder</em>. We test how well our model performs in generalization tasks, compared to previous [<span class="CitationRef"><a href="#CR8" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">8</a></span>, <span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>, <span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>, <span class="CitationRef"><a href="#CR15" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">15</a></span>] and concurrent [<span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>]
 self-supervision algorithms, and find that our method performs 
surprisingly well, achieving state-of-the-art performance on several 
metrics.</p><p id="Par7" class="Para">Our contributions in this paper 
are in two areas. First, we make progress on the graphics problem of 
automatic image colorization by (a) designing an appropriate objective 
function that handles the multimodal uncertainty of the colorization 
problem and captures a wide diversity of colors, (b) introducing a novel
 framework for testing colorization algorithms, potentially applicable 
to other image synthesis tasks, and (c) setting a new high-water mark on
 the task by training on a million color photos. Secondly, we introduce 
the colorization task as a competitive and straightforward method for 
self-supervised representation learning, achieving state-of-the-art 
results on several benchmarks.</p><p id="Par8" class="Para"> <strong class="EmphasisTypeBold ">Prior Work on Colorization.</strong>
 Colorization algorithms mostly differ in the ways they obtain and treat
 the data for modeling the correspondence between grayscale and color. 
Non-parametric methods, given an input grayscale image, first define one
 or more color reference images (provided by a user or retrieved 
automatically) to be used as source data. Then, following the Image 
Analogies framework&nbsp;[<span class="CitationRef"><a href="#CR17" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">17</a></span>], color is transferred onto the input image from analogous regions of the reference image(s)&nbsp;[<span class="CitationRef"><a href="#CR18" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">18</a></span>, <span class="CitationRef"><a href="#CR19" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">19</a></span>, <span class="CitationRef"><a href="#CR20" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">20</a></span>, <span class="CitationRef"><a href="#CR21" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">21</a></span>].
 Parametric methods, on the other hand, learn prediction functions from 
large datasets of color images at training time, posing the problem as 
either regression onto continuous color space&nbsp;[<span class="CitationRef"><a href="#CR1" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">1</a></span>, <span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>, <span class="CitationRef"><a href="#CR22" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">22</a></span>] or classification of quantized color values&nbsp;[<span class="CitationRef"><a href="#CR3" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">3</a></span>].
 Our method also learns to classify colors, but does so with a larger 
model, trained on more data, and with several innovations in the loss 
function and mapping to a final continuous output.</p><div id="Par9" class="Para"> <strong class="EmphasisTypeBold ">Concurrent Work on Colorization.</strong> Concurrently with our paper, Larsson et al. [<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>] and Iizuka et al. [<span class="CitationRef"><a href="#CR24" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">24</a></span>]
 have developed similar systems, which leverage large-scale data and 
CNNs. The methods differ in their CNN architectures and loss functions. 
While we use a classification loss, with rebalanced rare classes, 
Larsson et al. use an un-rebalanced classification loss, and Iizuka et 
al. use a regression loss. In Sect.&nbsp;<span class="InternalRef"><a href="#Sec7">3.1</a></span>,
 we compare the effect of each of these types of loss function in 
conjunction with our architecture. The CNN architectures are also 
somewhat different: Larsson et al. use hypercolumns [<span class="CitationRef"><a href="#CR25" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">25</a></span>] on a VGG network [<span class="CitationRef"><a href="#CR5" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">5</a></span>],
 Iizuka et al. use a two-stream architecture in which they fuse global 
and local features, and we use a single-stream, VGG-styled network with 
added depth and dilated convolutions [<span class="CitationRef"><a href="#CR26" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">26</a></span>, <span class="CitationRef"><a href="#CR27" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">27</a></span>]. In addition, while we and Larsson et al. train our models on ImageNet [<span class="CitationRef"><a href="#CR28" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">28</a></span>], Iizuka et al. train their model on Places [<span class="CitationRef"><a href="#CR29" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">29</a></span>]. In Sect.&nbsp;<span class="InternalRef"><a href="#Sec7">3.1</a></span>, we provide quantitative comparisons to Larsson et al., and encourage interested readers to investigate both concurrent papers.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig2_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig2_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 2.</span> <p class="SimplePara">Our network architecture. Each <span class="EmphasisFontCategoryNonProportional ">conv</span> layer refers to a block of 2 or 3 repeated <span class="EmphasisFontCategoryNonProportional ">conv</span> and <span class="EmphasisFontCategoryNonProportional ">ReLU</span> layers, followed by a <span class="EmphasisFontCategoryNonProportional ">BatchNorm</span> [<span class="CitationRef"><a href="#CR30" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">30</a></span>] layer. The net has no <span class="EmphasisFontCategoryNonProportional ">pool</span> layers. All changes in resolution are achieved through spatial downsampling or upsampling between <span class="EmphasisFontCategoryNonProportional ">conv</span> blocks. (Color figure online)</p> </div></figcaption></figure></div></div></section><section id="Sec2" tabindex="-1" class="Section1 RenderAsSection1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1"><span class="HeadingNumber">2 </span>Approach<span class="section-icon"></span></h2><div class="content"><p id="Par10" class="Para">We
 train a CNN to map from a grayscale input to a distribution over 
quantized color value outputs using the architecture shown in Fig.&nbsp;<span class="InternalRef"><a href="#Fig2">2</a></span>. Architectural details are described in the supplementary materials on our project webpage<span class="InlineEquation" id="IEq2"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.533em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1000.43em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.429em; height: 0px;"><span style="position: absolute; clip: rect(3.857em, 1000em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-9"></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.365em; left: 0em;"><span class="texatom" id="MathJax-Span-10"><span class="mrow" id="MathJax-Span-11"><span class="mn" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.144em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">^{1}</script></span>,
 and the model is publicly available. In the following, we focus on the 
design of the objective function, and our technique for inferring point 
estimates of color from the predicted color distribution.</p><section id="Sec3" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">2.1 </span>Objective Function</h3><div id="Par11" class="Para">Given an input lightness channel <span class="InlineEquation" id="IEq3"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 6.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.304em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.544em, 1005.3em, 2.727em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: STIXGeneral; font-weight: bold;">X</span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-19" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.265em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.71em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.391em; left: 0.747em;"><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-26" style="font-size: 70.7%; font-family: STIXGeneral;">×</span><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span class="mo" id="MathJax-Span-28" style="font-size: 70.7%; font-family: STIXGeneral;">×</span><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.092em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">\mathbf {X}\in \mathbb {R}^{H\times W\times 1}</script></span>, our objective is to learn a mapping <span class="InlineEquation" id="IEq4"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 5.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.388em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.932em, 1004.34em, 3.407em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="texatom" id="MathJax-Span-34"><span class="mrow" id="MathJax-Span-35"><span class="munderover" id="MathJax-Span-36"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-weight: bold;">Y</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-38" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-40" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.058em;"></span></span></span></span><span class="mo" id="MathJax-Span-43" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-44"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral; font-weight: bold;">X</span></span></span><span class="mo" id="MathJax-Span-47" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.565em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Y</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">\mathbf {\widehat{Y}} = \mathcal {F}(\mathbf {X})</script></span> to the two associated color channels <span class="InlineEquation" id="IEq5"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 6.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.304em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.544em, 1005.3em, 2.727em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-53" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-54" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.265em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.71em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.391em; left: 0.747em;"><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-61" style="font-size: 70.7%; font-family: STIXGeneral;">×</span><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span class="mo" id="MathJax-Span-63" style="font-size: 70.7%; font-family: STIXGeneral;">×</span><span class="mn" id="MathJax-Span-64" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.092em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mn>2</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-5">\mathbf {Y} \in \mathbb {R}^{H\times W \times 2}</script></span>, where <em class="EmphasisTypeItalic ">H</em>,&nbsp;<em class="EmphasisTypeItalic ">W</em> are image dimensions. (We denote predictions with a <span class="InlineEquation" id="IEq6"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.355em, 1000.33em, 2.17em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="munderover" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 0.333em; height: 0px;"><span style="position: absolute; clip: rect(3.427em, 1000.2em, 3.954em, -1000em); top: -4.002em; left: 0.024em;"><span class="mo" id="MathJax-Span-70" style="font-family: STIXGeneral;">⋅</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.183em, 1000.32em, 3.64em, -1000em); top: -4.046em; left: 0em;"><span class="mo" id="MathJax-Span-71" style=""><span style="font-family: STIXGeneral;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: 0.177em; border-left: 0px solid; width: 0px; height: 0.758em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mo>⋅</mo><mo>^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6">\widehat{\cdot }</script></span> symbol and ground truth without.) We perform this task in CIE <em class="EmphasisTypeItalic ">Lab</em> color space. Because distances in this space model perceptual distance, a natural objective function, as used in [<span class="CitationRef"><a href="#CR1" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">1</a></span>, <span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>], is the Euclidean loss <span class="InlineEquation" id="IEq7"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mtext&gt;L&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-72" style="width: 3.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.7em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1002.65em, 2.877em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-73"><span class="msubsup" id="MathJax-Span-74"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.6em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mtext" id="MathJax-Span-75" style="font-family: STIXGeneral;">L</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.611em;"><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="mn" id="MathJax-Span-78" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-80" style="font-family: STIXGeneral;">⋅</span><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-82" style="font-family: STIXGeneral; padding-left: 0.188em;">⋅</span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>L</mtext><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo>,</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">\text {L}_{2}(\cdot ,\cdot )</script></span> between predicted and ground truth colors:<div id="Equ1" class="Equation EquationMathjax"><div class="EquationContent"><span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: left; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mtext&gt;L&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;&amp;#x2225;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-84" style="width: 17.649em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.465em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.472em, 1014.3em, 3.464em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="mtable" id="MathJax-Span-86" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 14.113em; height: 0px;"><span style="position: absolute; clip: rect(2.256em, 1014.11em, 5.248em, -1000em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.113em; height: 0px;"><span style="position: absolute; clip: rect(2.505em, 1014.11em, 5.496em, -1000em); top: -4.251em; right: 0em;"><span class="mtd" id="MathJax-Span-87"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 1.04em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.6em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mtext" id="MathJax-Span-90" style="font-family: STIXGeneral;">L</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.611em;"><span class="texatom" id="MathJax-Span-91"><span class="mrow" id="MathJax-Span-92"><span class="mn" id="MathJax-Span-93" style="font-size: 70.7%; font-family: STIXGeneral;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="munderover" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="texatom" id="MathJax-Span-100"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-103" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-104" style="font-family: STIXGeneral;">,</span><span class="texatom" id="MathJax-Span-105" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-110" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.181em, 1000.39em, 4.147em, -1000em); top: -4.678em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-111" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.181em, 1000.47em, 4.147em, -1000em); top: -3.316em; left: 50%; margin-left: -0.25em;"><span class="mn" id="MathJax-Span-112" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.856em, 1000.62em, 1.205em, -1000em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.62em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="munderover" id="MathJax-Span-113" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1001.2em, 4.622em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-114" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.374em, 1000.99em, 4.346em, -1000em); top: -2.852em; left: 0.145em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-118" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: STIXGeneral; padding-left: 0.313em;">∥</span><span class="msubsup" id="MathJax-Span-121" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 5.468em; height: 0px;"><span style="position: absolute; clip: rect(2.848em, 1005.04em, 4.396em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 1.799em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.722em;"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-134" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 2.056em; height: 0px;"><span style="position: absolute; clip: rect(2.848em, 1000.98em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-135"><span class="mrow" id="MathJax-Span-136"><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="munderover" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-143" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.979em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.379em, 1000.43em, 4.147em, -1000em); top: -4.738em; left: 5.04em;"><span class="mn" id="MathJax-Span-149" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.379em, 1000.43em, 4.147em, -1000em); top: -3.717em; left: 5.04em;"><span class="mn" id="MathJax-Span-150" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.402em; border-left: 0px solid; width: 0px; height: 3.414em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mtext>L</mtext><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></munder><mo>∥</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo mathvariant="bold">^</mo></mover></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub></mrow><mn>2</mn><mn>2</mn></msubsup></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\begin{aligned} \text {L}_{2}(\mathbf {\widehat{\mathbf{Y}}},\mathbf {Y}) = \frac{1}{2} \sum _{h,w} \parallel {\mathbf {Y}_{h,w}-\mathbf {\widehat{\mathbf{Y}}}_{h,w}}_2^2 \end{aligned}</script></div> <div class="EquationNumber">(1)</div></div>However,
 this loss is not robust to the inherent ambiguity and multimodal nature
 of the colorization problem. If an object can take on a set of distinct
 <em class="EmphasisTypeItalic ">ab</em> values, the optimal solution to
 the Euclidean loss will be the mean of the set. In color prediction, 
this averaging effect favors grayish, desaturated results. Additionally,
 if the set of plausible colorizations is non-convex, the solution will 
in fact be out of the set, giving implausible results.</div><p id="Par12" class="Para">Instead, we treat the problem as multinomial classification. We quantize the <em class="EmphasisTypeItalic ">ab</em> output space into bins with grid size 10 and keep the <span class="InlineEquation" id="IEq8"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;313&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-151" style="width: 4.245em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.472em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1003.4em, 2.882em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-155" style="font-family: STIXGeneral; padding-left: 0.313em;">313</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.281em; border-left: 0px solid; width: 0px; height: 1.164em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>=</mo><mn>313</mn></math></span></span><script type="math/tex" id="MathJax-Element-9">Q=313</script></span> values which are in-gamut, as shown in Fig.&nbsp;<span class="InternalRef"><a href="#Fig3">3</a></span>(a). For a given input <span class="InlineEquation" id="IEq9"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-156" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1000.7em, 2.7em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-157"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral; font-weight: bold;">X</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.942em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-10">\mathbf {X}</script></span>, we learn a mapping <span class="InlineEquation" id="IEq10"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 5.21em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.243em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.932em, 1004.2em, 3.407em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="texatom" id="MathJax-Span-163"><span class="mrow" id="MathJax-Span-164"><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="munderover" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-169" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-171" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177" style="font-family: STIXGeneral; font-weight: bold;">X</span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.565em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">G</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">\mathbf {\widehat{Z}} = \mathcal {G}(\mathbf {X})</script></span> to a probability distribution over possible colors <span class="InlineEquation" id="IEq11"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 8.247em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.75em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.401em, 1006.75em, 2.856em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="munderover" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-186" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-187" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="mo" id="MathJax-Span-189" style="font-family: STIXGeneral; padding-left: 0.313em;">[</span><span class="mn" id="MathJax-Span-190" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-191" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-192" style="font-family: STIXGeneral; padding-left: 0.188em;">1</span><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 2.735em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.25em, 4.303em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral;">]</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.365em; left: 0.333em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-199" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">Q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.249em; border-left: 0px solid; width: 0px; height: 1.54em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><msup><mo stretchy="false">]</mo><mrow class="MJX-TeXAtom-ORD"><mi>H</mi><mi>x</mi><mi>W</mi><mi>x</mi><mi>Q</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-12">\mathbf {\widehat{Z}}\in [0,1]^{HxWxQ}</script></span>, where <em class="EmphasisTypeItalic ">Q</em> is the number of quantized <em class="EmphasisTypeItalic ">ab</em> values.</p><div id="Par13" class="Para">To compare predicted <span class="InlineEquation" id="IEq12"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" style="width: 1.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.064em, 1000.96em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="texatom" id="MathJax-Span-206"><span class="mrow" id="MathJax-Span-207"><span class="munderover" id="MathJax-Span-208"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-209" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-210" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.349em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-13">\mathbf {\widehat{Z}}</script></span> against ground truth, we define function <span class="InlineEquation" id="IEq13"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" style="width: 6.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.207em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.489em, 1005.16em, 3.067em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-212"><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-216" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-217" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.812em; height: 0px;"><span style="position: absolute; clip: rect(3.193em, 1000.85em, 4.168em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-218"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.379em, 1000.91em, 4.246em, -1000em); top: -4.446em; left: 0.899em;"><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mo" id="MathJax-Span-223" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-224" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.471em, 1000.64em, 4.292em, -1000em); top: -3.78em; left: 0.831em;"><span class="texatom" id="MathJax-Span-225"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">g</span><span class="mi" id="MathJax-Span-228" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-229" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.507em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mi>t</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14">\mathbf {Z} = \mathcal {H}_{gt}^{-1}(\mathbf {Y})</script></span>, which converts ground truth color <span class="InlineEquation" id="IEq14"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-234" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1000.7em, 2.7em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-235"><span class="texatom" id="MathJax-Span-236"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.942em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-15">\mathbf {Y}</script></span> to vector <span class="InlineEquation" id="IEq15"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-239" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.675em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1000.64em, 2.7em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-240"><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.942em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\mathbf {Z}</script></span>, using a soft-encoding scheme<sup><a href="#Fn1" id="Fn1_source">1</a></sup>. We then use multinomial cross entropy loss <span class="InlineEquation" id="IEq20"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mtext&gt;L&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 3.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.893em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1002.85em, 2.877em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.6em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mtext" id="MathJax-Span-247" style="font-family: STIXGeneral;">L</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.611em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-252" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-253" style="font-family: STIXGeneral;">⋅</span><span class="mo" id="MathJax-Span-254" style="font-family: STIXGeneral;">,</span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral; padding-left: 0.188em;">⋅</span><span class="mo" id="MathJax-Span-256" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>L</mtext><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>l</mi></mrow></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo>,</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">\text {L}_{cl}(\cdot ,\cdot )</script></span>, defined as:<div id="Equ2" class="Equation EquationMathjax"><div class="EquationContent"><span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="text-align: left; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mtext&gt;L&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-257" style="width: 23.725em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.431em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.62em, 1019.22em, 3.316em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-258"><span class="mtable" id="MathJax-Span-259" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 19.126em; height: 0px;"><span style="position: absolute; clip: rect(2.404em, 1019.08em, 5.1em, -1000em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.126em; height: 0px;"><span style="position: absolute; clip: rect(2.848em, 1019.08em, 5.544em, -1000em); top: -4.446em; right: 0em;"><span class="mtd" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.197em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.6em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mtext" id="MathJax-Span-263" style="font-family: STIXGeneral;">L</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.611em;"><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-267" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-268" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="munderover" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-274" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-275" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: STIXGeneral;">,</span><span class="texatom" id="MathJax-Span-277" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-280" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-281" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-282" style="font-family: STIXGeneral; padding-left: 0.313em;">−</span><span class="munderover" id="MathJax-Span-283" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1001.2em, 4.622em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-284" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.374em, 1000.99em, 4.346em, -1000em); top: -2.852em; left: 0.145em;"><span class="texatom" id="MathJax-Span-285"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-288" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-289" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mi" id="MathJax-Span-290" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-291" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-293"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral;">)</span><span class="munderover" id="MathJax-Span-302" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1001.2em, 4.622em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-303" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.545em, 1000.34em, 4.394em, -1000em); top: -2.852em; left: 0.469em;"><span class="texatom" id="MathJax-Span-304"><span class="mrow" id="MathJax-Span-305"><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-307" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.274em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-308"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-311"><span class="mrow" id="MathJax-Span-312"><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-314" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span class="mo" id="MathJax-Span-316" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mi" id="MathJax-Span-318" style="font-family: STIXGeneral; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-319"></span><span class="mo" id="MathJax-Span-320" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 2.586em; height: 0px;"><span style="position: absolute; clip: rect(2.848em, 1000.98em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="munderover" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-327" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-328" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.979em;"><span class="texatom" id="MathJax-Span-329"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-332" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span class="mo" id="MathJax-Span-334" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.222em; border-left: 0px solid; width: 0px; height: 3.055em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mtext>L</mtext><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>l</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></munder><mi>v</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub><mo stretchy="false">)</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>q</mi></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>q</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>q</mi></mrow></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">\begin{aligned} \text {L}_{cl}(\mathbf {\widehat{Z}},\mathbf {Z}) = - \sum _{h,w} v(\mathbf {Z}_{h,w}) \sum _{q} \mathbf {Z}_{h,w,q} \log (\mathbf {\widehat{Z}}_{h,w,q}) \end{aligned}</script></div> <div class="EquationNumber">(2)</div></div>where <span class="InlineEquation" id="IEq21"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 1.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.398em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1001.35em, 2.877em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: STIXGeneral; font-style: italic;">v</span><span class="mo" id="MathJax-Span-340" style="font-family: STIXGeneral;">(</span><span class="mo" id="MathJax-Span-341" style="font-family: STIXGeneral;">⋅</span><span class="mo" id="MathJax-Span-342" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">v(\cdot )</script></span> is a weighting term that can be used to rebalance the loss based on color-class rarity, as defined in Sect.&nbsp;<span class="InternalRef"><a href="#Sec4">2.2</a></span> below. Finally, we map probability distribution <span class="InlineEquation" id="IEq22"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 1.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.064em, 1000.96em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="texatom" id="MathJax-Span-345"><span class="mrow" id="MathJax-Span-346"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="munderover" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-350" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-351" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.349em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-20">\mathbf {\widehat{Z}}</script></span> to color values <span class="InlineEquation" id="IEq23"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" style="width: 1.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.064em, 1000.96em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="texatom" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="texatom" id="MathJax-Span-356"><span class="mrow" id="MathJax-Span-357"><span class="munderover" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="mi" id="MathJax-Span-359" style="font-family: STIXGeneral; font-weight: bold;">Y</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-360" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.349em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Y</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21">\mathbf {\widehat{Y}}</script></span> with function <span class="InlineEquation" id="IEq24"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-361" style="width: 5.837em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.773em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.932em, 1004.73em, 3.407em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="texatom" id="MathJax-Span-365"><span class="mrow" id="MathJax-Span-366"><span class="munderover" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral; font-weight: bold;">Y</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-369" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-370" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-371" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-374" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-375"><span class="mrow" id="MathJax-Span-376"><span class="texatom" id="MathJax-Span-377"><span class="mrow" id="MathJax-Span-378"><span class="munderover" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-380" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-381" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-382" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.565em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Y</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">\mathbf {\widehat{Y}} = \mathcal {H}(\mathbf {\widehat{Z}})</script></span>, which will be further discussed in Sect.&nbsp;<span class="InternalRef"><a href="#Sec5">2.3</a></span>.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO5"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig3_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig3_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 3.</span> <p class="SimplePara">(a) Quantized<em class="EmphasisTypeItalic ">ab</em> color space with a grid size of 10.&nbsp;A total of 313 <em class="EmphasisTypeItalic ">ab</em> pairs are in gamut. (b) Empirical probability distribution of <em class="EmphasisTypeItalic ">ab</em> values, shown in log scale. (c)&nbsp;Empirical probability distribution of <em class="EmphasisTypeItalic ">ab</em> values, conditioned on <em class="EmphasisTypeItalic ">L</em>, shown in log scale. (Color figure online)</p> </div></figcaption></figure></div></section><section id="Sec4" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">2.2 </span>Class Rebalancing</h3><div id="Par15" class="Para">The distribution of <em class="EmphasisTypeItalic ">ab</em> values in natural images is strongly biased towards values with low <em class="EmphasisTypeItalic ">ab</em> values, due to the appearance of backgrounds such as clouds, pavement, dirt, and walls. Figure&nbsp;<span class="InternalRef"><a href="#Fig3">3</a></span>(b) shows the empirical distribution of pixels in <em class="EmphasisTypeItalic ">ab</em> space, gathered from 1.3M training images in ImageNet [<span class="CitationRef"><a href="#CR28" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">28</a></span>].
 Observe that the number of pixels in natural images at desaturated 
values are orders of magnitude higher than for saturated values. Without
 accounting for this, the loss function is dominated by desaturated <em class="EmphasisTypeItalic ">ab</em>
 values. We account for the class-imbalance problem by reweighting the 
loss of each pixel at train time based on the pixel color rarity. This 
is asymptotically equivalent to the typical approach of resampling the 
training space [<span class="CitationRef"><a href="#CR32" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">32</a></span>]. Each pixel is weighed by factor <span class="InlineEquation" id="IEq25"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-383" style="width: 4.149em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.375em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.551em, 1003.38em, 2.727em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="texatom" id="MathJax-Span-385"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-388" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-389" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.333em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.71em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-390"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.391em; left: 0.747em;"><span class="texatom" id="MathJax-Span-393"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">Q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.092em; border-left: 0px solid; width: 0px; height: 1.2em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>∈</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-23">\mathbf {w} \in \mathbb {R}^{Q}</script></span>, based on its closest <em class="EmphasisTypeItalic ">ab</em> bin.<div id="Equ3" class="Equation EquationMathjax"><div class="EquationContent"><span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="text-align: left; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;where&amp;#xA0;&lt;/mtext&gt;&lt;msup&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;arg&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-396" style="width: 21.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.261em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.957em, 1017.09em, 2.979em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-397"><span class="mtable" id="MathJax-Span-398" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 16.916em; height: 0px;"><span style="position: absolute; clip: rect(2.795em, 1016.92em, 4.763em, -1000em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 16.916em; height: 0px;"><span style="position: absolute; clip: rect(3.111em, 1016.92em, 5.079em, -1000em); top: -4.318em; right: 0em;"><span class="mtd" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: STIXGeneral; font-style: italic;">v</span><span class="mo" id="MathJax-Span-402" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-404"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-410" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-411" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-412" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-413" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-414" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.465em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.71em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-415"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.722em;"><span class="texatom" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 0.668em; height: 0px;"><span style="position: absolute; clip: rect(3.545em, 1000.34em, 4.294em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.206em; left: 0.354em;"><span class="texatom" id="MathJax-Span-422"><span class="mrow" id="MathJax-Span-423"><span class="mo" id="MathJax-Span-424" style="font-size: 50%; font-family: STIXGeneral;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-425" style="font-family: STIXGeneral;">,</span><span class="mtext" id="MathJax-Span-426" style="font-family: STIXGeneral; padding-left: 0.188em;">&nbsp;where&nbsp;</span><span class="msubsup" id="MathJax-Span-427"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.356em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-428" style="font-family: STIXGeneral; font-style: italic;">q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.415em; left: 0.5em;"><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mo" id="MathJax-Span-431" style="font-size: 70.7%; font-family: STIXGeneral;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-432" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-433" style="font-family: STIXGeneral; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-434"></span><span class="munderover" id="MathJax-Span-435" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.722em; height: 0px;"><span style="position: absolute; clip: rect(3.397em, 1001.7em, 4.157em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-436" style="font-family: STIXGeneral;">max</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.545em, 1000.34em, 4.394em, -1000em); top: -3.317em; left: 0.684em;"><span class="texatom" id="MathJax-Span-437"><span class="mrow" id="MathJax-Span-438"><span class="mi" id="MathJax-Span-439" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-440" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.274em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-444"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span><span class="mo" id="MathJax-Span-449" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.811em; border-left: 0px solid; width: 0px; height: 2.232em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>v</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>∗</mo></mrow></msup></mrow></msub><mo>,</mo><mtext>&nbsp;where&nbsp;</mtext><msup><mi>q</mi><mrow class="MJX-TeXAtom-ORD"><mo>∗</mo></mrow></msup><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>q</mi></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>q</mi></mrow></msub></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">\begin{aligned} v(\mathbf {Z}_{h,w}) = \mathbf {w}_{q^{*}}, \text { where } q^{*} = \arg \max _{q} \mathbf {Z}_{h,w,q} \end{aligned}</script></div> <div class="EquationNumber">(3)</div></div><div id="Equ4" class="Equation EquationMathjax"><div class="EquationContent"><span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="text-align: left; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x221D;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-451" style="width: 24.882em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.395em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.436em, 1020.12em, 3.5em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-452"><span class="mtable" id="MathJax-Span-453" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 20.089em; height: 0px;"><span style="position: absolute; clip: rect(2.22em, 1019.98em, 5.284em, -1000em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 20.089em; height: 0px;"><span style="position: absolute; clip: rect(2.48em, 1019.98em, 5.544em, -1000em); top: -4.262em; right: 0em;"><span class="mtd" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="texatom" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-459" style="font-family: STIXGeneral; padding-left: 0.313em;">∝</span><span class="texatom" id="MathJax-Span-460" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-461"><span class="mo" id="MathJax-Span-462" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">(</span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-464" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-465" style="font-family: STIXGeneral; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-466" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.25em;">λ</span><span class="mo" id="MathJax-Span-467" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="munderover" id="MathJax-Span-472"><span style="display: inline-block; position: relative; width: 0.558em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.352em, -1000em); top: -4.002em; left: 0.001em;"><span class="mi" id="MathJax-Span-473" style="font-family: STIXGeneral; font-weight: bold;">p</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.107em, 1000.56em, 3.549em, -1000em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-474" style=""><span style="font-family: STIXSizeOneSym;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-475" style="font-family: STIXGeneral; padding-left: 0.25em;">+</span><span class="mfrac" id="MathJax-Span-476" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.842em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.179em, 1000.43em, 4.163em, -1000em); top: -4.678em; left: 50%; margin-left: -0.229em;"><span class="mi" id="MathJax-Span-477" style="font-family: STIXGeneral; font-style: italic;">λ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.191em, 1000.7em, 4.329em, -1000em); top: -3.316em; left: 50%; margin-left: -0.361em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.856em, 1000.84em, 1.205em, -1000em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.842em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-479" style=""><span style="display: inline-block; position: relative; width: 1.521em; height: 0px;"><span style="position: absolute; clip: rect(2.685em, 1000.48em, 4.819em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-480" style=""><span class="mrow" id="MathJax-Span-481"><span class="mo" id="MathJax-Span-482" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.901em; left: 0.608em;"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mo" id="MathJax-Span-485" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-486" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-487" style="font-family: STIXGeneral;">,</span><span class="mspace" id="MathJax-Span-488" style="height: 0em; vertical-align: 0em; width: 1.125em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-489" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-490"><span class="mi" id="MathJax-Span-491" style="font-family: STIXGeneral;">𝔼</span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: STIXGeneral;">[</span><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral;">]</span><span class="mo" id="MathJax-Span-497" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-498" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.292em; height: 0px;"><span style="position: absolute; clip: rect(2.882em, 1001.2em, 4.622em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-499" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.545em, 1000.34em, 4.394em, -1000em); top: -2.852em; left: 0.469em;"><span class="texatom" id="MathJax-Span-500"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-503" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.987em; height: 0px;"><span style="position: absolute; clip: rect(3.112em, 1000.56em, 4.352em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="munderover" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 0.558em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.352em, -1000em); top: -4.002em; left: 0.001em;"><span class="mi" id="MathJax-Span-509" style="font-family: STIXGeneral; font-weight: bold;">p</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.107em, 1000.56em, 3.549em, -1000em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-510" style=""><span style="font-family: STIXSizeOneSym;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.762em; left: 0.558em;"><span class="mi" id="MathJax-Span-511" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 1.151em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.71em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-family: STIXGeneral; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.722em;"><span class="mi" id="MathJax-Span-516" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-517" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-518" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.447em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>∝</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">(</mo></mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">p</mi><mo mathvariant="bold">~</mo></mover></mrow></mrow><mo>+</mo><mfrac><mi>λ</mi><mi>Q</mi></mfrac><msup><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.623em" minsize="1.623em">)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1em"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mo stretchy="false">[</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo stretchy="false">]</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>q</mi></mrow></munder><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">p</mi><mo mathvariant="bold">~</mo></mover></mrow></mrow><mi>q</mi></msub><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi>q</mi></msub><mo>=</mo><mn>1</mn></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">\begin{aligned} \mathbf {w} \propto \Big ( (1-\lambda ) \mathbf {\widetilde{p}} + \frac{\lambda }{Q} \Big )^{-1}, \quad \mathbb {E} [\mathbf {w}] = \sum _{q} \mathbf {\widetilde{p}}_q \mathbf {w}_q = 1 \end{aligned}</script></div> <div class="EquationNumber">(4)</div></div>To obtain smoothed empirical distribution <span class="InlineEquation" id="IEq26"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x007E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-519" style="width: 3.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.577em, 1003.18em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="texatom" id="MathJax-Span-521"><span class="mrow" id="MathJax-Span-522"><span class="texatom" id="MathJax-Span-523"><span class="mrow" id="MathJax-Span-524"><span class="munderover" id="MathJax-Span-525"><span style="display: inline-block; position: relative; width: 0.558em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.52em, 4.352em, -1000em); top: -4.002em; left: 0.001em;"><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral; font-weight: bold;">p</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.107em, 1000.56em, 3.549em, -1000em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-527" style=""><span style="font-family: STIXSizeOneSym;">˜</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-529" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.68em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.365em; left: 0.722em;"><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">p</mi><mo mathvariant="bold">~</mo></mover></mrow></mrow><mo>∈</mo><msup><mi mathvariant="normal">Δ</mi><mi>Q</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-26">\mathbf {\widetilde{p}} \in \Delta ^Q</script></span>, we estimate the empirical probability of colors in the quantized <em class="EmphasisTypeItalic ">ab</em> space <span class="InlineEquation" id="IEq27"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0394;&lt;/mi&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-532" style="width: 3.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.182em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.577em, 1003.18em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-533"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-family: STIXGeneral; font-weight: bold;">p</span></span></span><span class="mo" id="MathJax-Span-537" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-538" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.308em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.68em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-539" style="font-family: STIXGeneral;">Δ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.365em; left: 0.722em;"><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">p</mi></mrow><mo>∈</mo><msup><mi mathvariant="normal">Δ</mi><mi>Q</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">\mathbf {p} \in \Delta ^Q</script></span> from the full ImageNet training set and smooth the distribution with a Gaussian kernel <span class="InlineEquation" id="IEq28"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-541" style="width: 1.497em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.205em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.382em, 1001.21em, 2.52em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-542"><span class="msubsup" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.76em, 4.166em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-544"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: STIXGeneral; font-weight: bold;">G</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.778em;"><span class="mi" id="MathJax-Span-547" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.251em; border-left: 0px solid; width: 0px; height: 1.153em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mi>σ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">\mathbf {G}_\sigma </script></span>. We then mix the distribution with a uniform distribution with weight <span class="InlineEquation" id="IEq29"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" style="width: 4.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.857em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.733em, 1003.77em, 2.856em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral; font-style: italic;">λ</span><span class="mo" id="MathJax-Span-551" style="font-family: STIXGeneral; padding-left: 0.313em;">∈</span><span class="mo" id="MathJax-Span-552" style="font-family: STIXGeneral; padding-left: 0.313em;">[</span><span class="mn" id="MathJax-Span-553" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-554" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-555" style="font-family: STIXGeneral; padding-left: 0.188em;">1</span><span class="mo" id="MathJax-Span-556" style="font-family: STIXGeneral;">]</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.249em; border-left: 0px solid; width: 0px; height: 1.135em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">\lambda \in [0,1]</script></span>, take the reciprocal, and normalize so the weighting factor is 1 on expectation. We found that values of <span class="InlineEquation" id="IEq30"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-557" style="width: 3.088em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.507em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.532em, 1002.51em, 3.079em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: STIXGeneral; font-style: italic;">λ</span><span class="mo" id="MathJax-Span-560" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mstyle" id="MathJax-Span-561" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-562"><span class="mfrac" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.474em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.379em, 1000.28em, 4.147em, -1000em); top: -4.402em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-564" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.379em, 1000.34em, 4.147em, -1000em); top: -3.624em; left: 50%; margin-left: -0.177em;"><span class="mn" id="MathJax-Span-565" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.856em, 1000.47em, 1.205em, -1000em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.474em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.52em; border-left: 0px solid; width: 0px; height: 1.651em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mstyle displaystyle="false" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-30">\lambda =\tfrac{1}{2}</script></span> and <span class="InlineEquation" id="IEq31"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-566" style="width: 2.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.314em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.723em, 1002.25em, 2.714em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-567"><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-569" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-570" style="font-family: STIXGeneral; padding-left: 0.313em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.974em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-31">\sigma =5</script></span> worked well. We compare results with and without class rebalancing in Sect.&nbsp;<span class="InternalRef"><a href="#Sec7">3.1</a></span>.</div></section><section id="Sec5" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">2.3 </span>Class Probabilities to Point Estimates</h3><div id="Par16" class="Para">Finally, we define <span class="InlineEquation" id="IEq32"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-571" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.277em, 1000.82em, 3.251em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-572"><span class="texatom" id="MathJax-Span-573"><span class="mrow" id="MathJax-Span-574"><span class="mi" id="MathJax-Span-575" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.084em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-32">\mathcal {H}</script></span>, which maps the predicted distribution <span class="InlineEquation" id="IEq33"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-576" style="width: 1.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.064em, 1000.96em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-577"><span class="texatom" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="texatom" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="munderover" id="MathJax-Span-582"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0.156em;"><span class="mi" id="MathJax-Span-583" style="font-family: STIXGeneral; font-weight: bold;">Z</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-584" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.349em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Z</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\mathbf {\widehat{Z}}</script></span> to point estimate <span class="InlineEquation" id="IEq34"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-585" style="width: 1.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.064em, 1000.96em, 2.363em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-586"><span class="texatom" id="MathJax-Span-587"><span class="mrow" id="MathJax-Span-588"><span class="texatom" id="MathJax-Span-589"><span class="mrow" id="MathJax-Span-590"><span class="munderover" id="MathJax-Span-591"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0.129em;"><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral; font-weight: bold;">Y</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.08em, 1000.98em, 3.583em, -1000em); top: -4.234em; left: 0em;"><span class="mo" id="MathJax-Span-593" style=""><span style="font-family: STIXSizeTwoSym;">ˆ</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.349em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">Y</mi><mo mathvariant="bold">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-34">\mathbf {\widehat{Y}}</script></span> in <em class="EmphasisTypeItalic ">ab</em>
 space. One choice is to take the mode of the predicted distribution for
 each pixel, as shown in the right-most column of Fig.&nbsp;<span class="InternalRef"><a href="#Fig4">4</a></span>
 for two example images. This provides a vibrant but sometimes spatially
 inconsistent result, e.g., the red splotches on the bus. On the other 
hand, taking the mean of the predicted distribution produces spatially 
consistent but desaturated results (left-most column of Fig.&nbsp;<span class="InternalRef"><a href="#Fig4">4</a></span>),
 exhibiting an unnatural sepia tone. This is unsurprising, as taking the
 mean after performing classification suffers from some of the same 
issues as optimizing for a Euclidean loss in a regression framework. To 
try to get the best of both worlds, we <em class="EmphasisTypeItalic ">interpolate</em> by re-adjusting the temperature <em class="EmphasisTypeItalic ">T</em> of the softmax distribution, and taking the mean of the result. We draw inspiration from the simulated annealing technique [<span class="CitationRef"><a href="#CR33" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">33</a></span>], and thus refer to the operation as taking the <em class="EmphasisTypeItalic ">annealed-mean</em> of the distribution:<div id="Equ5" class="Equation EquationMathjax"><div class="EquationContent"><span class="MathJax_Preview" style="display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="text-align: left; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;[&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-594" style="width: 25.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.974em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.56em, 1020.81em, 3.376em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-595"><span class="mtable" id="MathJax-Span-596" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 20.629em; height: 0px;"><span style="position: absolute; clip: rect(2.344em, 1020.63em, 5.16em, -1000em); top: -4.002em; left: 0em;"><span style="display: inline-block; position: relative; width: 20.629em; height: 0px;"><span style="position: absolute; clip: rect(2.496em, 1020.63em, 5.312em, -1000em); top: -4.154em; right: 0em;"><span class="mtd" id="MathJax-Span-597"><span class="mrow" id="MathJax-Span-598"><span class="texatom" id="MathJax-Span-599"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-602" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-604"><span class="mrow" id="MathJax-Span-605"><span class="mi" id="MathJax-Span-606" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mi" id="MathJax-Span-609" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-610" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-612" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-613" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-614" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: STIXGeneral;">𝔼</span></span></span><span class="texatom" id="MathJax-Span-617" style=""><span class="mrow" id="MathJax-Span-618"><span class="mo" id="MathJax-Span-619" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">[</span></span></span></span></span><span class="msubsup" id="MathJax-Span-620"><span style="display: inline-block; position: relative; width: 0.801em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.42em, 4.354em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-621" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.278em;"><span class="texatom" id="MathJax-Span-622"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-625" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-626"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-627"><span class="mrow" id="MathJax-Span-628"><span class="mi" id="MathJax-Span-629" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="mi" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-633" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-635" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-636" style=""><span class="mrow" id="MathJax-Span-637"><span class="mo" id="MathJax-Span-638" style="vertical-align: -0.246em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">]</span></span></span></span></span><span class="mo" id="MathJax-Span-639" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-640" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.801em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.42em, 4.354em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral; font-style: italic; text-rendering: optimizelegibility;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.278em;"><span class="texatom" id="MathJax-Span-642"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-645" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-646"><span class="mrow" id="MathJax-Span-647"><span class="mi" id="MathJax-Span-648" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-649" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-650" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mstyle" id="MathJax-Span-651" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-652"><span class="mfrac" id="MathJax-Span-653"><span style="display: inline-block; position: relative; width: 7.488em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.174em, 1005.36em, 4.365em, -1000em); top: -4.68em; left: 50%; margin-left: -2.704em;"><span class="mrow" id="MathJax-Span-654"><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral;">exp</span><span class="mo" id="MathJax-Span-656"></span><span class="mo" id="MathJax-Span-657" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-658" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-659"></span><span class="mo" id="MathJax-Span-660" style="font-family: STIXGeneral;">(</span><span class="texatom" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-664" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-665"><span class="mrow" id="MathJax-Span-666"><span class="mo" id="MathJax-Span-667" style="font-family: STIXGeneral;">/</span></span></span><span class="mi" id="MathJax-Span-668" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-669" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1007.32em, 4.591em, -1000em); top: -3.28em; left: 50%; margin-left: -3.684em;"><span class="mrow" id="MathJax-Span-670"><span class="munderover" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 1.343em; height: 0px;"><span style="position: absolute; clip: rect(3.096em, 1000.86em, 4.408em, -1000em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-672" style="font-family: STIXGeneral; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.706em; left: 0.914em;"><span class="texatom" id="MathJax-Span-673"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mi" id="MathJax-Span-676" style="font-family: STIXGeneral; padding-left: 0.188em;">exp</span><span class="mo" id="MathJax-Span-677"></span><span class="mo" id="MathJax-Span-678" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral;">log</span><span class="mo" id="MathJax-Span-680"></span><span class="mo" id="MathJax-Span-681" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-682"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-683"><span class="mrow" id="MathJax-Span-684"><span class="mi" id="MathJax-Span-685" style="font-family: STIXGeneral; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.444em;"><span class="mi" id="MathJax-Span-686" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">q</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="mo" id="MathJax-Span-690" style="font-family: STIXGeneral;">/</span></span></span><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.856em, 1007.49em, 1.205em, -1000em); top: -1.281em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.295em; border-left: 0px solid; width: 0px; height: 3.201em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">[</mo></mrow><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo maxsize="1.2em" minsize="1.2em">]</mo></mrow><mo>,</mo><msub><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>T</mi><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>q</mi></mrow></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mi>q</mi></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>T</mi><mo stretchy="false">)</mo></mrow></mfrac></mstyle></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">\begin{aligned} \mathcal {H}(\mathbf {Z}_{h,w}) = \mathbb {E}\big [ f_{T}(\mathbf {Z}_{h,w}) \big ], f_{T}(\mathbf {z}) = \dfrac{\exp (\log (\mathbf {z})/T)}{\sum _{q} \exp (\log (\mathbf {z}_q)/T)} \end{aligned}</script></div> <div class="EquationNumber">(5)</div></div>Setting <span class="InlineEquation" id="IEq35"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-693" style="width: 3.04em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.459em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1002.35em, 2.7em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-696" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-697" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.942em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-36">T=1</script></span> leaves the distribution unchanged, lowering the temperature <em class="EmphasisTypeItalic ">T</em> produces a more strongly peaked distribution, and setting <span class="InlineEquation" id="IEq36"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-698" style="width: 3.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.7em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1002.68em, 2.714em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-699"><span class="mi" id="MathJax-Span-700" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-701" style="font-family: STIXGeneral; padding-left: 0.313em;">→</span><span class="mn" id="MathJax-Span-702" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.959em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">→</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-37">T\rightarrow 0</script></span> results in a 1-hot encoding at the distribution mode. We found that temperature <span class="InlineEquation" id="IEq37"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.38&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-703" style="width: 4.486em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.664em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1003.61em, 2.714em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-706" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-707" style="font-family: STIXGeneral; padding-left: 0.313em;">0.38</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.959em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mn>0.38</mn></math></span></span><script type="math/tex" id="MathJax-Element-38">T=0.38</script></span>, shown in the middle column of Fig.&nbsp;<span class="InternalRef"><a href="#Fig4">4</a></span>, captures the vibrancy of the mode while maintaining the spatial coherence of the mean.<figure class="Figure" id="Fig4"><div class="MediaObject" id="MO9"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig4_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig4_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 4.</span> <p class="SimplePara">The effect of temperature parameter <em class="EmphasisTypeItalic ">T</em> on the <em class="EmphasisTypeItalic ">annealed-mean</em> output (Eq.&nbsp;<span class="InternalRef"><a href="#Equ5">5</a></span>). The left-most images show the means of the predicted color distributions and the right-most show the modes. We use <span class="InlineEquation" id="IEq38"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.38&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-708" style="width: 4.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.654em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.728em, 1003.6em, 2.706em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-709"><span class="mi" id="MathJax-Span-710" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-711" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-712" style="font-family: STIXGeneral; padding-left: 0.313em;">0.38</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.081em; border-left: 0px solid; width: 0px; height: 1.022em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mn>0.38</mn></math></span></span><script type="math/tex" id="MathJax-Element-39">T=0.38</script></span> in our system. (Color figure online)</p> </div></figcaption></figure></div><p id="Par17" class="Para">Our final system <span class="InlineEquation" id="IEq39"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-713" style="width: 0.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.723em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.279em, 1000.72em, 3.23em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-714"><span class="texatom" id="MathJax-Span-715"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.058em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.925em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-40">\mathcal {F}</script></span> is the composition of CNN <span class="InlineEquation" id="IEq40"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-718" style="width: 0.726em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.27em, 1000.58em, 3.361em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-719"><span class="texatom" id="MathJax-Span-720"><span class="mrow" id="MathJax-Span-721"><span class="mi" id="MathJax-Span-722" style="font-family: STIXNonUnicode; font-style: italic;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.096em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">G</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-41">\mathcal {G}</script></span>, which produces a predicted distribution over all pixels, and the annealed-mean operation <span class="InlineEquation" id="IEq41"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-723" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.277em, 1000.82em, 3.251em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-724"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mi" id="MathJax-Span-727" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.084em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-42">\mathcal {H}</script></span>, which produces a final prediction. The system is not quite end-to-end trainable, but note that the mapping <span class="InlineEquation" id="IEq42"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-728" style="width: 1.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.277em, 1000.82em, 3.251em, -1000em); top: -3.086em; left: 0em;"><span class="mrow" id="MathJax-Span-729"><span class="texatom" id="MathJax-Span-730"><span class="mrow" id="MathJax-Span-731"><span class="mi" id="MathJax-Span-732" style="font-family: STIXNonUnicode; font-style: italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.086em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.084em; border-left: 0px solid; width: 0px; height: 0.953em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">H</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-43">\mathcal {H}</script></span>
 operates on each pixel independently, with a single parameter, and can 
be implemented as part of a feed-forward pass of the CNN.</p></section></div></section><section id="Sec6" tabindex="-1" class="Section1 RenderAsSection1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1"><span class="HeadingNumber">3 </span>Experiments<span class="section-icon"></span></h2><div class="content"><p id="Par18" class="Para">In Sect.&nbsp;<span class="InternalRef"><a href="#Sec7">3.1</a></span>,
 we assess the graphics aspect of our algorithm, evaluating the 
perceptual realism of our colorizations, along with other measures of 
accuracy. We compare our full algorithm to several variants, along with 
recent&nbsp;[<span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>] and concurrent work&nbsp;[<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]. In Sect.&nbsp;<span class="InternalRef"><a href="#Sec8">3.2</a></span>, we test colorization as a method for self-supervised representation learning. Finally, in Sect.&nbsp;<span class="InternalRef"><a href="#Sec9">3.3</a></span>, we show qualitative examples on legacy black and white images.</p><section id="Sec7" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">3.1 </span>Evaluating Colorization Quality</h3><div id="Par19" class="Para">We train our network on the 1.3&nbsp;M images from the ImageNet training set&nbsp;[<span class="CitationRef"><a href="#CR28" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">28</a></span>],
 validate on the first 10&nbsp;k images in the ImageNet validation set, 
and test on a separate 10&nbsp;k images in the validation set, same as 
in&nbsp;[<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]. We show quantitative results in Table&nbsp;<span class="InternalRef"><a href="#Tab1">1</a></span> on three metrics. A qualitative comparison for selected success and failure cases is shown in Fig.&nbsp;<span class="InternalRef"><a href="#Fig5">5</a></span>. For a comparison on a full selection of random images, please see our project webpage.<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO10"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig5_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig5_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 5.</span> <p class="SimplePara">Example
 results from our ImageNet test set. Our classification loss with 
rebalancing produces more accurate and vibrant results than a regression
 loss or a classification loss without rebalancing. Successful 
colorizations are above the dotted line. Common failures are below. 
These include failure to capture long-range consistency, frequent 
confusions between red and blue, and a default sepia tone on complex 
indoor scenes. Please visit <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://richzhang.github.io/colorization/"><span class="RefSource">http://richzhang.github.io/colorization/</span></a></span> to see the full range of results. (Color figure online)</p> </div></figcaption></figure></div><div id="Par20" class="Para">To
 specifically test the effect of different loss functions, we train our 
CNN with various losses. We also compare to previous&nbsp;[<span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>] and concurrent methods&nbsp;[<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>], which both use CNNs trained on ImageNet, along with naive baselines:<div class="OrderedList"><ol><li class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"> <p id="Par21" class="Para"> <strong class="EmphasisTypeBold ">O</strong>urs (full) Our full method, with classification loss, defined in Eq.&nbsp;<span class="InternalRef"><a href="#Equ2">2</a></span>, and class rebalancing, as described in Sect.&nbsp;<span class="InternalRef"><a href="#Sec4">2.2</a></span>. The network was trained from scratch with k-means initialization&nbsp;[<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>], using the ADAM solver for approximately 450&nbsp;k iterations<sup><a href="#Fn2" id="Fn2_source">2</a></sup>.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"> <p id="Par23" class="Para"> <strong class="EmphasisTypeBold ">O</strong>urs (class) Our network on classification loss but no class rebalancing (<span class="InlineEquation" id="IEq49"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-733" style="width: 2.799em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.733em, 1002.16em, 2.716em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-734"><span class="mi" id="MathJax-Span-735" style="font-family: STIXGeneral; font-style: italic;">λ</span><span class="mo" id="MathJax-Span-736" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-737" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.078em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-44">\lambda =1</script></span> in Eq.&nbsp;<span class="InternalRef"><a href="#Equ4">4</a></span>).</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">3.</span><div class="ItemContent"> <p id="Par24" class="Para"> <strong class="EmphasisTypeBold ">O</strong>urs (L2) Our network trained from scratch, with L2 regression loss, described in Eq.&nbsp;<span class="InternalRef"><a href="#Equ1">1</a></span>, following the same training protocol.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">4.</span><div class="ItemContent"> <p id="Par25" class="Para"> <strong class="EmphasisTypeBold ">O</strong>urs (L2, ft) Our network trained with L2 regression loss, fine-tuned from our full classification with rebalancing network.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">5.</span><div class="ItemContent"> <p id="Par26" class="Para"> <strong class="EmphasisTypeBold ">L</strong>arsson et al.&nbsp;[<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>] A CNN method that also appears in these proceedings.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">6.</span><div class="ItemContent"> <p id="Par27" class="Para"> <strong class="EmphasisTypeBold ">D</strong>ahl[<span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>] A previous model using a Laplacian pyramid on VGG features, trained with L2 regression loss.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">7.</span><div class="ItemContent"> <p id="Par28" class="Para"> <strong class="EmphasisTypeBold ">G</strong>ray Colors every pixel gray, with <span class="InlineEquation" id="IEq50"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-738" style="width: 4.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.857em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.728em, 1003.83em, 2.877em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-739"><span class="mo" id="MathJax-Span-740" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-741" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mo" id="MathJax-Span-742" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-743" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.188em;">b</span><span class="mo" id="MathJax-Span-744" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-745" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-746" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.167em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-45">(a,b)=0</script></span>.</p> </div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">8.</span><div class="ItemContent"> <p id="Par29" class="Para"> <strong class="EmphasisTypeBold ">R</strong>andom Copies the colors from a random image from the training set.</p> </div><div class="ClearBoth">&nbsp;</div></li></ol></div><div id="Tab1" class="Table"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 1.</span> <p class="SimplePara">Colorization results on 10k images in the ImageNet validation set [<span class="CitationRef"><a href="#CR28" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">28</a></span>], as used in [<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]. AuC refers to the area under the curve of the cumulative error distribution over <em class="EmphasisTypeItalic ">ab</em> space&nbsp;[<span class="CitationRef"><a href="#CR22" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">22</a></span>].
 Results column 2 shows the class-balanced variant of this metric. 
Column 3 is the classification accuracy after colorization using the 
VGG-16 [<span class="CitationRef"><a href="#CR5" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">5</a></span>] network. Column 4 shows results from our AMT <em class="EmphasisTypeItalic ">real vs. fake</em> test (with mean and standard error reported, estimated by bootstrap&nbsp;[<span class="CitationRef"><a href="#CR34" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">34</a></span>]).
 Note that an algorithm that produces ground truth images would achieve 
50&nbsp;% performance in expectation. Higher is better for all metrics. 
Rows refer to different algorithms; see text for a description of each. 
Parameter and feature memory, and runtime, were measured on a Titan X 
GPU using <em class="EmphasisTypeItalic ">Caffe</em> [<span class="CitationRef"><a href="#CR35" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">35</a></span>].</p> </div></div><div class="u-scroll-horizontal"><table><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"><col class="tcol4 align-left"><col class="tcol5 align-left"><col class="tcol6 align-left"><col class="tcol7 align-left"><col class="tcol8 align-left"></colgroup><thead><tr><th colspan="8"> <p class="SimplePara">Colorization results on ImageNet</p> </th></tr><tr><th rowspan="2"> <p class="SimplePara">Method</p> </th><th colspan="3"> <p class="SimplePara">Model</p> </th><th colspan="2"> <p class="SimplePara">AuC</p> </th><th rowspan="2"> <p class="SimplePara">VGG Top-1 Class Acc (%)</p> </th><th rowspan="2"> <p class="SimplePara">AMT labeled real (%)</p> </th></tr><tr><th> <p class="SimplePara">Params (MB)</p> </th><th> <p class="SimplePara">Feats (MB)</p> </th><th> <p class="SimplePara">Runtime (ms)</p> </th><th> <p class="SimplePara">non-rebal (%)</p> </th><th> <p class="SimplePara">rebal (%)</p> </th></tr></thead><tbody><tr><td> <p class="SimplePara">Ground truth</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">100</p> </td><td> <p class="SimplePara">100</p> </td><td> <p class="SimplePara">68.3</p> </td><td> <p class="SimplePara">50</p> </td></tr><tr><td> <p class="SimplePara">Gray</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">89.1</p> </td><td> <p class="SimplePara">58.0</p> </td><td> <p class="SimplePara">52.7</p> </td><td> <p class="SimplePara">–</p> </td></tr><tr><td> <p class="SimplePara">Random</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">84.2</p> </td><td> <p class="SimplePara">57.3</p> </td><td> <p class="SimplePara">41.0</p> </td><td> <p class="SimplePara">13.0±4.4</p> </td></tr><tr><td> <p class="SimplePara">Dahl [<span class="CitationRef"><a href="#CR2" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">2</a></span>]</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">90.4</p> </td><td> <p class="SimplePara">58.9</p> </td><td> <p class="SimplePara">48.7</p> </td><td> <p class="SimplePara">18.3±2.8</p> </td></tr><tr><td> <p class="SimplePara">Larsson et al. [<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]</p> </td><td> <p class="SimplePara">588</p> </td><td> <p class="SimplePara">495</p> </td><td> <p class="SimplePara">122.1</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">91.7</strong> </p> </td><td> <p class="SimplePara">65.9</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">59.4</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">27.2</strong>±<strong class="EmphasisTypeBold ">2.7</strong> </p> </td></tr><tr><td> <p class="SimplePara">Ours (L2)</p> </td><td> <p class="SimplePara">129</p> </td><td> <p class="SimplePara">127</p> </td><td> <p class="SimplePara">17.8</p> </td><td> <p class="SimplePara">91.2</p> </td><td> <p class="SimplePara">64.4</p> </td><td> <p class="SimplePara">54.9</p> </td><td> <p class="SimplePara">21.2±2.5</p> </td></tr><tr><td> <p class="SimplePara">Ours (L2, ft)</p> </td><td> <p class="SimplePara">129</p> </td><td> <p class="SimplePara">127</p> </td><td> <p class="SimplePara">17.8</p> </td><td> <p class="SimplePara">91.5</p> </td><td> <p class="SimplePara">66.2</p> </td><td> <p class="SimplePara">56.5</p> </td><td> <p class="SimplePara">23.9±2.8</p> </td></tr><tr><td> <p class="SimplePara">Ours (class)</p> </td><td> <p class="SimplePara">129</p> </td><td> <p class="SimplePara">142</p> </td><td> <p class="SimplePara">22.1</p> </td><td> <p class="SimplePara">91.6</p> </td><td> <p class="SimplePara">65.1</p> </td><td> <p class="SimplePara">56.6</p> </td><td> <p class="SimplePara">25.2±2.7</p> </td></tr><tr><td> <p class="SimplePara">Ours (full)</p> </td><td> <p class="SimplePara">129</p> </td><td> <p class="SimplePara">142</p> </td><td> <p class="SimplePara">22.1</p> </td><td> <p class="SimplePara">89.5</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">67.3</strong> </p> </td><td> <p class="SimplePara">56.0</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">32.3</strong>±<strong class="EmphasisTypeBold ">2.2</strong> </p> </td></tr></tbody></table></div></div></div><p id="Par30" class="Para">Evaluating
 the quality of synthesized images is well-known to be a difficult task,
 as simple quantitative metrics, like RMS error on pixel values, often 
fail to capture visual realism. To address the shortcomings of any 
individual evaluation, we test three that measure different senses of 
quality, shown in Table&nbsp;<span class="InternalRef"><a href="#Tab1">1</a></span>.</p><div id="Par31" class="Para"> <strong class="EmphasisTypeBold ">1. Perceptual Realism (AMT):</strong>
 For many applications, such as those in graphics, the ultimate test of 
colorization is how compelling the colors look to a human observer. To 
test this, we ran a <em class="EmphasisTypeItalic ">real vs. fake</em> 
two-alternative forced choice experiment on Amazon Mechanical Turk 
(AMT). Participants in the experiment were shown a series of pairs of 
images. Each pair consisted of a color photo next to a re-colorized 
version, produced by either our algorithm or a baseline. Participants 
were asked to click on the photo they believed contained <em class="EmphasisTypeItalic ">fake</em> colors generated by a computer program. Individual images of resolution <span class="InlineEquation" id="IEq51"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-747" style="width: 4.92em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.002em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.723em, 1003.97em, 2.725em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-748"><span class="mn" id="MathJax-Span-749" style="font-family: STIXGeneral;">256</span><span class="mo" id="MathJax-Span-750" style="font-family: STIXGeneral; padding-left: 0.25em;">×</span><span class="mn" id="MathJax-Span-751" style="font-family: STIXGeneral; padding-left: 0.25em;">256</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.988em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>256</mn><mo>×</mo><mn>256</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">256\times 256</script></span>
 were shown for one second each, and after each pair, participants were 
given unlimited time to respond. Each experimental session consisted of 
10 practice trials (excluded from subsequent analysis), followed by 40 
test pairs. On the practice trials, participants were given feedback as 
to whether or not their answer was correct. No feedback was given during
 the 40 test pairs. Each session tested only a single algorithm at a 
time, and participants were only allowed to complete at most one 
session. A total of 40 participants evaluated each algorithm. To ensure 
that all algorithms were tested in equivalent conditions (i.e. time of 
day, demographics, etc.), all experiment sessions were posted 
simultaneously and distributed to Turkers in an i.i.d. fashion.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO11"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig6_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig6_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 6.</span> <p class="SimplePara">Images
 sorted by how often AMT participants chose our algorithm’s colorization
 over the ground truth. In all pairs to the left of the dotted line, 
participants believed our colorizations to be more real than the ground 
truth on <span class="InlineEquation" id="IEq52"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-752" style="width: 3.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.885em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.698em, 1002.82em, 2.795em, -1000em); top: -2.548em; left: 0em;"><span class="mrow" id="MathJax-Span-753"><span class="mo" id="MathJax-Span-754" style="font-family: STIXGeneral;">≥</span><span class="mn" id="MathJax-Span-755" style="font-family: STIXGeneral; padding-left: 0.313em;">50</span><span class="mspace" id="MathJax-Span-756" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-757" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.548em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.196em; border-left: 0px solid; width: 0px; height: 1.177em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>50</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">\ge 50\,\%</script></span>
 of the trials. In some cases, this may be due to poor white balancing 
in the ground truth image, corrected by our algorithm, which predicts a 
more prototypical appearance. Right of the dotted line are examples 
where participants were never fooled.</p> </div></figcaption></figure></div><p id="Par32" class="Para">To check that participants were competent at this task, <span class="InlineEquation" id="IEq53"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-758" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="mn" id="MathJax-Span-760" style="font-family: STIXGeneral;">10</span><span class="mspace" id="MathJax-Span-761" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-762" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">10\,\%</script></span>
 of the trials pitted the ground truth image against the Random baseline
 described above. Participants successfully identified these random 
colorizations as fake <span class="InlineEquation" id="IEq54"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;87&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-763" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-764"><span class="mn" id="MathJax-Span-765" style="font-family: STIXGeneral;">87</span><span class="mspace" id="MathJax-Span-766" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-767" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>87</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">87\,\%</script></span> of the time, indicating that they understood the task and were paying attention.</p><p id="Par33" class="Para">Figure&nbsp;<span class="InternalRef"><a href="#Fig6">6</a></span>
 gives a better sense of the participants’ competency at detecting 
subtle errors made by our algorithm. The far right column shows example 
pairs where participants identified the fake image successfully in <span class="InlineEquation" id="IEq55"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-768" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.363em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1002.3em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="mn" id="MathJax-Span-770" style="font-family: STIXGeneral;">100</span><span class="mspace" id="MathJax-Span-771" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-772" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>100</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">100\,\%</script></span>
 of the trials. Each of these pairs was scored by at least 10 
participants. Close inspection reveals that on these images, our 
colorizations tend to have giveaway artifacts, such as the yellow 
blotches on the two trucks, which ruin otherwise decent results.</p><p id="Par34" class="Para">Nonetheless, our full algorithm fooled participants on <span class="InlineEquation" id="IEq56"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-773" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-774"><span class="mn" id="MathJax-Span-775" style="font-family: STIXGeneral;">32</span><span class="mspace" id="MathJax-Span-776" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-777" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>32</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">32\,\%</script></span> of trials, as shown in Table&nbsp;<span class="InternalRef"><a href="#Tab1">1</a></span>. This number is significantly higher than all compared algorithms (<span class="InlineEquation" id="IEq57"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0.05&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-778" style="width: 4.245em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.472em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.723em, 1003.41em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-779"><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-781" style="font-family: STIXGeneral; padding-left: 0.313em;">&lt;</span><span class="mn" id="MathJax-Span-782" style="font-family: STIXGeneral; padding-left: 0.313em;">0.05</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.207em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>&lt;</mo><mn>0.05</mn></math></span></span><script type="math/tex" id="MathJax-Element-52">p < 0.05</script></span> in each case) except for Larsson et al., against which the difference was not significant (<span class="InlineEquation" id="IEq58"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.10&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-783" style="width: 4.245em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.472em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.735em, 1003.45em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-784"><span class="mi" id="MathJax-Span-785" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mo" id="MathJax-Span-786" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-787" style="font-family: STIXGeneral; padding-left: 0.313em;">0.10</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.192em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mn>0.10</mn></math></span></span><script type="math/tex" id="MathJax-Element-53">p = 0.10</script></span>; all statistics estimated by bootstrap [<span class="CitationRef"><a href="#CR34" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">34</a></span>]). These results validate the effectiveness of using both a classification loss and class-rebalancing.</p><p id="Par35" class="Para">Note
 that if our algorithm exactly reproduced the ground truth colors, the 
forced choice would be between two identical images, and participants 
would be fooled <span class="InlineEquation" id="IEq59"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-788" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-789"><span class="mn" id="MathJax-Span-790" style="font-family: STIXGeneral;">50</span><span class="mspace" id="MathJax-Span-791" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-792" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>50</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">50\,\%</script></span> of the time on expectation. Interestingly, we can identify cases where participants were fooled <em class="EmphasisTypeItalic ">more</em> often than <span class="InlineEquation" id="IEq60"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-793" style="width: 2.317em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.88em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.705em, 1001.82em, 2.719em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-794"><span class="mn" id="MathJax-Span-795" style="font-family: STIXGeneral;">50</span><span class="mspace" id="MathJax-Span-796" style="height: 0em; vertical-align: 0em; width: 0.188em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-797" style="font-family: STIXGeneral;">%</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.002em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>50</mn><mspace width="thinmathspace"></mspace><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">50\,\%</script></span>
 of the time, indicating our results were deemed more realistic than the
 ground truth. Some examples are shown in the first three columns of 
Fig.&nbsp;<span class="InternalRef"><a href="#Fig6">6</a></span>. In 
many case, the ground truth image is poorly white balanced or has 
unusual colors, whereas our system produces a more prototypical 
appearance.</p><p id="Par36" class="Para"> <strong class="EmphasisTypeBold ">2. Semantic Interpretability (VGG Classification):</strong>
 Does our method produce realistic enough colorizations to be 
interpretable to an off-the-shelf object classifier? We tested this by 
feeding our <em class="EmphasisTypeItalic ">fake</em> colorized images to a VGG network [<span class="CitationRef"><a href="#CR5" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">5</a></span>] that was trained to predict ImageNet classes from <em class="EmphasisTypeItalic ">real</em>
 color photos. If the classifier performs well, that means the 
colorizations are accurate enough to be informative about object class. 
Using an off-the-shelf classifier to assess the realism of synthesized 
data has been previously suggested by [<span class="CitationRef"><a href="#CR12" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">12</a></span>].</p><p id="Par37" class="Para">The results are shown in the second column from the right of Table&nbsp;<span class="InternalRef"><a href="#Tab1">1</a></span>.
 Classifier performance drops from 68.3&nbsp;% to 52.7&nbsp;% after 
ablating colors from the input. After re-colorizing using our full 
method, the performance is improved to 56.0&nbsp;% (other variants of 
our method achieve slightly higher results). The Larsson et al. [<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]
 method achieves the highest performance on this metric, reaching 
59.4&nbsp;%. For reference, a VGG classification network fine-tuned on 
grayscale inputs reaches a performance of 63.5&nbsp;%.</p><p id="Par38" class="Para">In
 addition to serving as a perceptual metric, this analysis demonstrates a
 practical use for our algorithm: without any additional training or 
fine-tuning, we can improve performance on grayscale image 
classification, simply by colorizing images with our algorithm and 
passing them to an off-the-shelf classifier.</p><p id="Par39" class="Para"> <strong class="EmphasisTypeBold ">3. Raw Accuracy (AuC):</strong>
 As a low-level test, we compute the percentage of predicted pixel 
colors within a thresholded L2 distance of the ground truth in <em class="EmphasisTypeItalic ">ab</em> color space. We then sweep across thresholds from 0 to 150 to produce a cumulative mass function, as introduced in [<span class="CitationRef"><a href="#CR22" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">22</a></span>], integrate the area under the curve (AuC), and normalize. Note that this AuC metric measures <em class="EmphasisTypeItalic ">raw prediction accuracy</em>, whereas our method aims for <em class="EmphasisTypeItalic ">plausibility</em>.</p><p id="Par40" class="Para">Our
 network, trained on classification without rebalancing, outperforms our
 L2 variant (when trained from scratch). When the L2 net is instead 
fine-tuned from a color classification network, it matches the 
performance of the classification network. This indicates that the L2 
metric can achieve accurate colorizations, but has difficulty in 
optimization from scratch. The Larsson et al.&nbsp;[<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>]
 method achieves slightly higher accuracy. Note that this metric is 
dominated by desaturated pixels, due to the distribution of <em class="EmphasisTypeItalic ">ab</em> values in natural images (Fig.&nbsp;<span class="InternalRef"><a href="#Fig3">3</a></span>(b)).
 As a result, even predicting gray for every pixel does quite well, and 
our full method with class rebalancing achieves approximately the same 
score.</p><div id="Par41" class="Para">Perceptually interesting regions of images, on the other hand, tend to have a distribution of <em class="EmphasisTypeItalic ">ab</em>
 values with higher values of saturation. As such, we compute a 
class-balanced variant of the AuC metric by re-weighting the pixels 
inversely by color class probability (Eq.&nbsp;<span class="InternalRef"><a href="#Equ4">4</a></span>, setting <span class="InlineEquation" id="IEq61"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-798" style="width: 2.799em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.266em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.733em, 1002.24em, 2.716em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-799"><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral; font-style: italic;">λ</span><span class="mo" id="MathJax-Span-801" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-802" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.078em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-56">\lambda =0</script></span>).
 Under this metric, our full method outperforms all variants and 
compared algorithms, indicating that class-rebalancing in the training 
objective achieved its desired effect.<div id="Tab2" class="Table"><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Table 2.</span> <p class="SimplePara">PASCAL Tests.</p> </div></div><div class="u-scroll-horizontal"><table><colgroup><col class="tcol1 align-left"><col class="tcol2 align-left"><col class="tcol3 align-left"><col class="tcol4 align-left"><col class="tcol5 align-left"><col class="tcol6 align-left"></colgroup><thead><tr><th colspan="6"> <p class="SimplePara">Dataset and task generalization on PASCAL [<span class="CitationRef"><a href="#CR37" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">37</a></span>]</p> </th></tr><tr><th></th><th colspan="3"> <p class="SimplePara">Classification</p> </th><th> <p class="SimplePara">Detection</p> </th><th> <p class="SimplePara">Segmentation</p> </th></tr><tr><th></th><th colspan="3"> <p class="SimplePara">(% mAP)</p> </th><th> <p class="SimplePara">(% mAP)</p> </th><th> <p class="SimplePara">(% mIU)</p> </th></tr><tr><th> <p class="SimplePara">Fine-tuned layers</p> </th><th> <p class="SimplePara">fc8</p> </th><th> <p class="SimplePara">fc6-fc8</p> </th><th> <p class="SimplePara">All</p> </th><th> <p class="SimplePara">All</p> </th><th> <p class="SimplePara">All</p> </th></tr></thead><tbody><tr><td> <p class="SimplePara">ImageNet [<span class="CitationRef"><a href="#CR38" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">38</a></span>]</p> </td><td> <p class="SimplePara">76.8</p> </td><td> <p class="SimplePara">78.9</p> </td><td> <p class="SimplePara">79.9</p> </td><td> <p class="SimplePara">56.8</p> </td><td> <p class="SimplePara">48.0</p> </td></tr><tr><td> <p class="SimplePara">Gaussian</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">53.3</p> </td><td> <p class="SimplePara">43.4</p> </td><td> <p class="SimplePara">19.8</p> </td></tr><tr><td> <p class="SimplePara">Autoencoder</p> </td><td> <p class="SimplePara">24.8</p> </td><td> <p class="SimplePara">16.0</p> </td><td> <p class="SimplePara">53.8</p> </td><td> <p class="SimplePara">41.9</p> </td><td> <p class="SimplePara">25.2</p> </td></tr><tr><td> <p class="SimplePara">k-means [<span class="CitationRef"><a href="#CR38" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">38</a></span>]</p> </td><td> <p class="SimplePara">32.0</p> </td><td> <p class="SimplePara">39.2</p> </td><td> <p class="SimplePara">56.6</p> </td><td> <p class="SimplePara">45.6</p> </td><td> <p class="SimplePara">32.6</p> </td></tr><tr><td> <p class="SimplePara">Agrawal et al. [<span class="CitationRef"><a href="#CR8" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">8</a></span>]</p> </td><td> <p class="SimplePara">31.2</p> </td><td> <p class="SimplePara">31.0</p> </td><td> <p class="SimplePara">54.2</p> </td><td> <p class="SimplePara">43.9</p> </td><td> <p class="SimplePara">–</p> </td></tr><tr><td> <p class="SimplePara">Wang &amp; Gupta [<span class="CitationRef"><a href="#CR15" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">15</a></span>]</p> </td><td> <p class="SimplePara">28.1</p> </td><td> <p class="SimplePara">52.2</p> </td><td> <p class="SimplePara">58.7</p> </td><td> <p class="SimplePara">44.0</p> </td><td> <p class="SimplePara">–</p> </td></tr><tr><td> <p class="SimplePara">Doersch et al. [<span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>]</p> </td><td> <p class="SimplePara">44.7</p> </td><td> <p class="SimplePara">55.1</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">65.3</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">51.1</strong> </p> </td><td> <p class="SimplePara">–</p> </td></tr><tr><td> <p class="SimplePara">Pathak et al. [<span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>]</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">–</p> </td><td> <p class="SimplePara">56.5</p> </td><td> <p class="SimplePara">44.5</p> </td><td> <p class="SimplePara">29.7</p> </td></tr><tr><td> <p class="SimplePara">Donahue et al. [<span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>]</p> </td><td> <p class="SimplePara">38.2</p> </td><td> <p class="SimplePara">50.2</p> </td><td> <p class="SimplePara">58.6</p> </td><td> <p class="SimplePara">45.1</p> </td><td> <p class="SimplePara">34.9</p> </td></tr><tr><td> <p class="SimplePara">Ours (gray)</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">52.4</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">61.5</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">65.9</strong> </p> </td><td> <p class="SimplePara">46.9</p> </td><td> <p class="SimplePara">35.0</p> </td></tr><tr><td> <p class="SimplePara">Ours (color)</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">52.4</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">61.5</strong> </p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">65.6</strong> </p> </td><td> <p class="SimplePara">47.9</p> </td><td> <p class="SimplePara"> <strong class="EmphasisTypeBold ">35.6</strong> </p> </td></tr></tbody></table></div></div></div><div id="Par42" class="Para"> <figure class="Figure" id="Fig7"><div class="MediaObject" id="MO12"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig7_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig7_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 7.</span> <p class="SimplePara">ImageNet Linear Classification</p> </div></figcaption></figure> </div><p id="Par43" class="Para"> <strong class="EmphasisTypeBold ">Figure</strong>&nbsp;<span class="InternalRef"><a href="#Fig7">7</a></span> <strong class="EmphasisTypeBold ">.</strong> <strong class="EmphasisTypeBold ">Task Generalization on ImageNet.</strong> We freeze pre-trained networks and learn linear classifiers on internal layers for ImageNet [<span class="CitationRef"><a href="#CR28" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">28</a></span>]
 classification. Features are average-pooled, with equal kernel and 
stride sizes, until feature dimensionality is below 10k. ImageNet [<span class="CitationRef"><a href="#CR38" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">38</a></span>], k-means [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>],
 and Gaussian initializations were run with grayscale inputs, shown with
 dotted lines, as well as color inputs, shown with solid lines. Previous
 [<span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>, <span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>] and concurrent [<span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>] self-supervision methods are shown.</p><p id="Par44" class="Para"> <strong class="EmphasisTypeBold ">Table</strong>&nbsp;<span class="InternalRef"><a href="#Tab2">2</a></span> <strong class="EmphasisTypeBold ">.</strong> <strong class="EmphasisTypeBold ">Task and Dataset Generalization on PASCAL.</strong> Classification and detection on PASCAL VOC 2007 [<span class="CitationRef"><a href="#CR39" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">39</a></span>] and segmentation on PASCAL VOC 2012 [<span class="CitationRef"><a href="#CR40" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">40</a></span>],
 using standard mean average precision (mAP) and mean intersection over 
union (mIU) metrics for each task. We fine-tune our network with 
grayscale inputs (gray) and color inputs (color). Methods noted with a *
 only pre-trained a subset of the AlexNet layers. The remaining layers 
were initialized with [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>].</p></section><section id="Sec8" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">3.2 </span>Cross-Channel Encoding as Self-supervised Feature Learning</h3><p id="Par45" class="Para">In
 addition to making progress on the graphics task of colorization, we 
evaluate how colorization can serve as a pretext task for representation
 learning. Our model is akin&nbsp;to an autoencoder, except that the 
input and output are different image channels, suggesting the term <em class="EmphasisTypeItalic ">cross-channel encoder</em>.</p><p id="Par46" class="Para">To
 evaluate the feature representation learned through this kind of 
cross-channel encoding, we run two sets of tests on our network. First, 
we test the <em class="EmphasisTypeItalic ">task generalization</em> 
capability of the features by fixing the learned representation and 
training linear classifiers to perform object classification on already 
seen data (Fig.&nbsp;<span class="InternalRef"><a href="#Fig7">7</a></span>). Second, we fine-tune the network on the PASCAL dataset [<span class="CitationRef"><a href="#CR37" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">37</a></span>] for the tasks of classification, detection, and segmentation. Here, in addition to testing on held-out <em class="EmphasisTypeItalic ">tasks</em>, this group of experiments tests the learned representation on <em class="EmphasisTypeItalic ">dataset generalization</em>. To fairly compare to previous feature learning algorithms, we retrain an AlexNet&nbsp;[<span class="CitationRef"><a href="#CR38" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">38</a></span>]
 network on the colorization task, using our full method, for 450&nbsp;k
 iterations. We find that the resulting learned representation achieves 
higher performance on object classification and segmentation tasks 
relative to previous methods tested (Table&nbsp;<span class="InternalRef"><a href="#Tab2">2</a></span>).</p><p id="Par47" class="Para"> <strong class="EmphasisTypeBold ">ImageNet Classification.</strong>
 The network was pre-trained to colorize images from the ImageNet 
dataset, without semantic label information. We test how well the 
learned features represent the object-level semantics. To do this, we 
freeze the weights of the network, provide semantic labels, and train 
linear classifiers on each convolutional layer. The results are shown in
 Fig.&nbsp;<span class="InternalRef"><a href="#Fig7">7</a></span>.</p><p id="Par48" class="Para">AlexNet
 directly trained on ImageNet classification achieves the highest 
performance, and serves as the ceiling for this test. Random 
initialization, with Gaussian weights or the k-means scheme implemented 
in [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>],
 peak in the middle layers. Because our representation is learned on 
grayscale images, the network is handicapped at the input. To quantify 
the effect of this loss of information, we fine-tune AlexNet on 
grayscale image classification, and also run the random initialization 
schemes on grayscale images. Interestingly, for all three methods, there
 is a 6&nbsp;% performance gap between color and grayscale inputs, which
 remains approximately constant throughout the network.</p><p id="Par49" class="Para">We compare our model to other recent self-supervised methods pre-trained on ImageNet&nbsp;[<span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>, <span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>, <span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>]. To begin, our <span class="EmphasisFontCategoryNonProportional ">conv1</span> representation results in worse linear classification performance than competiting methods&nbsp;[<span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>, <span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>], but is comparable to other methods which have a grayscale input. However, this performance gap is immediately bridged at <span class="EmphasisFontCategoryNonProportional ">conv2</span>, and our network achieves competitive performance to [<span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>, <span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>]
 throughout the remainder of the network. This indicates that despite 
the input handicap, solving the colorization task encourages 
representations that linearly separate semantic classes in the trained 
data distribution.</p><p id="Par50" class="Para"> <strong class="EmphasisTypeBold ">PASCAL Classification, Detection, and Segmentation.</strong>
 We test our model on the commonly used self-supervision benchmarks on 
PASCAL classification, detection, and segmentation, introduced in&nbsp;[<span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>, <span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>, <span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>]. Results are shown in Table&nbsp;<span class="InternalRef"><a href="#Tab2">2</a></span>.
 Our network achieves strong performance across all three tasks, and 
state-of-the-art numbers in classification and segmentation. We use the 
method from [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>],
 which rescales the layers so they “learn" at the same rate. We test our
 model in two modes: (1) keeping the input grayscale by disregarding 
color information (Ours (gray)) and (2) modifying <span class="EmphasisFontCategoryNonProportional ">conv1</span> to receive a full 3-channel <em class="EmphasisTypeItalic ">Lab</em> input, initializing the weights on the <em class="EmphasisTypeItalic ">ab</em> channels to be zero (Ours (color)).</p><p id="Par51" class="Para">We first test the network on PASCAL VOC 2007&nbsp;[<span class="CitationRef"><a href="#CR39" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">39</a></span>] classification, following the protocol in [<span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>].
 The network is trained by freezing the representation up&nbsp;to 
certain points, and fine-tuning the remainder. Note that when <span class="EmphasisFontCategoryNonProportional ">conv1</span>
 is frozen, the network is effectively only able to interpret grayscale 
images. Across all three classification tests, we achieve 
state-of-the-art accuracy.</p><p id="Par52" class="Para">We also test detection on PASCAL VOC 2007, using Fast R-CNN [<span class="CitationRef"><a href="#CR41" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">41</a></span>], following the procedure in [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>]. Doersch et al. [<span class="CitationRef"><a href="#CR14" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">14</a></span>]
 achieves 51.5&nbsp;%, while we reach 46.9&nbsp;% and 47.9&nbsp;% with 
grayscale and color inputs, respectively. Our method is well above the 
strong k-means [<span class="CitationRef"><a href="#CR36" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">36</a></span>]
 baseline of 45.6&nbsp;%, but all self-supervised methods still fall 
short of pre-training with ImageNet semantic supervision, which reaches 
56.8&nbsp;%.</p><p id="Par53" class="Para">Finally, we test semantic segmentation on PASCAL VOC 2012&nbsp;[<span class="CitationRef"><a href="#CR40" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">40</a></span>], using the FCN architecture of&nbsp;[<span class="CitationRef"><a href="#CR42" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">42</a></span>], following the protocol in&nbsp;[<span class="CitationRef"><a href="#CR10" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">10</a></span>].
 Our colorization task shares similarities to the semantic segmentation 
task, as both are per-pixel classification problems. Our grayscale 
fine-tuned network achieves performance of 35.0&nbsp;%, approximately 
equal to Donahue et al.&nbsp;[<span class="CitationRef"><a href="#CR16" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">16</a></span>], and adding in color information increases performance to 35.6&nbsp;%, above other tested algorithms.</p></section><section id="Sec9" tabindex="-1" class="Section2 RenderAsSection2"><h3 class="Heading"><span class="HeadingNumber">3.3 </span>Legacy Black and White Photos</h3><div id="Par54" class="Para">Since our model was trained using “fake” grayscale images generated by stripping <em class="EmphasisTypeItalic ">ab</em> channels from color photos, we also ran our method on real legacy black and white photographs, as shown in Fig.&nbsp;<span class="InternalRef"><a href="#Fig8">8</a></span>
 (additional results can be viewed on our project webpage). One can see 
that our model is still able to produce good colorizations, even though 
the low-level image statistics of the legacy photographs are quite 
different from those of the modern-day photos on which it was trained.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO13"> <a href="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-319-46487-9_40/MediaObjects/419975_1_En_40_Fig8_HTML.gif" target="_blank" rel="noopener"><span class="u-screenreader-only">Open image in new window</span><img src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/419975_1_En_40_Fig8_HTML.gif" alt=""></a> </div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Fig. 8.</span> <p class="SimplePara">Applying
 our method to legacy black and white photos. Left to right: photo by 
David Fleay of a Thylacine, now extinct, 1936; photo by Ansel Adams of 
Yosemite; amateur family photo from 1956; <em class="EmphasisTypeItalic ">Migrant Mother</em> by Dorothea Lange, 1936</p> </div></figcaption></figure></div></section></div></section><section id="Sec10" tabindex="-1" class="Section1 RenderAsSection1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1"><span class="HeadingNumber">4 </span>Conclusion<span class="section-icon"></span></h2><div class="content"><p id="Par55" class="Para">While
 image colorization is a boutique computer graphics task, it is also an 
instance of a difficult pixel prediction problem in computer vision. 
Here we have shown that colorization with a deep CNN and a well-chosen 
objective function can come closer to producing results 
indistinguishable from real color photos. Our method not only provides a
 useful graphics output, but can also be viewed as a pretext task for 
representation learning. Although only trained to color, our network 
learns a representation that is surprisingly useful for object 
classification, detection, and segmentation, performing strongly 
compared to other self-supervised pre-training methods.</p></div></section><section id="Footnotes" class="FootnoteSection Section1 RenderAsSection1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1">Footnotes<span class="section-icon"></span></h2><div class="content"><ol><li class="Footnote"><span class="FootnoteNumber"><a href="#Fn1_source">1</a>.</span><div class="FootnoteContent" id="Fn1"><p id="Par14" class="Para">Each ground truth value <span class="InlineEquation" id="IEq16"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-803" style="width: 2.172em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.784em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.397em, 1001.78em, 2.612em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-804"><span class="msubsup" id="MathJax-Span-805"><span style="display: inline-block; position: relative; width: 1.799em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-806"><span class="mrow" id="MathJax-Span-807"><span class="mi" id="MathJax-Span-808" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.722em;"><span class="texatom" id="MathJax-Span-809"><span class="mrow" id="MathJax-Span-810"><span class="mi" id="MathJax-Span-811" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-812" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-813" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.363em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">\mathbf {Y}_{h,w}</script></span> can be encoded as a 1-hot vector <span class="InlineEquation" id="IEq17"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-814" style="width: 2.124em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.397em, 1001.74em, 2.612em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-815"><span class="msubsup" id="MathJax-Span-816"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.63em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-family: STIXGeneral; font-weight: bold;">Z</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.667em;"><span class="texatom" id="MathJax-Span-820"><span class="mrow" id="MathJax-Span-821"><span class="mi" id="MathJax-Span-822" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-823" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-824" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.363em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Z</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\mathbf {Z}_{h,w}</script></span> by searching for the nearest quantized <em class="EmphasisTypeItalic ">ab</em> bin. However, we found that <em class="EmphasisTypeItalic ">soft</em>-encoding
 worked well for training, and allowed the network to quickly learn the 
relationship between elements in the output space [<span class="CitationRef"><a href="#CR31" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">31</a></span>]. We find the 5-nearest neighbors to <span class="InlineEquation" id="IEq18"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-825" style="width: 2.172em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.784em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.397em, 1001.78em, 2.612em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-826"><span class="msubsup" id="MathJax-Span-827"><span style="display: inline-block; position: relative; width: 1.799em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.7em, 4.147em, -1000em); top: -4.002em; left: 0em;"><span class="texatom" id="MathJax-Span-828"><span class="mrow" id="MathJax-Span-829"><span class="mi" id="MathJax-Span-830" style="font-family: STIXGeneral; font-weight: bold;">Y</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.722em;"><span class="texatom" id="MathJax-Span-831"><span class="mrow" id="MathJax-Span-832"><span class="mi" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">h</span><span class="mo" id="MathJax-Span-834" style="font-size: 70.7%; font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-835" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.363em; border-left: 0px solid; width: 0px; height: 1.247em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">Y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mo>,</mo><mi>w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\mathbf {Y}_{h,w}</script></span> in the output space and weight them proportionally to their distance from the ground truth using a Gaussian kernel with <span class="InlineEquation" id="IEq19"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-836" style="width: 2.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.314em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.723em, 1002.25em, 2.714em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838" style="font-family: STIXGeneral; font-style: italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-839" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-840" style="font-family: STIXGeneral; padding-left: 0.313em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.974em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-60">\sigma =5</script></span>.</p></div></li><li class="Footnote"><span class="FootnoteNumber"><a href="#Fn2_source">2</a>.</span><div class="FootnoteContent" id="Fn2"><p id="Par22" class="Para"> <span class="InlineEquation" id="IEq43"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;.9&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-841" style="width: 3.619em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.941em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.733em, 1002.9em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-842"><span class="msubsup" id="MathJax-Span-843"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.51em, 4.352em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-844" style="font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.506em;"><span class="mn" id="MathJax-Span-845" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-846" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-847" style="font-family: STIXGeneral; padding-left: 0.313em;">.9</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mn>.9</mn></math></span></span><script type="math/tex" id="MathJax-Element-61">\beta _1=.9</script></span>, <span class="InlineEquation" id="IEq44"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;.99&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-848" style="width: 4.197em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.423em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.733em, 1003.38em, 2.905em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-849"><span class="msubsup" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.51em, 4.352em, -1000em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.506em;"><span class="mn" id="MathJax-Span-852" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-853" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-854" style="font-family: STIXGeneral; padding-left: 0.313em;">.99</span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mn>.99</mn></math></span></span><script type="math/tex" id="MathJax-Element-62">\beta _2=.99</script></span>, and weight decay = <span class="InlineEquation" id="IEq45"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-855" style="width: 2.365em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.929em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.192em, 1001.93em, 2.377em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-856"><span class="msubsup" id="MathJax-Span-857"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.98em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-858" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.405em; left: 1em;"><span class="texatom" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="mo" id="MathJax-Span-861" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-862" style="font-size: 70.7%; font-family: STIXGeneral;">3</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.21em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>3</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-63">10^{-3}</script></span>. Initial learning rate was <span class="InlineEquation" id="IEq46"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-863" style="width: 4.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.52em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.521em, 1003.52em, 2.725em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-864"><span class="mn" id="MathJax-Span-865" style="font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-866" style="font-family: STIXGeneral; padding-left: 0.25em;">×</span><span class="msubsup" id="MathJax-Span-867" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.98em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-868" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.405em; left: 1em;"><span class="texatom" id="MathJax-Span-869"><span class="mrow" id="MathJax-Span-870"><span class="mo" id="MathJax-Span-871" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-872" style="font-size: 70.7%; font-family: STIXGeneral;">5</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 1.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>×</mo><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>5</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-64">3\times 10^{-5}</script></span> and dropped to <span class="InlineEquation" id="IEq47"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-873" style="width: 2.365em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.929em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.184em, 1001.93em, 2.377em, -1000em); top: -2.218em; left: 0em;"><span class="mrow" id="MathJax-Span-874"><span class="msubsup" id="MathJax-Span-875"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.98em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-876" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.405em; left: 1em;"><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mo" id="MathJax-Span-879" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-880" style="font-size: 70.7%; font-family: STIXGeneral;">5</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.218em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.22em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>5</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-65">10^{-5}</script></span> and <span class="InlineEquation" id="IEq48"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-881" style="width: 4.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.52em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.524em, 1003.52em, 2.725em, -1000em); top: -2.555em; left: 0em;"><span class="mrow" id="MathJax-Span-882"><span class="mn" id="MathJax-Span-883" style="font-family: STIXGeneral;">3</span><span class="mo" id="MathJax-Span-884" style="font-family: STIXGeneral; padding-left: 0.25em;">×</span><span class="msubsup" id="MathJax-Span-885" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.913em; height: 0px;"><span style="position: absolute; clip: rect(3.181em, 1000.98em, 4.161em, -1000em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-886" style="font-family: STIXGeneral;">10</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.405em; left: 1em;"><span class="texatom" id="MathJax-Span-887"><span class="mrow" id="MathJax-Span-888"><span class="mo" id="MathJax-Span-889" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-890" style="font-size: 70.7%; font-family: STIXGeneral;">6</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.555em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 1.23em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>×</mo><msup><mn>10</mn><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>6</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-66">3\times 10^{-6}</script></span>
 when loss plateaued, at 200k and 375k iterations, respectively. Other 
models trained from scratch followed similar training protocol.</p></div></li></ol></div></section></div><section id="Notes" class="Section1 RenderAsSection1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1">Notes<span class="section-icon"></span></h2><div class="content"><section><h3 class="Heading">Acknowledgements</h3><p class="SimplePara">This
 research was supported, in part, by ONR MURI N000141010934, NSF 
SMA-1514512, an Intel research grant, and a hardware donation by NVIDIA 
Corp. We thank members of the Berkeley Vision Lab and Aditya Deshpande 
for helpful discussions, Philipp Krähenbühl and Jeff Donahue for help 
with self-supervision experiments, and Gustav Larsson for providing 
images for comparison to [<span class="CitationRef"><a href="#CR23" title="View reference" role="button" aria-pressed="false" aria-haspopup="true" aria-controls="popup-references">23</a></span>].</p></section></div></section><section class="Section1 RenderAsSection1" id="Bib1" tabindex="-1"><h2 class="Heading" data-role="collapsible-handle" tabindex="-1">References<span class="section-icon"></span></h2><div class="content"><ol class="BibliographyWrapper"><li class="Citation"><div class="CitationNumber">1.</div><div class="CitationContent" id="CR1">Cheng,
 Z., Yang, Q., Sheng, B.: Deep colorization. In: Proceedings of the IEEE
 International Conference on Computer Vision, pp. 415–423 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Cheng%2C%20Z.%2C%20Yang%2C%20Q.%2C%20Sheng%2C%20B.%3A%20Deep%20colorization.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%20415%E2%80%93423%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">2.</div><div class="CitationContent" id="CR2">Dahl, R.: Automatic colorization (2016). <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://tinyclouds.org/colorize/"><span class="RefSource">http://tinyclouds.org/colorize/.</span></a></span>
        <span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">3.</div><div class="CitationContent" id="CR3">Charpiat,
 G., Hofmann, M., Schölkopf, B.: Automatic image colorization via 
multimodal predictions. In: Forsyth, D., Torr, P., Zisserman, A. (eds.) 
ECCV 2008, Part III. LNCS, vol. 5304, pp. 126–139. Springer, Heidelberg 
(2008)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1007/978-3-540-88690-7_10"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Automatic%20image%20colorization%20via%20multimodal%20predictions&amp;author=G.%20Charpiat&amp;author=M.%20Hofmann&amp;author=B.%20Sch%C3%B6lkopf&amp;pages=126-139&amp;publication_year=2008"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">4.</div><div class="CitationContent" id="CR4">Ramanarayanan,
 G., Ferwerda, J., Walter, B., Bala, K.: Visual equivalence: towards a 
new standard for image fidelity. ACM Trans. Graph. (TOG) <strong class="EmphasisTypeBold ">26</strong>(3), 76 (2007)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1145/1276377.1276472"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Visual%20equivalence%3A%20towards%20a%20new%20standard%20for%20image%20fidelity&amp;author=G.%20Ramanarayanan&amp;author=J.%20Ferwerda&amp;author=B.%20Walter&amp;author=K.%20Bala&amp;journal=ACM%20Trans.%20Graph.%20%28TOG%29&amp;volume=26&amp;issue=3&amp;pages=76&amp;publication_year=2007"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">5.</div><div class="CitationContent" id="CR5">Simonyan, K., Zisserman, A.: Very deep convolutional networks for large-scale image recognition. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1409.1556"><span class="RefSource">arXiv:1409.1556</span></a></span> (2014)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">6.</div><div class="CitationContent" id="CR6">Bengio,
 Y., Courville, A., Vincent, P.: Representation learning: a review and 
new perspectives. IEEE Trans. Pattern Anal. Mach. Intell. <strong class="EmphasisTypeBold ">35</strong>(8), 1798–1828 (2013)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1109/TPAMI.2013.50"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Representation%20learning%3A%20a%20review%20and%20new%20perspectives&amp;author=Y.%20Bengio&amp;author=A.%20Courville&amp;author=P.%20Vincent&amp;journal=IEEE%20Trans.%20Pattern%20Anal.%20Mach.%20Intell.&amp;volume=35&amp;issue=8&amp;pages=1798-1828&amp;publication_year=2013"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">7.</div><div class="CitationContent" id="CR7">Ngiam,
 J., Khosla, A., Kim, M., Nam, J., Lee, H., Ng, A.Y.: Multimodal deep 
learning. In: Proceedings of the 28th International Conference on 
Machine Learning (ICML 2011), pp. 689–696 (2011)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Ngiam%2C%20J.%2C%20Khosla%2C%20A.%2C%20Kim%2C%20M.%2C%20Nam%2C%20J.%2C%20Lee%2C%20H.%2C%20Ng%2C%20A.Y.%3A%20Multimodal%20deep%20learning.%20In%3A%20Proceedings%20of%20the%2028th%20International%20Conference%20on%20Machine%20Learning%20%28ICML%202011%29%2C%20pp.%20689%E2%80%93696%20%282011%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">8.</div><div class="CitationContent" id="CR8">Agrawal,
 P., Carreira, J., Malik, J.: Learning to see by moving. In: Proceedings
 of the IEEE International Conference on Computer Vision, pp. 37–45 
(2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Agrawal%2C%20P.%2C%20Carreira%2C%20J.%2C%20Malik%2C%20J.%3A%20Learning%20to%20see%20by%20moving.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%2037%E2%80%9345%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">9.</div><div class="CitationContent" id="CR9">Jayaraman,
 D., Grauman, K.: Learning image representations tied to ego-motion. In:
 Proceedings of the IEEE International Conference on Computer Vision, 
pp. 1413–1421 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Jayaraman%2C%20D.%2C%20Grauman%2C%20K.%3A%20Learning%20image%20representations%20tied%20to%20ego-motion.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%201413%E2%80%931421%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">10.</div><div class="CitationContent" id="CR10">Pathak,
 D., Krähenbühl, P., Donahue, J., Darrell, T., Efros, A.: Context 
encoders: feature learning by inpainting. In: CVPR (2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Pathak%2C%20D.%2C%20Kr%C3%A4henb%C3%BChl%2C%20P.%2C%20Donahue%2C%20J.%2C%20Darrell%2C%20T.%2C%20Efros%2C%20A.%3A%20Context%20encoders%3A%20feature%20learning%20by%20inpainting.%20In%3A%20CVPR%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">11.</div><div class="CitationContent" id="CR11">Lotter,
 W., Kreiman, G., Cox, D.: Deep predictive coding networks for video 
prediction and unsupervised learning. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1605.08104"><span class="RefSource">arXiv:1605.08104</span></a></span> (2016)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">12.</div><div class="CitationContent" id="CR12">Owens, A., Isola, P., McDermott, J., Torralba, A., Adelson, E.H., Freeman, W.T.: Visually indicated sounds. In: CVPR (2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Owens%2C%20A.%2C%20Isola%2C%20P.%2C%20McDermott%2C%20J.%2C%20Torralba%2C%20A.%2C%20Adelson%2C%20E.H.%2C%20Freeman%2C%20W.T.%3A%20Visually%20indicated%20sounds.%20In%3A%20CVPR%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">13.</div><div class="CitationContent" id="CR13">Owens,
 A., Wu, J., McDermott, J.H., Freeman, W.T., Torralba, A.: Ambient sound
 provides supervision for visual learning. In: ECCV (2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Owens%2C%20A.%2C%20Wu%2C%20J.%2C%20McDermott%2C%20J.H.%2C%20Freeman%2C%20W.T.%2C%20Torralba%2C%20A.%3A%20Ambient%20sound%20provides%20supervision%20for%20visual%20learning.%20In%3A%20ECCV%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">14.</div><div class="CitationContent" id="CR14">Doersch,
 C., Gupta, A., Efros, A.A.: Unsupervised visual representation learning
 by context prediction. In: Proceedings of the IEEE International 
Conference on Computer Vision, pp. 1422–1430 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Doersch%2C%20C.%2C%20Gupta%2C%20A.%2C%20Efros%2C%20A.A.%3A%20Unsupervised%20visual%20representation%20learning%20by%20context%20prediction.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%201422%E2%80%931430%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">15.</div><div class="CitationContent" id="CR15">Wang,
 X., Gupta, A.: Unsupervised learning of visual representations using 
videos. In: Proceedings of the IEEE International Conference on Computer
 Vision, pp. 2794–2802 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Wang%2C%20X.%2C%20Gupta%2C%20A.%3A%20Unsupervised%20learning%20of%20visual%20representations%20using%20videos.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%202794%E2%80%932802%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">16.</div><div class="CitationContent" id="CR16">Donahue, J., Krähenbühl, P., Darrell, T.: Adversarial feature learning. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1605.09782"><span class="RefSource">arXiv:1605.09782</span></a></span> (2016)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">17.</div><div class="CitationContent" id="CR17">Hertzmann,
 A., Jacobs, C.E., Oliver, N., Curless, B., Salesin, D.H.: Image 
analogies. In: Proceedings of the 28th Annual Conference on Computer 
Graphics and Interactive Techniques, pp. 327–340. ACM (2001)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Hertzmann%2C%20A.%2C%20Jacobs%2C%20C.E.%2C%20Oliver%2C%20N.%2C%20Curless%2C%20B.%2C%20Salesin%2C%20D.H.%3A%20Image%20analogies.%20In%3A%20Proceedings%20of%20the%2028th%20Annual%20Conference%20on%20Computer%20Graphics%20and%20Interactive%20Techniques%2C%20pp.%20327%E2%80%93340.%20ACM%20%282001%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">18.</div><div class="CitationContent" id="CR18">Welsh, T., Ashikhmin, M., Mueller, K.: Transferring color to greyscale images. ACM Trans. Graph. (TOG) <strong class="EmphasisTypeBold ">21</strong>(3), 277–280 (2002)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1145/566654.566576"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Transferring%20color%20to%20greyscale%20images&amp;author=T.%20Welsh&amp;author=M.%20Ashikhmin&amp;author=K.%20Mueller&amp;journal=ACM%20Trans.%20Graph.%20%28TOG%29&amp;volume=21&amp;issue=3&amp;pages=277-280&amp;publication_year=2002"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">19.</div><div class="CitationContent" id="CR19">Gupta,
 R.K., Chia, A.Y.S., Rajan, D., Ng, E.S., Zhiyong, H.: Image 
colorization using similar images. In: Proceedings of the 20th ACM 
International Conference on Multimedia, pp. 369–378. ACM (2012)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Gupta%2C%20R.K.%2C%20Chia%2C%20A.Y.S.%2C%20Rajan%2C%20D.%2C%20Ng%2C%20E.S.%2C%20Zhiyong%2C%20H.%3A%20Image%20colorization%20using%20similar%20images.%20In%3A%20Proceedings%20of%20the%2020th%20ACM%20International%20Conference%20on%20Multimedia%2C%20pp.%20369%E2%80%93378.%20ACM%20%282012%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">20.</div><div class="CitationContent" id="CR20">Liu, X., Wan, L., Qu, Y., Wong, T.T., Lin, S., Leung, C.S., Heng, P.A.: Intrinsic colorization. ACM Trans. Graph. (TOG) <strong class="EmphasisTypeBold ">27</strong>, 152 (2008). ACM<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1145/1409060.1409105"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Intrinsic%20colorization&amp;author=X.%20Liu&amp;author=L.%20Wan&amp;author=Y.%20Qu&amp;author=TT.%20Wong&amp;author=S.%20Lin&amp;author=CS.%20Leung&amp;author=PA.%20Heng&amp;journal=ACM%20Trans.%20Graph.%20%28TOG%29&amp;volume=27&amp;pages=152&amp;publication_year=2008"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">21.</div><div class="CitationContent" id="CR21">Chia,
 A.Y.S., Zhuo, S., Gupta, R.K., Tai, Y.W., Cho, S.Y., Tan, P., Lin, S.: 
Semantic colorization with internet images. ACM Trans. Graph. (TOG) <strong class="EmphasisTypeBold ">30</strong>, 156 (2011). ACM<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1145/2070781.2024190"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Semantic%20colorization%20with%20internet%20images&amp;author=AYS.%20Chia&amp;author=S.%20Zhuo&amp;author=RK.%20Gupta&amp;author=YW.%20Tai&amp;author=SY.%20Cho&amp;author=P.%20Tan&amp;author=S.%20Lin&amp;journal=ACM%20Trans.%20Graph.%20%28TOG%29&amp;volume=30&amp;pages=156&amp;publication_year=2011"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">22.</div><div class="CitationContent" id="CR22">Deshpande,
 A., Rock, J., Forsyth, D.: Learning large-scale automatic image 
colorization. In: Proceedings of the IEEE International Conference on 
Computer Vision, pp. 567–575 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Deshpande%2C%20A.%2C%20Rock%2C%20J.%2C%20Forsyth%2C%20D.%3A%20Learning%20large-scale%20automatic%20image%20colorization.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%20567%E2%80%93575%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">23.</div><div class="CitationContent" id="CR23">Larsson,
 G., Maire, M., Shakhnarovich, G.: Learning representations for 
automatic colorization. In: European Conference on Computer Vision 
(2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Larsson%2C%20G.%2C%20Maire%2C%20M.%2C%20Shakhnarovich%2C%20G.%3A%20Learning%20representations%20for%20automatic%20colorization.%20In%3A%20European%20Conference%20on%20Computer%20Vision%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">24.</div><div class="CitationContent" id="CR24">Iizuka,
 S., Simo-Serra, E., Ishikawa, H.: Let there be color!: joint end-to-end
 learning of global and local image priors for automatic image 
colorization with simultaneous classification. ACM Trans. Graph. (Proc. 
SIGGRAPH 2016) <strong class="EmphasisTypeBold ">35</strong>(4), 110 (2016). Kindly check and confirm if the inserted page range is correct for Ref. [24]<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Let%20there%20be%20color%21%3A%20joint%20end-to-end%20learning%20of%20global%20and%20local%20image%20priors%20for%20automatic%20image%20colorization%20with%20simultaneous%20classification&amp;author=S.%20Iizuka&amp;author=E.%20Simo-Serra&amp;author=H.%20Ishikawa&amp;journal=ACM%20Trans.%20Graph.%20%28Proc.%20SIGGRAPH%202016%29&amp;volume=35&amp;issue=4&amp;pages=110&amp;publication_year=2016"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">25.</div><div class="CitationContent" id="CR25">Hariharan,
 B., Arbeláez, P., Girshick, R., Malik, J.: Hypercolumns for object 
segmentation and fine-grained localization. In: Proceedings of the IEEE 
Conference on Computer Vision and Pattern Recognition, pp. 447–456 
(2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Hariharan%2C%20B.%2C%20Arbel%C3%A1ez%2C%20P.%2C%20Girshick%2C%20R.%2C%20Malik%2C%20J.%3A%20Hypercolumns%20for%20object%20segmentation%20and%20fine-grained%20localization.%20In%3A%20Proceedings%20of%20the%20IEEE%20Conference%20on%20Computer%20Vision%20and%20Pattern%20Recognition%2C%20pp.%20447%E2%80%93456%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">26.</div><div class="CitationContent" id="CR26">Chen,
 L.C., Papandreou, G., Kokkinos, I., Murphy, K., Yuille, A.L.: Deeplab: 
semantic image segmentation with deep convolutional nets, atrous 
convolution, and fully connected CRFs. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1606.00915"><span class="RefSource">arXiv:1606.00915</span></a></span> (2016)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">27.</div><div class="CitationContent" id="CR27">Yu,
 F., Koltun, V.: Multi-scale context aggregation by dilated 
convolutions. In: International Conference on Learning Representations 
(2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Yu%2C%20F.%2C%20Koltun%2C%20V.%3A%20Multi-scale%20context%20aggregation%20by%20dilated%20convolutions.%20In%3A%20International%20Conference%20on%20Learning%20Representations%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">28.</div><div class="CitationContent" id="CR28">Russakovsky,
 O., Deng, J., Su, H., Krause, J., Satheesh, S., Ma, S., Huang, Z., 
Karpathy, A., Khosla, A., Bernstein, M., et al.: Imagenet large scale 
visual recognition challenge. Int. J. Comput. Vis. <strong class="EmphasisTypeBold ">115</strong>(3), 211–252 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceAMSID"><a class="gtm-reference" data-reference-type="MathSciNet" target="_blank" rel="noopener" href="http://www.ams.org/mathscinet-getitem?mr=3422482"><span><span>MathSciNet</span></span></a></span><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1007/s11263-015-0816-y"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Imagenet%20large%20scale%20visual%20recognition%20challenge&amp;author=O.%20Russakovsky&amp;author=J.%20Deng&amp;author=H.%20Su&amp;author=J.%20Krause&amp;author=S.%20Satheesh&amp;author=S.%20Ma&amp;author=Z.%20Huang&amp;author=A.%20Karpathy&amp;author=A.%20Khosla&amp;author=M.%20Bernstein&amp;journal=Int.%20J.%20Comput.%20Vis.&amp;volume=115&amp;issue=3&amp;pages=211-252&amp;publication_year=2015"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">29.</div><div class="CitationContent" id="CR29">Zhou,
 B., Lapedriza, A., Xiao, J., Torralba, A., Oliva, A.: Learning deep 
features for scene recognition using places database. In: Advances in 
Neural Information Processing Systems, pp. 487–495 (2014)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Zhou%2C%20B.%2C%20Lapedriza%2C%20A.%2C%20Xiao%2C%20J.%2C%20Torralba%2C%20A.%2C%20Oliva%2C%20A.%3A%20Learning%20deep%20features%20for%20scene%20recognition%20using%20places%20database.%20In%3A%20Advances%20in%20Neural%20Information%20Processing%20Systems%2C%20pp.%20487%E2%80%93495%20%282014%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">30.</div><div class="CitationContent" id="CR30">Ioffe,
 S., Szegedy, C.: Batch normalization: accelerating deep network 
training by reducing internal covariate shift. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1502.03167"><span class="RefSource">arXiv:1502.03167</span></a></span> (2015)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">31.</div><div class="CitationContent" id="CR31">Hinton, G., Vinyals, O., Dean, J.: Distilling the knowledge in a neural network. arXiv preprint <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://arxiv.org/abs/1503.02531"><span class="RefSource">arXiv:1503.02531</span></a></span> (2015)<span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">32.</div><div class="CitationContent" id="CR32">Farabet,
 C., Couprie, C., Najman, L., LeCun, Y.: Learning hierarchical features 
for scene labeling. IEEE Trans. Pattern Anal. Mach. Intell. <strong class="EmphasisTypeBold ">35</strong>(8), 1915–1929 (2013)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1109/TPAMI.2012.231"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Learning%20hierarchical%20features%20for%20scene%20labeling&amp;author=C.%20Farabet&amp;author=C.%20Couprie&amp;author=L.%20Najman&amp;author=Y.%20LeCun&amp;journal=IEEE%20Trans.%20Pattern%20Anal.%20Mach.%20Intell.&amp;volume=35&amp;issue=8&amp;pages=1915-1929&amp;publication_year=2013"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">33.</div><div class="CitationContent" id="CR33">Kirkpatrick, S., Vecchi, M.P., et al.: Optimization by simmulated annealing. Science <strong class="EmphasisTypeBold ">220</strong>(4598), 671–680 (1983)<span class="Occurrences"><span class="Occurrence OccurrenceAMSID"><a class="gtm-reference" data-reference-type="MathSciNet" target="_blank" rel="noopener" href="http://www.ams.org/mathscinet-getitem?mr=702485"><span><span>MathSciNet</span></span></a></span><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1126/science.220.4598.671"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceZLBID"><a class="gtm-reference" data-reference-type="MATH" target="_blank" rel="noopener" href="http://www.emis.de/MATH-item?1225.90162"><span><span>MATH</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Optimization%20by%20simmulated%20annealing&amp;author=S.%20Kirkpatrick&amp;author=MP.%20Vecchi&amp;journal=Science&amp;volume=220&amp;issue=4598&amp;pages=671-680&amp;publication_year=1983"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">34.</div><div class="CitationContent" id="CR34">Efron,
 B.: Bootstrap methods: another look at the jackknife. In: Kotz, S., 
Johnson, N.L. (eds.) Breakthroughs in Statistics, pp. 569–593. Springer,
 Heidelberg (1992)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1007/978-1-4612-4380-9_41"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=Bootstrap%20methods%3A%20another%20look%20at%20the%20jackknife&amp;author=B.%20Efron&amp;pages=569-593&amp;publication_year=1992"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">35.</div><div class="CitationContent" id="CR35">Jia,
 Y., Shelhamer, E., Donahue, J., Karayev, S., Long, J., Girshick, R., 
Guadarrama, S., Darrell, T.: Caffe: convolutional architecture for fast 
feature embedding. In: Proceedings of the 22nd ACM International 
Conference on Multimedia, pp. 675–678. ACM (2014)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Jia%2C%20Y.%2C%20Shelhamer%2C%20E.%2C%20Donahue%2C%20J.%2C%20Karayev%2C%20S.%2C%20Long%2C%20J.%2C%20Girshick%2C%20R.%2C%20Guadarrama%2C%20S.%2C%20Darrell%2C%20T.%3A%20Caffe%3A%20convolutional%20architecture%20for%20fast%20feature%20embedding.%20In%3A%20Proceedings%20of%20the%2022nd%20ACM%20International%20Conference%20on%20Multimedia%2C%20pp.%20675%E2%80%93678.%20ACM%20%282014%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">36.</div><div class="CitationContent" id="CR36">Krähenbühl,
 P., Doersch, C., Donahue, J., Darrell, T.: Data-dependent 
initializations of convolutional neural networks. In: International 
Conference on Learning Representations (2016)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Kr%C3%A4henb%C3%BChl%2C%20P.%2C%20Doersch%2C%20C.%2C%20Donahue%2C%20J.%2C%20Darrell%2C%20T.%3A%20Data-dependent%20initializations%20of%20convolutional%20neural%20networks.%20In%3A%20International%20Conference%20on%20Learning%20Representations%20%282016%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">37.</div><div class="CitationContent" id="CR37">Everingham,
 M., Van Gool, L., Williams, C.K., Winn, J., Zisserman, A.: The pascal 
visual object classes (VOC) challenge. Int. J. Comput. Vis. <strong class="EmphasisTypeBold ">88</strong>(2), 303–338 (2010)<span class="Occurrences"><span class="Occurrence OccurrenceDOI"><a class="gtm-reference" data-reference-type="CrossRef" target="_blank" rel="noopener" href="https://doi.org/10.1007/s11263-009-0275-4"><span><span>CrossRef</span></span></a></span><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="http://scholar.google.com/scholar_lookup?title=The%20pascal%20visual%20object%20classes%20%28VOC%29%20challenge&amp;author=M.%20Everingham&amp;author=L.%20Gool&amp;author=CK.%20Williams&amp;author=J.%20Winn&amp;author=A.%20Zisserman&amp;journal=Int.%20J.%20Comput.%20Vis.&amp;volume=88&amp;issue=2&amp;pages=303-338&amp;publication_year=2010"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">38.</div><div class="CitationContent" id="CR38">Krizhevsky,
 A., Sutskever, I., Hinton, G.E.: Imagenet classification with deep 
convolutional neural networks. In: Advances in Neural Information 
Processing Systems, pp. 1097–1105 (2012)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Krizhevsky%2C%20A.%2C%20Sutskever%2C%20I.%2C%20Hinton%2C%20G.E.%3A%20Imagenet%20classification%20with%20deep%20convolutional%20neural%20networks.%20In%3A%20Advances%20in%20Neural%20Information%20Processing%20Systems%2C%20pp.%201097%E2%80%931105%20%282012%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">39.</div><div class="CitationContent" id="CR39">Everingham,
 M., Van Gool, L., Williams, C.K.I., Winn, J., Zisserman, A.: The PASCAL
 Visual Object Classes Challenge 2007 (VOC2007) Results. <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://www.pascal-network.org/challenges/VOC/voc2007/workshop/index.html"><span class="RefSource">http://www.pascal-network.org/challenges/VOC/voc2007/workshop/index.html</span></a></span>
        <span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">40.</div><div class="CitationContent" id="CR40">Everingham,
 M., Van Gool, L., Williams, C.K.I., Winn, J., Zisserman, A.:The PASCAL 
Visual Object Classes Challenge 2012 (VOC2012) Results. <span class="ExternalRef"><a target="_blank" rel="noopener" href="http://www.pascal-network.org/challenges/VOC/voc2012/workshop/index.html"><span class="RefSource">http://www.pascal-network.org/challenges/VOC/voc2012/workshop/index.html</span></a></span>
        <span class="Occurrences"></span></div></li><li class="Citation"><div class="CitationNumber">41.</div><div class="CitationContent" id="CR41">Girshick, R.: Fast R-CNN. In: Proceedings of the IEEE International Conference on Computer Vision, pp. 1440–1448 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Girshick%2C%20R.%3A%20Fast%20R-CNN.%20In%3A%20Proceedings%20of%20the%20IEEE%20International%20Conference%20on%20Computer%20Vision%2C%20pp.%201440%E2%80%931448%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li><li class="Citation"><div class="CitationNumber">42.</div><div class="CitationContent" id="CR42">Long,
 J., Shelhamer, E., Darrell, T.: Fully convolutional networks for 
semantic segmentation. In: Proceedings of the IEEE Conference on 
Computer Vision and Pattern Recognition, pp. 3431–3440 (2015)<span class="Occurrences"><span class="Occurrence OccurrenceGS"><a target="_blank" rel="noopener" class="google-scholar-link gtm-reference" data-reference-type="Google Scholar" href="https://scholar.google.com/scholar?q=Long%2C%20J.%2C%20Shelhamer%2C%20E.%2C%20Darrell%2C%20T.%3A%20Fully%20convolutional%20networks%20for%20semantic%20segmentation.%20In%3A%20Proceedings%20of%20the%20IEEE%20Conference%20on%20Computer%20Vision%20and%20Pattern%20Recognition%2C%20pp.%203431%E2%80%933440%20%282015%29"><span><span>Google Scholar</span></span></a></span></span></div></li></ol></div></section><section class="Section1 RenderAsSection1"><h2 class="Heading" id="copyrightInformation" data-role="collapsible-handle" tabindex="-1">Copyright information<span class="section-icon"></span></h2><div class="ArticleCopyright content"><div class="ChapterCopyright">©&nbsp;Springer International Publishing AG&nbsp;2016</div></div></section></div>
                        </article>
                        <aside class="section section--collapsible" id="AboutThisContent">
    <h2 class="section__heading" id="aboutcontent" data-role="collapsible-handle" tabindex="-1">About this paper<span class="section-icon"></span></h2>
    <div class="section__content bibliographic-information">
        
        <div class="crossmark__adjacent">
            <dl class="citation-info u-highlight-target u-mb-16" id="citeas">
    <dt class="test-cite-heading">
        Cite this paper as:
    </dt>
    <dd id="citethis-text">Zhang R., Isola P., Efros A.A. (2016) 
Colorful Image Colorization. In: Leibe B., Matas J., Sebe N., Welling M.
 (eds) Computer Vision – ECCV 2016. ECCV 2016. Lecture Notes in Computer
 Science, vol 9907. Springer, Cham</dd>
</dl>
                <ul class="bibliographic-information__list bibliographic-information__list--inline">
        <li class="bibliographic-information__item">
            <span class="bibliographic-information__title"><abbr title="Digital Object Identifier">DOI</abbr></span>
            <span class="bibliographic-information__value u-overflow-wrap" id="doi-url">https://doi.org/10.1007/978-3-319-46487-9_40</span>
        </li>
            <li class="bibliographic-information__item">
                <span class="bibliographic-information__title">Publisher Name</span>
                <span class="bibliographic-information__value" id="publisher-name">Springer, Cham</span>
            </li>
            <li class="bibliographic-information__item">
                <span class="bibliographic-information__title">Print ISBN</span>
                <span class="bibliographic-information__value" id="print-isbn">978-3-319-46486-2</span>
            </li>
            <li class="bibliographic-information__item ">
                <span class="bibliographic-information__title">Online ISBN</span>
                <span class="bibliographic-information__value" id="electronic-isbn">978-3-319-46487-9</span>
            </li>

                <li class="bibliographic-information__item">
            <span class="bibliographic-information__title">eBook Packages</span>
                <span class="bibliographic-information__value"><a id="ebook-package" href="https://link.springer.com/search?facet-content-type=%22Book%22&amp;package=11645&amp;facet-start-year=2016&amp;facet-end-year=2016">Computer Science</a></span>
        </li>

    </ul>

            <ul class="bibliographic-information__list">
            <li class="bibliographic-information__item">
                <a id="about-book" href="https://www.springer.com/978-3-319-46486-2?wt_mc=ThirdParty.SpringerLink.3.EPR653.About_eBook" class="gtm-about-this ">About this book</a>
            </li>
                    <li class="bibliographic-information__item">
                        <a id="reprintsandpermissions-link" class="u-external" target="_blank" rel="noopener" href="https://s100.copyright.com/AppDispatchServlet?publisherName=SpringerNature&amp;orderBeanReset=true&amp;orderSource=SpringerLink&amp;author=Richard+Zhang%2C+Phillip+Isola%2C+Alexei+A.+Efros&amp;contentID=10.1007%2F978-3-319-46487-9_40&amp;openAccess=false&amp;endPage=666&amp;publicationDate=2016&amp;startPage=649&amp;title=Colorful+Image+Colorization&amp;imprint=Springer+International+Publishing+AG&amp;publication=eBook" title="Visit RightsLink for information about reusing this paper">Reprints and Permissions</a>
                    </li>
</ul>

        </div>
      
      
          
    </div>
</aside>

                        <div class="section section--collapsible uptodate-recommendations gtm-recommendations">
    <h2 class="uptodate-recommendations__title section__heading gtm-recommendations__title" id="uptodaterecommendations" data-role="collapsible-handle" tabindex="-1">Personalised recommendations<span class="section-icon"></span></h2>
    <div class="section__content">
        <div class="uptodate-recommendations__container">
             <link rel="uptodate-inline" href="https://link.springer.com/springerlink-static/1203499612/css/recommendations.css">
        </div>
    </div>
</div>
                        

            <div class="sticky-banner u-interface u-js-screenreader-only" aria-hidden="true" data-component="SpringerLink.StickyBanner" data-namespace="hasButton">
                <div class="sticky-banner__container"><span class="sticky-banner__title sticky-banner__title--short u-overflow-ellipsis" title="Colorful Image Colorization">Colorful Image Colorization</span>
                        <div class="citations c-button-dropdown" data-component="SV.Dropdown" data-namespace="citationsSticky" aria-label="button with dropdown options" style="">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="Dropdown.citationsSticky-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Cite</span>
    <span class="hide-text-small">paper</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="Dropdown.citationsSticky-dropdown"><ul class="citations__content" data-role="button-dropdown__content">
    <li>
        <a href="#citeas" class="gtm-cite-dropdown">How to cite?</a>
    </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=refman&amp;flavour=citation" title="Download this paper's citation as a .RIS file" class="gtm-export-citation" data-gtmlabel="RIS">
                <span class="citations__extension" data-gtmlabel="RIS">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .RIS
                </span>
                <span class="citations__types">
                        <span>
                            Papers
                        </span>
                        <span>
                            Reference Manager
                        </span>
                        <span>
                            RefWorks
                        </span>
                        <span>
                            Zotero
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=endnote&amp;flavour=citation" title="Download this paper's citation as a .ENW file" class="gtm-export-citation" data-gtmlabel="ENW">
                <span class="citations__extension" data-gtmlabel="ENW">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .ENW
                </span>
                <span class="citations__types">
                        <span>
                            EndNote
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=bibtex&amp;flavour=citation" title="Download this paper's citation as a .BIB file" class="gtm-export-citation" data-gtmlabel="BIB">
                <span class="citations__extension" data-gtmlabel="BIB">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .BIB
                </span>
                <span class="citations__types">
                        <span>
                            BibTeX
                        </span>
                        <span>
                            JabRef
                        </span>
                        <span>
                            Mendeley
                        </span>
                </span>
            </a>
        </li>
</ul></div>
    </div>

                        



                        <div class="c-button-dropdown--blue download-book-options test-download-book-options u-interface c-button-dropdown" data-component="SV.Dropdown" data-namespace="downloadsSticky" aria-label="button with dropdown options">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="Dropdown.downloadsSticky-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Download</span>
    <span class="hide-text-small">book</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="Dropdown.downloadsSticky-dropdown"><ul class="download-book-options__content" data-role="button-dropdown__content">
        <li>
            <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-319-46487-9.pdf" title="Download this book in PDF format" target="_blank" rel="noopener" class="gtm-bookpdf-link test-bookpdf-link" tabindex="-1">
                <span class="download-book-options__types gtm-bookpdf-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>PDF</span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://link.springer.com/download/epub/10.1007%2F978-3-319-46487-9.epub" title="Download this book in EPUB format" target="_blank" rel="noopener" class="gtm-bookepub-link test-bookepub-link" tabindex="-1">
                <span class="download-book-options__types gtm-bookepub-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>EPUB</span>
                </span>
            </a>
        </li>
</ul></div>

    </div>

                </div>
            </div>




                    </div>
                    <aside class="main-sidebar-right u-interface">
                        <div data-role="sticky-wrapper">
                            <div class="main-sidebar-right__content u-composite-layer" data-component="SpringerLink.StickySidebar">
                                <div class="article-actions" id="article-actions">
                                    <h2 class="u-screenreader-only">Actions</h2>


                                    <div class="u-js-hide u-js-show-two-col">
                                        
            <div class="c-button-dropdown--blue download-book-options test-download-book-options u-interface c-button-dropdown" data-component="SV.Dropdown" aria-label="button with dropdown options">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="DownloadOptions.7111171101-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Download</span>
    <span class="hide-text-small">book</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="DownloadOptions.7111171101-dropdown" style="max-height: 0px; opacity: 0;"><ul class="download-book-options__content" data-role="button-dropdown__content">
        <li>
            <a href="https://link.springer.com/content/pdf/10.1007%2F978-3-319-46487-9.pdf" title="Download this book in PDF format" target="_blank" rel="noopener" class="gtm-bookpdf-link test-bookpdf-link" tabindex="-1">
                <span class="download-book-options__types gtm-bookpdf-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>PDF</span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://link.springer.com/download/epub/10.1007%2F978-3-319-46487-9.epub" title="Download this book in EPUB format" target="_blank" rel="noopener" class="gtm-bookepub-link test-bookepub-link" tabindex="-1">
                <span class="download-book-options__types gtm-bookepub-link">
                    <svg width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    <span>EPUB</span>
                </span>
            </a>
        </li>
</ul></div>

    </div>





                                            <div class="citations c-button-dropdown" data-component="SV.Dropdown" data-namespace="citations" aria-label="button with dropdown options">
        <button type="button" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="Dropdown.citations-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">
    <span>Cite</span>
    <span class="hide-text-small">paper</span>
</span><span class="c-button-dropdown__icon"></span></button>
<div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="Dropdown.citations-dropdown" style="max-height: 0px; opacity: 0;"><ul class="citations__content" data-role="button-dropdown__content">
    <li>
        <a href="#citeas" class="gtm-cite-dropdown" tabindex="-1">How to cite?</a>
    </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=refman&amp;flavour=citation" title="Download this paper's citation as a .RIS file" class="gtm-export-citation" data-gtmlabel="RIS" tabindex="-1">
                <span class="citations__extension" data-gtmlabel="RIS">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .RIS
                </span>
                <span class="citations__types">
                        <span>
                            Papers
                        </span>
                        <span>
                            Reference Manager
                        </span>
                        <span>
                            RefWorks
                        </span>
                        <span>
                            Zotero
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=endnote&amp;flavour=citation" title="Download this paper's citation as a .ENW file" class="gtm-export-citation" data-gtmlabel="ENW" tabindex="-1">
                <span class="citations__extension" data-gtmlabel="ENW">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .ENW
                </span>
                <span class="citations__types">
                        <span>
                            EndNote
                        </span>
                </span>
            </a>
        </li>
        <li>
            <a href="https://citation-needed.springer.com/v2/references/10.1007/978-3-319-46487-9_40?format=bibtex&amp;flavour=citation" title="Download this paper's citation as a .BIB file" class="gtm-export-citation" data-gtmlabel="BIB" tabindex="-1">
                <span class="citations__extension" data-gtmlabel="BIB">
                    <svg class="u-vertical-align-absolute" width="12" height="14" viewBox="0 0 12 14" xmlns="http://www.w3.org/2000/svg"><path d="M7 7.269v-6.271c0-.551-.448-.998-1-.998-.556 0-1 .447-1 .998v6.271l-1.5-1.547c-.375-.387-1.01-.397-1.401-.006l.016-.016c-.397.397-.391 1.025-.001 1.416l3.178 3.178c.392.392 1.024.391 1.415 0l3.178-3.178c.392-.392.391-1.025-.001-1.416l.016.016c-.397-.397-1.018-.388-1.401.006l-1.5 1.547zm-7 5.731c0-.552.456-1 1.002-1h9.995c.554 0 1.002.444 1.002 1 0 .552-.456 1-1.002 1h-9.995c-.554 0-1.002-.444-1.002-1z" fill="#0176C3"></path></svg>
                    .BIB
                </span>
                <span class="citations__types">
                        <span>
                            BibTeX
                        </span>
                        <span>
                            JabRef
                        </span>
                        <span>
                            Mendeley
                        </span>
                </span>
            </a>
        </li>
</ul></div>
    </div>

                                            



                                    </div>
                                </div>
                                <nav class="toc" aria-label="article contents">
    <h2 class="u-h4 u-screenreader-only">Table of contents</h2>
    <ul id="article-contents" class="article-contents" role="menu">
            <li role="menuitem">
                <a title="Conference paper" href="#enumeration"><span class="u-overflow-ellipsis">Conference paper</span></a>
            </li>
            <li role="menuitem">
                <a title="Abstract" href="#Abs1"><span class="u-overflow-ellipsis">Abstract</span></a>
            </li>
            <li role="menuitem">
                <a title="1 Introduction" href="#Sec1"><span class="u-overflow-ellipsis">1 Introduction</span></a>
            </li>
            <li role="menuitem">
                <a title="2 Approach" href="#Sec2"><span class="u-overflow-ellipsis">2 Approach</span></a>
            </li>
            <li role="menuitem">
                <a title="3 Experiments" href="#Sec6"><span class="u-overflow-ellipsis">3 Experiments</span></a>
            </li>
            <li role="menuitem">
                <a title="4 Conclusion" href="#Sec10"><span class="u-overflow-ellipsis">4 Conclusion</span></a>
            </li>
            <li role="menuitem">
                <a title="Footnotes" href="#Footnotes"><span class="u-overflow-ellipsis">Footnotes</span></a>
            </li>
            <li role="menuitem">
                <a title="Notes" href="#Notes"><span class="u-overflow-ellipsis">Notes</span></a>
            </li>
            <li role="menuitem">
                <a title="References" href="#Bib1"><span class="u-overflow-ellipsis">References</span></a>
            </li>
            <li role="menuitem">
                <a title="Copyright information" href="#copyrightInformation"><span class="u-overflow-ellipsis">Copyright information</span></a>
            </li>
            
            <li role="menuitem">
                <a title="About this paper" href="#aboutcontent"><span class="u-overflow-ellipsis">About this paper</span></a>
            </li>
    </ul>
</nav>

                            </div>
                                <div class="skyscraper-ad u-hide" data-component="SpringerLink.GoogleAds" data-namespace="skyscraper"><div class="skyscraper-ad__wrapper"><p class="skyscraper-ad__label">Advertisement</p><button class="skyscraper-ad__hide" title="Hide this advertisement">Hide</button><div id="doubleclick-ad" class="skyscraper-ad__ad"><div id="google_ads_iframe_270604982/springerlink/book/chapter_1__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_270604982/springerlink/book/chapter_1" title="3rd party ad content" name="google_ads_iframe_270604982/springerlink/book/chapter_1" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" width="160" height="600" frameborder="0"></iframe></div></div></div></div>

                        </div>
                    </aside>
                </div>
            </main>
            <section class="banner banner--cookies-policy u-composite-layer" data-component="SpringerLink.CookiePolicy">
    <div class="banner__content u-interface">
        <h2 class="u-screenreader-only">Cookies</h2>
        <span class="banner__cookie-text">We use cookies to improve your experience with our site.</span>
        <a class="banner__link banner__link--cookie" href="https://link.springer.com/termsandconditions#cookies">More information</a>

        <form class="banner__form" action="/acceptcookies" method="POST">
            <button class="u-link-like banner__right-ui">Accept</button>
        </form>
    </div>
</section>

                <footer class="footer u-interface">
        <div class="footer__aside-wrapper">
            <div class="footer__content">
                <div class="footer__aside">
                    <p class="footer__strapline">Over 10 million scientific documents at your fingertips</p>
                                <div class="footer__edition c-button-dropdown c-button-dropdown--ghost" data-component="SpringerLink.EditionSwitcher" aria-label="button with dropdown options">
                                    <button type="button" title="Switch between Academic &amp; Corporate Edition" class="c-button-dropdown__button" data-role="button-dropdown__control" aria-pressed="false" aria-expanded="false" aria-controls="EditionSwitcher.9011111561-dropdown"><span class="u-overflow-ellipsis c-button-dropdown__button-title">Academic Edition</span><span class="c-button-dropdown__icon"></span></button>
                                    <div class="u-composite-layer c-button-dropdown__container" aria-hidden="true" aria-label="dropdown" id="EditionSwitcher.9011111561-dropdown"><ul data-role="button-dropdown__content">
                                        <li class="selected"><a href="https://link.springer.com/siteEdition/link" id="siteedition-academic-link">Academic Edition</a></li>
                                        <li><a href="https://link.springer.com/siteEdition/rd" id="siteedition-corporate-link" tabindex="-1">Corporate Edition</a></li>
                                    </ul></div>
                                </div>
                </div>
            </div>
        </div>
        <div class="footer__content">
            <ul class="footer__nav">
                <li>
                    <a href="https://link.springer.com/">Home</a>
                </li>
                <li>
                    <a href="https://link.springer.com/impressum">Impressum</a>
                </li>
                <li>
                    <a href="https://link.springer.com/termsandconditions">Legal information</a>
                </li>
                <li>
                    <a href="https://link.springer.com/accessibility" class="gtm-footer-accessibility">Accessibility</a>
                </li>
                <li>
                    <a id="contactus-footer-link" href="https://link.springer.com/contactus">Contact us</a>
                </li>
            </ul>
            <a class="parent-logo" target="_blank" rel="noopener" href="https://www.springernature.com/" title="Go to Springer Nature">
                <span class="u-screenreader-only">Springer Nature</span>
                <svg width="125" height="12">
                    <image width="125" height="12" alt="Springer Nature logo" src="/springerlink-static/1203499612/images/png/springernature.png" xlink="http://www.w3.org/1999/xlink" xlink:href="/springerlink-static/1203499612/images/svg/springernature.svg">
                    </image>
                </svg>
            </a>

            <p class="footer__copyright">© 2017 Springer International Publishing AG. Part of <a target="_blank" rel="noopener" href="https://www.springernature.com/">Springer Nature</a>.</p>

                <p class="footer__user-access-info">
                    <span>Not logged in</span>
                    <span>Stanford University Serials Control 
(1600134053) - Center for Research LIbraries c/o NERL (8200828607) - 
Stanford University Medical Center (8200924855)</span>
                    <span>171.64.70.54</span>
                </p>
        </div>
    </footer>

        </div>
          <script type="text/javascript">
    (function() {
        document.addEventListener('readystatechange', function () {
            if (document.readyState === 'complete') {
                var linkEl = document.querySelector('.js-ctm');
                if (window.matchMedia && window.matchMedia(linkEl.media).matches) {
                    var scriptMathJax = document.createElement('script');
                    scriptMathJax.async = true;
                    scriptMathJax.src = '/springerlink-static/1203499612/js/mathJax.js';
                    var s0 = document.getElementsByTagName('script')[0];
                    s0.parentNode.insertBefore(scriptMathJax, s0);
                }
            }
        });
    })();
</script>

<script type="text/javascript">
    (function() {
        var linkEl = document.querySelector('.js-ctm');
        var scriptsList = [];
        var polyfillFeatures = '';

        if (window.matchMedia && window.matchMedia(linkEl.media).matches) {
            (function(h){h.className = h.className.replace('no-js', 'js')})(document.documentElement);
            
            window.SpringerLink = window.SpringerLink || {};
            window.SpringerLink.staticLocation = '/springerlink-static/1203499612';
            
            polyfillFeatures = 'default,fetch,Promise,Object.setPrototypeOf,Object.entries,Number.isInteger,MutationObserver,startsWith';
            
            scriptsList = [
                'https://cdnjs.cloudflare.com/ajax/libs/airbrake-js/1.0.7/client.min.js',
                window.SpringerLink.staticLocation + '/js/jquery-3.3.1.min.js',
                'https://cdn.polyfill.io/v2/polyfill.js?features=' + polyfillFeatures,
                window.SpringerLink.staticLocation + '/js/main.js'
            ];

            scriptsList.forEach(function(script) {
                var tag = document.createElement('script');
                
                tag.async = false;
                tag.src = script;

                document.body.appendChild(tag);
            });
        }
    })();
</script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/client.js"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/jquery-3.js"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/polyfill.js"></script><script src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/main.js"></script>

<script>

   function viewport() {
        if (document.documentElement.clientWidth < 620) {
            size = 'small';
        }
        else if(document.documentElement.clientWidth < 1075 ) {
            size = 'medium';
        }
        else {
            size = 'wide';
        }
        return size;
    };

    function reportForMouseEvents(linkCssSelectors, nolardUrl, experiment, abgroup) {
        var counter = 0;
        linkCssSelectors.forEach(function(cssSelector) {
            $('body').delegate(cssSelector, 'click', function() {
                if(counter == 0) {
                    reportConversion(nolardUrl, experiment, abgroup);
                    counter++;
                }
            });
        });
    };

    function reportConversion(nolardUrl, experiment, abgroup) {
        $.ajax({ url: nolardUrl + '/convert/' + experiment + '/' + abgroup });
    };

    function reportForMouseEvent(linkCssSelector, nolardUrl, experiment, abgroup) {
        var counter = 0;
        var elem = document.querySelector(linkCssSelector)

        if (elem.addEventListener) {
            elem.addEventListener("click", function(e) {
                if(counter == 0) {
                    reportConversion(nolardUrl, experiment, abgroup);
                    counter++;
                }
            });
        } else  {
            elem.attachEvent("click", function(e) {
                if(counter == 0) {
                    reportConversion(nolardUrl, experiment, abgroup);
                    counter++;
                }
            });
        }
    };

    function reportParticipation(nolardUrl, experiment, abgroup, participations) {
        if (participations)
            participations.push(experiment + '/' + abgroup)

        var xhr = new XMLHttpRequest()
        xhr.open('GET', nolardUrl + '/participate/' + experiment + '/' + abgroup);
        xhr.send();
    };

        function recordCurrentExperiment() {
            var participations = [];
            if (document.querySelector('#reprintsandpermissions-bottom-link') !== null) {
                reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-article-reprints-permissions-location', 'featureoff', participations);
                reportForMouseEvent('#reprintsandpermissions-bottom-link', 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-article-reprints-permissions-location', 'featureoff');
            } else if(document.querySelector('#reprintsandpermissions-top-link') !== null) {
                reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-article-reprints-permissions-location', 'featureon', participations);
                reportForMouseEvent('#reprintsandpermissions-top-link', 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-article-reprints-permissions-location', 'featureon');
            }
            return participations;
        };

</script>

<script>
    window.onload = function() {
    var linkEl = document.querySelector('.js-ctm');


        if (window.matchMedia && window.matchMedia(linkEl.media).matches) {
          var bookProductType = dataLayer[0].content && dataLayer[0].content.book && dataLayer[0].content.book.bookProductType
          var hasBody = dataLayer[0]['Has Body'] == 'Y';
          var userHasAccess = dataLayer[0]['HasAccess'] == 'Y';
          var liveOrStatic = dataLayer[0].content && dataLayer[0].content.version

          // Baseline reference work page
          var isReferenceWork = window.location.pathname.startsWith('/referencework/');
          var isReferenceWorkEntry = window.location.pathname.startsWith('/referenceworkentry/');
          var isEncOrDict = bookProductType == 'Encyclop(a)edia' || bookProductType == 'Dictionary';

          // Baseline static reference work entry page pdf download
          if (isReferenceWorkEntry && isEncOrDict && $('.test-rwepdf-link').length) {
            reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-enc-pdf-download', 'baseline');
            reportForMouseEvents(['.test-rwepdf-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-enc-pdf-download', 'baseline');
          }
          if (isReferenceWorkEntry && !isEncOrDict && $('.gtm-pdf-link').length) {
            reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-nonenc-pdf-download', 'baseline');
            reportForMouseEvents(['.gtm-pdf-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-nonenc-pdf-download', 'baseline');

            if (($('.test-bookpdf-link').length || $('.test-bookepub-link').length)) {
                reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-book-download', 'baseline');
                reportForMouseEvents(['.test-bookpdf-link', 'test-bookepub-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-book-download', 'baseline');
            }
          }

          // Baseline static reference work page pdf download
          if (isReferenceWork && isEncOrDict && ($('.test-bookpdf-link').length || $('.test-bookepub-link').length)) {
            reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-enc-book-download', 'baseline');
              reportForMouseEvents(['.test-bookpdf-link', 'test-bookepub-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-enc-book-download', 'baseline');
          }

          if (isReferenceWork && !isEncOrDict) {
            if (($('.test-bookpdf-link').length || $('.test-bookepub-link').length)) {
                reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-book-download', 'baseline');
                reportForMouseEvents(['.test-bookpdf-link', 'test-bookepub-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-book-download', 'baseline');
            }

            if ($('.test-book-toc-download-link').length) {
                reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-pdf-download', 'baseline');
                reportForMouseEvents(['.test-book-toc-download-link'], 'https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwpage-nonenc-pdf-download', 'baseline');
            }
          }

          // Baseline static rwe page fulltext html view with access
          if (isReferenceWorkEntry && isEncOrDict && hasBody) {
            reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-enc-html-download', 'baseline');
            if (userHasAccess)
                reportConversion('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-enc-html-download', 'baseline');
          }
          if (isReferenceWorkEntry && !isEncOrDict && hasBody) {
            reportParticipation('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-nonenc-html-download', 'baseline');
            if (userHasAccess)
                reportConversion('https://ab-reporting.live.cf.public.springer.com', 'bunsen-'+liveOrStatic+'-rwepage-nonenc-html-download', 'baseline');
          }
      }

            if (window.matchMedia && window.matchMedia(linkEl.media).matches) {
                recordCurrentExperiment()
            }
   };

</script>

<script class="kxct" data-id="KDqyaFZ_" data-timing="async" data-version="3.0" type="text/javascript">
 window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);
 (function(){
   var k=document.createElement('script');k.type='text/javascript';k.async=true;
   k.src=(location.protocol==='https:'?'https:':'http:')+'//cdn.krxd.net/controltag/KDqyaFZ_.js';
   var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);
 }());
</script>

<script>
    window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);
    (function(){
        function retrieve(n){
            var m, k='kx'+n;
            if (window.localStorage) {
                return window.localStorage[k] || "";
            } else if (navigator.cookieEnabled) {
                m = document.cookie.match(k+'=([^;]*)');
                return (m && unescape(m[1])) || "";
            } else {
                return '';
            }
        }
        Krux.user = retrieve('user');
        Krux.segments = retrieve('segs') && retrieve('segs').split(',') || [];
    })();
</script>

    <script type="text/javascript">
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        (function() {
            var gads = document.createElement('script');
            gads.async = true;
            gads.type = 'text/javascript';
            var useSSL = 'https:' == document.location.protocol;
            gads.src = (useSSL ? 'https:' : 'http:') +
                    '//www.googletagservices.com/tag/js/gpt.js';
            var node = document.getElementsByTagName('script')[0];
            node.parentNode.insertBefore(gads, node);
        })();
    </script>
    <script type="text/javascript" id="googletag-push">
        
            var adSlot = '270604982/springerlink/book/chapter';
        

        var definedSlots = [
                {slot: [728, 90], containerName: 'doubleclick-leaderboard-ad'},
                {slot: [160, 600], containerName: 'doubleclick-ad'},
        ];

        googletag.cmd.push(function() {
                googletag.pubads().setTargeting("doi","10.1007-978-3-319-46487-9_40");
                googletag.pubads().setTargeting("kwrd",["Colorization","Vision_for_graphics","CNNs","Self-supervised_learning"]);
                googletag.pubads().setTargeting("pmc",["I","I22021","I2203X","I21017","I22013"]);
                googletag.pubads().setTargeting("BPID",["1600134053","8200828607","8200924855"]);
                googletag.pubads().setTargeting("edition","academic");
                googletag.pubads().setTargeting("sucode","SUCO11645");
                googletag.pubads().setTargeting("eisbn","978-3-319-46487-9");
                googletag.pubads().setTargeting("eissn","1611-3349");
                googletag.pubads().setTargeting("pisbn","978-3-319-46486-2");
                googletag.pubads().setTargeting("pissn","0302-9743");
                googletag.pubads().setTargeting("ksg",Krux.segments);
                googletag.pubads().setTargeting("kuid",Krux.uid);
                googletag.pubads().setTargeting("logged","N");
            googletag.pubads().enableSingleRequest();
            googletag.pubads().enableAsyncRendering();
            googletag.enableServices();
        });
    </script>


        
        <span id="chat-widget" class="u-hide"></span>
                    <noscript>
                <img aria-hidden="true" role="presentation" src="https://ssl-springer.met.vgwort.de/na/pw-vgzm.415900-10.1007-978-3-319-46487-9_40" width='1' height='1' alt='' />
            </noscript>

    

<button href="javascript:;" title="focus catcher" class="js-focus-catcher u-screenreader-only" tabindex="-1"></button><script type="text/javascript" id="">(function(d,z){function n(){for(var a in dataLayer)if(dataLayer.hasOwnProperty(a)&&dataLayer[a]["Event Category"])return dataLayer[a]["Event Category"];return"warning: no event category"}function v(a,b,c,h){"undefined"!==typeof dataLayer?dataLayer.push({event:"Scroll To Section",eventCategory:n(),eventAction:a,eventLabel:b,eventValue:1,eventNonInteraction:h}):("undefined"!==typeof ga&&ga("send","event",n(),a,b,1,{nonInteraction:1}),"undefined"!==typeof _gaq&&_gaq.push(["_trackEvent",n(),a,b,1,!0]))}
function k(b,g,c,h){if(-1===a[c].cache.indexOf(c+"-"+h)&&document.querySelectorAll(b).length){var f="viewed"===h?document.querySelectorAll(b)[0].getBoundingClientRect().height:0,x=document.querySelectorAll(b)[0].getBoundingClientRect().top+d.pageYOffset;g>=x+f&&(v(p(c)+" "+p(h),b,c,!1),a[c].cache.push(c+"-"+h),q++)}}function r(a){a=document.querySelectorAll(a);return a.length?a[0].offsetHeight||0:0}function m(b,g,c){var f=d.pageYOffset+d.innerHeight;if(q>=w)"handleClick"===g&&d.removeEventListener(b,
t),"throttle"===g&&d.removeEventListener(b,u);else if(c)setTimeout(function(){0<r(a[c].content)&&(a[c].reached&&k(a[c].content,f,c,"reached"),a[c].viewed&&k(a[c].content,f,c,"viewed"))},10);else for(var e in a)a.hasOwnProperty(e)&&0<r(a[e].content)&&(a[e].reached&&k(a[e].content,f,e,"reached"),a[e].viewed&&k(a[e].content,f,e,"viewed"))}function y(b){b=document.querySelectorAll(a[b].content).length;return 0<b?!0:!1}function p(a){return a.charAt(0).toUpperCase()+a.slice(1)}function u(a,b){var c,f,e,
g=null,d=0,k=function(){d=new Date;g=null;e=a.apply(c,f)};return function(){var h=new Date;d||(d=h);var l=b-(h-d);c=this;f=arguments;0>=l?(clearTimeout(g),g=null,d=h,e=a.apply(c,f)):g||(g=setTimeout(k,l));return e}}function t(a,b){return function(c){a(c,b)}}var w=0,q=0,a={recommendations:{content:".gtm-recommendations iframe",clickable:".gtm-recommendations .gtm-recommendations__title",exists:!1,reached:!1,viewed:!0,size:0,cache:[]},"abstract":{content:"Section.Abstract",clickable:null,exists:!0,
reached:!1,viewed:!0,size:0,cache:[]},references:{content:".Bibliography \x3e .content, [id^\x3dBib1] \x3e .content",clickable:".Bibliography \x3e .Heading, [id^\x3dBib1] \x3e .Heading",exists:!0,reached:!0,viewed:!0,size:0,cache:[]},about:{content:"#AboutThisContent",clickable:"#AboutThisContent \x3e #aboutcontent",exists:!1,reached:!1,viewed:!0,size:0,cache:[]}};d.addEventListener("scroll",u(function(){m("scroll","throttle")},500));d.addEventListener("orientationchange",u(function(){m("orientationchange",
"throttle")},500));for(var b in a)if(a.hasOwnProperty(b)&&(a[b].exists&&a[b].size++,a[b].reached&&a[b].size++,a[b].viewed&&a[b].size++,w+=a[b].size,a[b].exists&&y(b)||!a[b].exists)){a[b].exists&&-1===a[b].cache.indexOf(b+"-exists")&&(v(p(b)+" Exists",a[b].content,b,!0),a[b].cache.push(b+"-exists"),q++);if(0<r(a[b].content)){var l=d.pageYOffset+d.innerHeight;a[b].reached&&k(a[b].content,l,b,"reached");a[b].viewed&&k(a[b].content,l,b,"viewed")}a[b].clickable&&(l=document.querySelectorAll(a[b].clickable)[0])&&
(l.addEventListener("click",t(function(a,b){m("click","handleClick",b)},b)),l.addEventListener("click",t(function(a,b){13==a.keyCode&&m("click","handleClick",b)},b)))}})(window);</script><div class="kxhead" data-id="KDqyaFZ_" style="display:none !important;"><span class="kxtag kxinvisible" data-id="28134"><script>
(function() {

    // cient only wants to collect first two paths
    Krux('scrape', {
        'page_attr_Springer_Link_url_path_1': {
            'url_path': '1'
        }
    });
    Krux('scrape', {
        'page_attr_Springer_Link_url_path_2': {
            'url_path': '2'
        }
    });
    // Krux('scrape',{'page_attr_url_path_3':{'url_path':'3'}});
    // Krux('scrape',{'page_attr_meta_keywords':{meta_name:'keywords'}});

    // Krux('scrape',{'page_attr_domain':{url_domain: '2'}});

})();
</script></span><span class="kxtag kxinvisible" data-id="20636"><script>
// this tag is intentionally blank
</script></span><span class="kxtag kxinvisible" data-id="20637"></span><span class="kxtag kxinvisible" data-id="20638"></span><span class="kxtag kxinvisible" data-id="20651"><script type="text/javascript">Krux('social.init');</script></span><span class="kxtag kxinvisible" data-id="24671"><script>
(function() {

    Krux('scrape', {
        'page_attr_Citation_Title_Springer': {
            'meta_name': 'citation_title'
        },
        'page_attr_Citation_DOI_Springer': {
            'meta_name': 'citation_doi'
        },
        'page_attr_Product_Name_Springer': {
            'meta_name': 'citation_journal_title'
        },
        'page_attr_Article_Type_Springer': {
            'meta_name': 'citation_article_type'
        },
        'page_attr_Citation_Author_Springer': {
            'dom_multi': 'meta[name="citation_author"]:@content'
        }
    });

    if (typeof dataLayer !== 'undefined' && dataLayer[0]) {
        Krux('set', 'page_attr_Article_Keywords_Springer', dataLayer[0].Keywords);
        Krux('set', 'page_attr_Business_Partner_ID_Springer', dataLayer[0].Bpids);
        Krux('set', 'page_attr_Business_Partner_Names_Springer', dataLayer[0].Bpnames);
        Krux('set', 'page_attr__Subject_Codes_Srpinger', dataLayer[0].SubjectCodes);
    }

})();
</script></span></div><script type="text/javascript" id="gtm-recommendations-script" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/entry-point.js"></script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXSizeOneSym, sans-serif;"></div></div></body><iframe id="kx-proxy-KDqyaFZ_" src="Colorful%20Image%20Colorization%20|%20SpringerLink_files/proxy.html" style="display: none; visibility: hidden; height: 0; width: 0;"></iframe></html>